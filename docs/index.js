/*! For license information please see index.js.LICENSE.txt */
(()=>{var e={1581:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const n=r(7159),s=r(3924),o=r(1240),a=r(98),i=["/properties"],c="http://json-schema.org/draft-07/schema";class l extends n.default{_addVocabularies(){super._addVocabularies(),s.default.forEach((e=>this.addVocabulary(e))),this.opts.discriminator&&this.addKeyword(o.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const e=this.opts.$data?this.$dataMetaSchema(a,i):a;this.addMetaSchema(e,c,!1),this.refs["http://json-schema.org/schema"]=c}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(c)?c:void 0)}}e.exports=t=l,Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var u=r(4815);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var d=r(3487);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return d._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return d.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return d.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return d.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return d.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return d.CodeGen}});var h=r(7426);Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return h.default}});var p=r(6646);Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return p.default}})},7023:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.regexpCode=t.getEsmExportName=t.getProperty=t.safeStringify=t.stringify=t.strConcat=t.addCodeArg=t.str=t._=t.nil=t._Code=t.Name=t.IDENTIFIER=t._CodeOrName=void 0;class r{}t._CodeOrName=r,t.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class n extends r{constructor(e){if(super(),!t.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}t.Name=n;class s extends r{constructor(e){super(),this._items="string"==typeof e?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const e=this._items[0];return""===e||'""'===e}get str(){var e;return null!==(e=this._str)&&void 0!==e?e:this._str=this._items.reduce(((e,t)=>`${e}${t}`),"")}get names(){var e;return null!==(e=this._names)&&void 0!==e?e:this._names=this._items.reduce(((e,t)=>(t instanceof n&&(e[t.str]=(e[t.str]||0)+1),e)),{})}}function o(e,...t){const r=[e[0]];let n=0;for(;n<t.length;)c(r,t[n]),r.push(e[++n]);return new s(r)}t._Code=s,t.nil=new s(""),t._=o;const a=new s("+");function i(e,...t){const r=[u(e[0])];let n=0;for(;n<t.length;)r.push(a),c(r,t[n]),r.push(a,u(e[++n]));return function(e){let t=1;for(;t<e.length-1;){if(e[t]===a){const r=l(e[t-1],e[t+1]);if(void 0!==r){e.splice(t-1,3,r);continue}e[t++]="+"}t++}}(r),new s(r)}function c(e,t){var r;t instanceof s?e.push(...t._items):t instanceof n?e.push(t):e.push("number"==typeof(r=t)||"boolean"==typeof r||null===r?r:u(Array.isArray(r)?r.join(","):r))}function l(e,t){if('""'===t)return e;if('""'===e)return t;if("string"==typeof e){if(t instanceof n||'"'!==e[e.length-1])return;return"string"!=typeof t?`${e.slice(0,-1)}${t}"`:'"'===t[0]?e.slice(0,-1)+t.slice(1):void 0}return"string"!=typeof t||'"'!==t[0]||e instanceof n?void 0:`"${e}${t.slice(1)}`}function u(e){return JSON.stringify(e).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}t.str=i,t.addCodeArg=c,t.strConcat=function(e,t){return t.emptyStr()?e:e.emptyStr()?t:i`${e}${t}`},t.stringify=function(e){return new s(u(e))},t.safeStringify=u,t.getProperty=function(e){return"string"==typeof e&&t.IDENTIFIER.test(e)?new s(`.${e}`):o`[${e}]`},t.getEsmExportName=function(e){if("string"==typeof e&&t.IDENTIFIER.test(e))return new s(`${e}`);throw new Error(`CodeGen: invalid export name: ${e}, use explicit $id name mapping`)},t.regexpCode=function(e){return new s(e.toString())}},3487:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.or=t.and=t.not=t.CodeGen=t.operators=t.varKinds=t.ValueScopeName=t.ValueScope=t.Scope=t.Name=t.regexpCode=t.stringify=t.getProperty=t.nil=t.strConcat=t.str=t._=void 0;const n=r(7023),s=r(8490);var o=r(7023);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return o._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return o.str}}),Object.defineProperty(t,"strConcat",{enumerable:!0,get:function(){return o.strConcat}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return o.nil}}),Object.defineProperty(t,"getProperty",{enumerable:!0,get:function(){return o.getProperty}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return o.stringify}}),Object.defineProperty(t,"regexpCode",{enumerable:!0,get:function(){return o.regexpCode}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return o.Name}});var a=r(8490);Object.defineProperty(t,"Scope",{enumerable:!0,get:function(){return a.Scope}}),Object.defineProperty(t,"ValueScope",{enumerable:!0,get:function(){return a.ValueScope}}),Object.defineProperty(t,"ValueScopeName",{enumerable:!0,get:function(){return a.ValueScopeName}}),Object.defineProperty(t,"varKinds",{enumerable:!0,get:function(){return a.varKinds}}),t.operators={GT:new n._Code(">"),GTE:new n._Code(">="),LT:new n._Code("<"),LTE:new n._Code("<="),EQ:new n._Code("==="),NEQ:new n._Code("!=="),NOT:new n._Code("!"),OR:new n._Code("||"),AND:new n._Code("&&"),ADD:new n._Code("+")};class i{optimizeNodes(){return this}optimizeNames(e,t){return this}}class c extends i{constructor(e,t,r){super(),this.varKind=e,this.name=t,this.rhs=r}render({es5:e,_n:t}){const r=e?s.varKinds.var:this.varKind,n=void 0===this.rhs?"":` = ${this.rhs}`;return`${r} ${this.name}${n};`+t}optimizeNames(e,t){if(e[this.name.str])return this.rhs&&(this.rhs=N(this.rhs,e,t)),this}get names(){return this.rhs instanceof n._CodeOrName?this.rhs.names:{}}}class l extends i{constructor(e,t,r){super(),this.lhs=e,this.rhs=t,this.sideEffects=r}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,t){if(!(this.lhs instanceof n.Name)||e[this.lhs.str]||this.sideEffects)return this.rhs=N(this.rhs,e,t),this}get names(){return O(this.lhs instanceof n.Name?{}:{...this.lhs.names},this.rhs)}}class u extends l{constructor(e,t,r,n){super(e,r,n),this.op=t}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}}class d extends i{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}}class h extends i{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}}class p extends i{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}}class f extends i{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,t){return this.code=N(this.code,e,t),this}get names(){return this.code instanceof n._CodeOrName?this.code.names:{}}}class m extends i{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce(((t,r)=>t+r.render(e)),"")}optimizeNodes(){const{nodes:e}=this;let t=e.length;for(;t--;){const r=e[t].optimizeNodes();Array.isArray(r)?e.splice(t,1,...r):r?e[t]=r:e.splice(t,1)}return e.length>0?this:void 0}optimizeNames(e,t){const{nodes:r}=this;let n=r.length;for(;n--;){const s=r[n];s.optimizeNames(e,t)||(T(e,s.names),r.splice(n,1))}return r.length>0?this:void 0}get names(){return this.nodes.reduce(((e,t)=>C(e,t.names)),{})}}class v extends m{render(e){return"{"+e._n+super.render(e)+"}"+e._n}}class g extends m{}class y extends v{}y.kind="else";class b extends v{constructor(e,t){super(t),this.condition=e}render(e){let t=`if(${this.condition})`+super.render(e);return this.else&&(t+="else "+this.else.render(e)),t}optimizeNodes(){super.optimizeNodes();const e=this.condition;if(!0===e)return this.nodes;let t=this.else;if(t){const e=t.optimizeNodes();t=this.else=Array.isArray(e)?new y(e):e}return t?!1===e?t instanceof b?t:t.nodes:this.nodes.length?this:new b(j(e),t instanceof b?[t]:t.nodes):!1!==e&&this.nodes.length?this:void 0}optimizeNames(e,t){var r;if(this.else=null===(r=this.else)||void 0===r?void 0:r.optimizeNames(e,t),super.optimizeNames(e,t)||this.else)return this.condition=N(this.condition,e,t),this}get names(){const e=super.names;return O(e,this.condition),this.else&&C(e,this.else.names),e}}b.kind="if";class $ extends v{}$.kind="for";class w extends ${constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iteration=N(this.iteration,e,t),this}get names(){return C(super.names,this.iteration.names)}}class _ extends ${constructor(e,t,r,n){super(),this.varKind=e,this.name=t,this.from=r,this.to=n}render(e){const t=e.es5?s.varKinds.var:this.varKind,{name:r,from:n,to:o}=this;return`for(${t} ${r}=${n}; ${r}<${o}; ${r}++)`+super.render(e)}get names(){const e=O(super.names,this.from);return O(e,this.to)}}class k extends ${constructor(e,t,r,n){super(),this.loop=e,this.varKind=t,this.name=r,this.iterable=n}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,t){if(super.optimizeNames(e,t))return this.iterable=N(this.iterable,e,t),this}get names(){return C(super.names,this.iterable.names)}}class E extends v{constructor(e,t,r){super(),this.name=e,this.args=t,this.async=r}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}}E.kind="func";class x extends m{render(e){return"return "+super.render(e)}}x.kind="return";class S extends v{render(e){let t="try"+super.render(e);return this.catch&&(t+=this.catch.render(e)),this.finally&&(t+=this.finally.render(e)),t}optimizeNodes(){var e,t;return super.optimizeNodes(),null===(e=this.catch)||void 0===e||e.optimizeNodes(),null===(t=this.finally)||void 0===t||t.optimizeNodes(),this}optimizeNames(e,t){var r,n;return super.optimizeNames(e,t),null===(r=this.catch)||void 0===r||r.optimizeNames(e,t),null===(n=this.finally)||void 0===n||n.optimizeNames(e,t),this}get names(){const e=super.names;return this.catch&&C(e,this.catch.names),this.finally&&C(e,this.finally.names),e}}class P extends v{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}}P.kind="catch";class A extends v{render(e){return"finally"+super.render(e)}}function C(e,t){for(const r in t)e[r]=(e[r]||0)+(t[r]||0);return e}function O(e,t){return t instanceof n._CodeOrName?C(e,t.names):e}function N(e,t,r){return e instanceof n.Name?o(e):(s=e)instanceof n._Code&&s._items.some((e=>e instanceof n.Name&&1===t[e.str]&&void 0!==r[e.str]))?new n._Code(e._items.reduce(((e,t)=>(t instanceof n.Name&&(t=o(t)),t instanceof n._Code?e.push(...t._items):e.push(t),e)),[])):e;var s;function o(e){const n=r[e.str];return void 0===n||1!==t[e.str]?e:(delete t[e.str],n)}}function T(e,t){for(const r in t)e[r]=(e[r]||0)-(t[r]||0)}function j(e){return"boolean"==typeof e||"number"==typeof e||null===e?!e:n._`!${R(e)}`}A.kind="finally",t.CodeGen=class{constructor(e,t={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...t,_n:t.lines?"\n":""},this._extScope=e,this._scope=new s.Scope({parent:e}),this._nodes=[new g]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,t){const r=this._extScope.value(e,t);return(this._values[r.prefix]||(this._values[r.prefix]=new Set)).add(r),r}getScopeValue(e,t){return this._extScope.getValue(e,t)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,t,r,n){const s=this._scope.toName(t);return void 0!==r&&n&&(this._constants[s.str]=r),this._leafNode(new c(e,s,r)),s}const(e,t,r){return this._def(s.varKinds.const,e,t,r)}let(e,t,r){return this._def(s.varKinds.let,e,t,r)}var(e,t,r){return this._def(s.varKinds.var,e,t,r)}assign(e,t,r){return this._leafNode(new l(e,t,r))}add(e,r){return this._leafNode(new u(e,t.operators.ADD,r))}code(e){return"function"==typeof e?e():e!==n.nil&&this._leafNode(new f(e)),this}object(...e){const t=["{"];for(const[r,s]of e)t.length>1&&t.push(","),t.push(r),(r!==s||this.opts.es5)&&(t.push(":"),(0,n.addCodeArg)(t,s));return t.push("}"),new n._Code(t)}if(e,t,r){if(this._blockNode(new b(e)),t&&r)this.code(t).else().code(r).endIf();else if(t)this.code(t).endIf();else if(r)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new b(e))}else(){return this._elseNode(new y)}endIf(){return this._endBlockNode(b,y)}_for(e,t){return this._blockNode(e),t&&this.code(t).endFor(),this}for(e,t){return this._for(new w(e),t)}forRange(e,t,r,n,o=(this.opts.es5?s.varKinds.var:s.varKinds.let)){const a=this._scope.toName(e);return this._for(new _(o,a,t,r),(()=>n(a)))}forOf(e,t,r,o=s.varKinds.const){const a=this._scope.toName(e);if(this.opts.es5){const e=t instanceof n.Name?t:this.var("_arr",t);return this.forRange("_i",0,n._`${e}.length`,(t=>{this.var(a,n._`${e}[${t}]`),r(a)}))}return this._for(new k("of",o,a,t),(()=>r(a)))}forIn(e,t,r,o=(this.opts.es5?s.varKinds.var:s.varKinds.const)){if(this.opts.ownProperties)return this.forOf(e,n._`Object.keys(${t})`,r);const a=this._scope.toName(e);return this._for(new k("in",o,a,t),(()=>r(a)))}endFor(){return this._endBlockNode($)}label(e){return this._leafNode(new d(e))}break(e){return this._leafNode(new h(e))}return(e){const t=new x;if(this._blockNode(t),this.code(e),1!==t.nodes.length)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(x)}try(e,t,r){if(!t&&!r)throw new Error('CodeGen: "try" without "catch" and "finally"');const n=new S;if(this._blockNode(n),this.code(e),t){const e=this.name("e");this._currNode=n.catch=new P(e),t(e)}return r&&(this._currNode=n.finally=new A,this.code(r)),this._endBlockNode(P,A)}throw(e){return this._leafNode(new p(e))}block(e,t){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(t),this}endBlock(e){const t=this._blockStarts.pop();if(void 0===t)throw new Error("CodeGen: not in self-balancing block");const r=this._nodes.length-t;if(r<0||void 0!==e&&r!==e)throw new Error(`CodeGen: wrong number of nodes: ${r} vs ${e} expected`);return this._nodes.length=t,this}func(e,t=n.nil,r,s){return this._blockNode(new E(e,t,r)),s&&this.code(s).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,t){const r=this._currNode;if(r instanceof e||t&&r instanceof t)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${t?`${e.kind}/${t.kind}`:e.kind}"`)}_elseNode(e){const t=this._currNode;if(!(t instanceof b))throw new Error('CodeGen: "else" without "if"');return this._currNode=t.else=e,this}get _root(){return this._nodes[0]}get _currNode(){const e=this._nodes;return e[e.length-1]}set _currNode(e){const t=this._nodes;t[t.length-1]=e}},t.not=j;const D=M(t.operators.AND);t.and=function(...e){return e.reduce(D)};const I=M(t.operators.OR);function M(e){return(t,r)=>t===n.nil?r:r===n.nil?t:n._`${R(t)} ${e} ${R(r)}`}function R(e){return e instanceof n.Name?e:n._`(${e})`}t.or=function(...e){return e.reduce(I)}},8490:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ValueScope=t.ValueScopeName=t.Scope=t.varKinds=t.UsedValueState=void 0;const n=r(7023);class s extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}}var o;!function(e){e[e.Started=0]="Started",e[e.Completed=1]="Completed"}(o=t.UsedValueState||(t.UsedValueState={})),t.varKinds={const:new n.Name("const"),let:new n.Name("let"),var:new n.Name("var")};class a{constructor({prefixes:e,parent:t}={}){this._names={},this._prefixes=e,this._parent=t}toName(e){return e instanceof n.Name?e:this.name(e)}name(e){return new n.Name(this._newName(e))}_newName(e){return`${e}${(this._names[e]||this._nameGroup(e)).index++}`}_nameGroup(e){var t,r;if((null===(r=null===(t=this._parent)||void 0===t?void 0:t._prefixes)||void 0===r?void 0:r.has(e))||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}}t.Scope=a;class i extends n.Name{constructor(e,t){super(t),this.prefix=e}setValue(e,{property:t,itemIndex:r}){this.value=e,this.scopePath=n._`.${new n.Name(t)}[${r}]`}}t.ValueScopeName=i;const c=n._`\n`;t.ValueScope=class extends a{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?c:n.nil}}get(){return this._scope}name(e){return new i(e,this._newName(e))}value(e,t){var r;if(void 0===t.ref)throw new Error("CodeGen: ref must be passed in value");const n=this.toName(e),{prefix:s}=n,o=null!==(r=t.key)&&void 0!==r?r:t.ref;let a=this._values[s];if(a){const e=a.get(o);if(e)return e}else a=this._values[s]=new Map;a.set(o,n);const i=this._scope[s]||(this._scope[s]=[]),c=i.length;return i[c]=t.ref,n.setValue(t,{property:s,itemIndex:c}),n}getValue(e,t){const r=this._values[e];if(r)return r.get(t)}scopeRefs(e,t=this._values){return this._reduceValues(t,(t=>{if(void 0===t.scopePath)throw new Error(`CodeGen: name "${t}" has no value`);return n._`${e}${t.scopePath}`}))}scopeCode(e=this._values,t,r){return this._reduceValues(e,(e=>{if(void 0===e.value)throw new Error(`CodeGen: name "${e}" has no value`);return e.value.code}),t,r)}_reduceValues(e,r,a={},i){let c=n.nil;for(const l in e){const u=e[l];if(!u)continue;const d=a[l]=a[l]||new Map;u.forEach((e=>{if(d.has(e))return;d.set(e,o.Started);let a=r(e);if(a){const r=this.opts.es5?t.varKinds.var:t.varKinds.const;c=n._`${c}${r} ${e} = ${a};${this.opts._n}`}else{if(!(a=null==i?void 0:i(e)))throw new s(e);c=n._`${c}${a}${this.opts._n}`}d.set(e,o.Completed)}))}return c}}},4181:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendErrors=t.resetErrorsCount=t.reportExtraError=t.reportError=t.keyword$DataError=t.keywordError=void 0;const n=r(3487),s=r(6776),o=r(2141);function a(e,t){const r=e.const("err",t);e.if(n._`${o.default.vErrors} === null`,(()=>e.assign(o.default.vErrors,n._`[${r}]`)),n._`${o.default.vErrors}.push(${r})`),e.code(n._`${o.default.errors}++`)}function i(e,t){const{gen:r,validateName:s,schemaEnv:o}=e;o.$async?r.throw(n._`new ${e.ValidationError}(${t})`):(r.assign(n._`${s}.errors`,t),r.return(!1))}t.keywordError={message:({keyword:e})=>n.str`must pass "${e}" keyword validation`},t.keyword$DataError={message:({keyword:e,schemaType:t})=>t?n.str`"${e}" keyword must be ${t} ($data)`:n.str`"${e}" keyword is invalid ($data)`},t.reportError=function(e,r=t.keywordError,s,o){const{it:c}=e,{gen:u,compositeRule:d,allErrors:h}=c,p=l(e,r,s);(null!=o?o:d||h)?a(u,p):i(c,n._`[${p}]`)},t.reportExtraError=function(e,r=t.keywordError,n){const{it:s}=e,{gen:c,compositeRule:u,allErrors:d}=s;a(c,l(e,r,n)),u||d||i(s,o.default.vErrors)},t.resetErrorsCount=function(e,t){e.assign(o.default.errors,t),e.if(n._`${o.default.vErrors} !== null`,(()=>e.if(t,(()=>e.assign(n._`${o.default.vErrors}.length`,t)),(()=>e.assign(o.default.vErrors,null)))))},t.extendErrors=function({gen:e,keyword:t,schemaValue:r,data:s,errsCount:a,it:i}){if(void 0===a)throw new Error("ajv implementation error");const c=e.name("err");e.forRange("i",a,o.default.errors,(a=>{e.const(c,n._`${o.default.vErrors}[${a}]`),e.if(n._`${c}.instancePath === undefined`,(()=>e.assign(n._`${c}.instancePath`,(0,n.strConcat)(o.default.instancePath,i.errorPath)))),e.assign(n._`${c}.schemaPath`,n.str`${i.errSchemaPath}/${t}`),i.opts.verbose&&(e.assign(n._`${c}.schema`,r),e.assign(n._`${c}.data`,s))}))};const c={keyword:new n.Name("keyword"),schemaPath:new n.Name("schemaPath"),params:new n.Name("params"),propertyName:new n.Name("propertyName"),message:new n.Name("message"),schema:new n.Name("schema"),parentSchema:new n.Name("parentSchema")};function l(e,t,r){const{createErrors:s}=e.it;return!1===s?n._`{}`:function(e,t,r={}){const{gen:s,it:a}=e,i=[u(a,r),d(e,r)];return function(e,{params:t,message:r},s){const{keyword:a,data:i,schemaValue:l,it:u}=e,{opts:d,propertyName:h,topSchemaRef:p,schemaPath:f}=u;s.push([c.keyword,a],[c.params,"function"==typeof t?t(e):t||n._`{}`]),d.messages&&s.push([c.message,"function"==typeof r?r(e):r]),d.verbose&&s.push([c.schema,l],[c.parentSchema,n._`${p}${f}`],[o.default.data,i]),h&&s.push([c.propertyName,h])}(e,t,i),s.object(...i)}(e,t,r)}function u({errorPath:e},{instancePath:t}){const r=t?n.str`${e}${(0,s.getErrorPath)(t,s.Type.Str)}`:e;return[o.default.instancePath,(0,n.strConcat)(o.default.instancePath,r)]}function d({keyword:e,it:{errSchemaPath:t}},{schemaPath:r,parentSchema:o}){let a=o?t:n.str`${t}/${e}`;return r&&(a=n.str`${a}${(0,s.getErrorPath)(r,s.Type.Str)}`),[c.schemaPath,a]}},5173:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.resolveSchema=t.getCompilingSchema=t.resolveRef=t.compileSchema=t.SchemaEnv=void 0;const n=r(3487),s=r(7426),o=r(2141),a=r(2531),i=r(6776),c=r(4815);class l{constructor(e){var t;let r;this.refs={},this.dynamicAnchors={},"object"==typeof e.schema&&(r=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=null!==(t=e.baseId)&&void 0!==t?t:(0,a.normalizeId)(null==r?void 0:r[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=null==r?void 0:r.$async,this.refs={}}}function u(e){const t=h.call(this,e);if(t)return t;const r=(0,a.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:i,lines:l}=this.opts.code,{ownProperties:u}=this.opts,d=new n.CodeGen(this.scope,{es5:i,lines:l,ownProperties:u});let p;e.$async&&(p=d.scopeValue("Error",{ref:s.default,code:n._`require("ajv/dist/runtime/validation_error").default`}));const f=d.scopeName("validate");e.validateName=f;const m={gen:d,allErrors:this.opts.allErrors,data:o.default.data,parentData:o.default.parentData,parentDataProperty:o.default.parentDataProperty,dataNames:[o.default.data],dataPathArr:[n.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:d.scopeValue("schema",!0===this.opts.code.source?{ref:e.schema,code:(0,n.stringify)(e.schema)}:{ref:e.schema}),validateName:f,ValidationError:p,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:n.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:n._`""`,opts:this.opts,self:this};let v;try{this._compilations.add(e),(0,c.validateFunctionCode)(m),d.optimize(this.opts.code.optimize);const t=d.toString();v=`${d.scopeRefs(o.default.scope)}return ${t}`,this.opts.code.process&&(v=this.opts.code.process(v,e));const r=new Function(`${o.default.self}`,`${o.default.scope}`,v)(this,this.scope.get());if(this.scope.value(f,{ref:r}),r.errors=null,r.schema=e.schema,r.schemaEnv=e,e.$async&&(r.$async=!0),!0===this.opts.code.source&&(r.source={validateName:f,validateCode:t,scopeValues:d._values}),this.opts.unevaluated){const{props:e,items:t}=m;r.evaluated={props:e instanceof n.Name?void 0:e,items:t instanceof n.Name?void 0:t,dynamicProps:e instanceof n.Name,dynamicItems:t instanceof n.Name},r.source&&(r.source.evaluated=(0,n.stringify)(r.evaluated))}return e.validate=r,e}catch(t){throw delete e.validate,delete e.validateName,v&&this.logger.error("Error compiling schema, function code:",v),t}finally{this._compilations.delete(e)}}function d(e){return(0,a.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:u.call(this,e)}function h(e){for(const n of this._compilations)if(r=e,(t=n).schema===r.schema&&t.root===r.root&&t.baseId===r.baseId)return n;var t,r}function p(e,t){let r;for(;"string"==typeof(r=this.refs[t]);)t=r;return r||this.schemas[t]||f.call(this,e,t)}function f(e,t){const r=this.opts.uriResolver.parse(t),n=(0,a._getFullPath)(this.opts.uriResolver,r);let s=(0,a.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===s)return v.call(this,r,e);const o=(0,a.normalizeId)(n),i=this.refs[o]||this.schemas[o];if("string"==typeof i){const t=f.call(this,e,i);if("object"!=typeof(null==t?void 0:t.schema))return;return v.call(this,r,t)}if("object"==typeof(null==i?void 0:i.schema)){if(i.validate||u.call(this,i),o===(0,a.normalizeId)(t)){const{schema:t}=i,{schemaId:r}=this.opts,n=t[r];return n&&(s=(0,a.resolveUrl)(this.opts.uriResolver,s,n)),new l({schema:t,schemaId:r,root:e,baseId:s})}return v.call(this,r,i)}}t.SchemaEnv=l,t.compileSchema=u,t.resolveRef=function(e,t,r){var n;r=(0,a.resolveUrl)(this.opts.uriResolver,t,r);const s=e.refs[r];if(s)return s;let o=p.call(this,e,r);if(void 0===o){const s=null===(n=e.localRefs)||void 0===n?void 0:n[r],{schemaId:a}=this.opts;s&&(o=new l({schema:s,schemaId:a,root:e,baseId:t}))}return void 0!==o?e.refs[r]=d.call(this,o):void 0},t.getCompilingSchema=h,t.resolveSchema=f;const m=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function v(e,{baseId:t,schema:r,root:n}){var s;if("/"!==(null===(s=e.fragment)||void 0===s?void 0:s[0]))return;for(const n of e.fragment.slice(1).split("/")){if("boolean"==typeof r)return;const e=r[(0,i.unescapeFragment)(n)];if(void 0===e)return;const s="object"==typeof(r=e)&&r[this.opts.schemaId];!m.has(n)&&s&&(t=(0,a.resolveUrl)(this.opts.uriResolver,t,s))}let o;if("boolean"!=typeof r&&r.$ref&&!(0,i.schemaHasRulesButRef)(r,this.RULES)){const e=(0,a.resolveUrl)(this.opts.uriResolver,t,r.$ref);o=f.call(this,n,e)}const{schemaId:c}=this.opts;return o=o||new l({schema:r,schemaId:c,root:n,baseId:t}),o.schema!==o.root.schema?o:void 0}},2141:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s={data:new n.Name("data"),valCxt:new n.Name("valCxt"),instancePath:new n.Name("instancePath"),parentData:new n.Name("parentData"),parentDataProperty:new n.Name("parentDataProperty"),rootData:new n.Name("rootData"),dynamicAnchors:new n.Name("dynamicAnchors"),vErrors:new n.Name("vErrors"),errors:new n.Name("errors"),this:new n.Name("this"),self:new n.Name("self"),scope:new n.Name("scope"),json:new n.Name("json"),jsonPos:new n.Name("jsonPos"),jsonLen:new n.Name("jsonLen"),jsonPart:new n.Name("jsonPart")};t.default=s},6646:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(2531);class s extends Error{constructor(e,t,r,s){super(s||`can't resolve reference ${r} from id ${t}`),this.missingRef=(0,n.resolveUrl)(e,t,r),this.missingSchema=(0,n.normalizeId)((0,n.getFullPath)(e,this.missingRef))}}t.default=s},2531:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSchemaRefs=t.resolveUrl=t.normalizeId=t._getFullPath=t.getFullPath=t.inlineRef=void 0;const n=r(6776),s=r(4063),o=r(9461),a=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);t.inlineRef=function(e,t=!0){return"boolean"==typeof e||(!0===t?!c(e):!!t&&l(e)<=t)};const i=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function c(e){for(const t in e){if(i.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(c))return!0;if("object"==typeof r&&c(r))return!0}return!1}function l(e){let t=0;for(const r in e){if("$ref"===r)return 1/0;if(t++,!a.has(r)&&("object"==typeof e[r]&&(0,n.eachItem)(e[r],(e=>t+=l(e))),t===1/0))return 1/0}return t}function u(e,t="",r){!1!==r&&(t=p(t));const n=e.parse(t);return d(e,n)}function d(e,t){return e.serialize(t).split("#")[0]+"#"}t.getFullPath=u,t._getFullPath=d;const h=/#\/?$/;function p(e){return e?e.replace(h,""):""}t.normalizeId=p,t.resolveUrl=function(e,t,r){return r=p(r),e.resolve(t,r)};const f=/^[a-z_][-a-z0-9._]*$/i;t.getSchemaRefs=function(e,t){if("boolean"==typeof e)return{};const{schemaId:r,uriResolver:n}=this.opts,a=p(e[r]||t),i={"":a},c=u(n,a,!1),l={},d=new Set;return o(e,{allKeys:!0},((e,t,n,s)=>{if(void 0===s)return;const o=c+t;let a=i[s];function u(t){const r=this.opts.uriResolver.resolve;if(t=p(a?r(a,t):t),d.has(t))throw m(t);d.add(t);let n=this.refs[t];return"string"==typeof n&&(n=this.refs[n]),"object"==typeof n?h(e,n.schema,t):t!==p(o)&&("#"===t[0]?(h(e,l[t],t),l[t]=e):this.refs[t]=o),t}function v(e){if("string"==typeof e){if(!f.test(e))throw new Error(`invalid anchor "${e}"`);u.call(this,`#${e}`)}}"string"==typeof e[r]&&(a=u.call(this,e[r])),v.call(this,e.$anchor),v.call(this,e.$dynamicAnchor),i[t]=a})),l;function h(e,t,r){if(void 0!==t&&!s(e,t))throw m(r)}function m(e){return new Error(`reference "${e}" resolves to more than one schema`)}}},3141:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRules=t.isJSONType=void 0;const r=new Set(["string","number","integer","boolean","null","object","array"]);t.isJSONType=function(e){return"string"==typeof e&&r.has(e)},t.getRules=function(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}},6776:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkStrictMode=t.getErrorPath=t.Type=t.useFunc=t.setEvaluated=t.evaluatedPropsToName=t.mergeEvaluated=t.eachItem=t.unescapeJsonPointer=t.escapeJsonPointer=t.escapeFragment=t.unescapeFragment=t.schemaRefOrVal=t.schemaHasRulesButRef=t.schemaHasRules=t.checkUnknownRules=t.alwaysValidSchema=t.toHash=void 0;const n=r(3487),s=r(7023);function o(e,t=e.schema){const{opts:r,self:n}=e;if(!r.strictSchema)return;if("boolean"==typeof t)return;const s=n.RULES.keywords;for(const r in t)s[r]||f(e,`unknown keyword: "${r}"`)}function a(e,t){if("boolean"==typeof e)return!e;for(const r in e)if(t[r])return!0;return!1}function i(e){return"number"==typeof e?`${e}`:e.replace(/~/g,"~0").replace(/\//g,"~1")}function c(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function l({mergeNames:e,mergeToName:t,mergeValues:r,resultToName:s}){return(o,a,i,c)=>{const l=void 0===i?a:i instanceof n.Name?(a instanceof n.Name?e(o,a,i):t(o,a,i),i):a instanceof n.Name?(t(o,i,a),a):r(a,i);return c!==n.Name||l instanceof n.Name?l:s(o,l)}}function u(e,t){if(!0===t)return e.var("props",!0);const r=e.var("props",n._`{}`);return void 0!==t&&d(e,r,t),r}function d(e,t,r){Object.keys(r).forEach((r=>e.assign(n._`${t}${(0,n.getProperty)(r)}`,!0)))}t.toHash=function(e){const t={};for(const r of e)t[r]=!0;return t},t.alwaysValidSchema=function(e,t){return"boolean"==typeof t?t:0===Object.keys(t).length||(o(e,t),!a(t,e.self.RULES.all))},t.checkUnknownRules=o,t.schemaHasRules=a,t.schemaHasRulesButRef=function(e,t){if("boolean"==typeof e)return!e;for(const r in e)if("$ref"!==r&&t.all[r])return!0;return!1},t.schemaRefOrVal=function({topSchemaRef:e,schemaPath:t},r,s,o){if(!o){if("number"==typeof r||"boolean"==typeof r)return r;if("string"==typeof r)return n._`${r}`}return n._`${e}${t}${(0,n.getProperty)(s)}`},t.unescapeFragment=function(e){return c(decodeURIComponent(e))},t.escapeFragment=function(e){return encodeURIComponent(i(e))},t.escapeJsonPointer=i,t.unescapeJsonPointer=c,t.eachItem=function(e,t){if(Array.isArray(e))for(const r of e)t(r);else t(e)},t.mergeEvaluated={props:l({mergeNames:(e,t,r)=>e.if(n._`${r} !== true && ${t} !== undefined`,(()=>{e.if(n._`${t} === true`,(()=>e.assign(r,!0)),(()=>e.assign(r,n._`${r} || {}`).code(n._`Object.assign(${r}, ${t})`)))})),mergeToName:(e,t,r)=>e.if(n._`${r} !== true`,(()=>{!0===t?e.assign(r,!0):(e.assign(r,n._`${r} || {}`),d(e,r,t))})),mergeValues:(e,t)=>!0===e||{...e,...t},resultToName:u}),items:l({mergeNames:(e,t,r)=>e.if(n._`${r} !== true && ${t} !== undefined`,(()=>e.assign(r,n._`${t} === true ? true : ${r} > ${t} ? ${r} : ${t}`))),mergeToName:(e,t,r)=>e.if(n._`${r} !== true`,(()=>e.assign(r,!0===t||n._`${r} > ${t} ? ${r} : ${t}`))),mergeValues:(e,t)=>!0===e||Math.max(e,t),resultToName:(e,t)=>e.var("items",t)})},t.evaluatedPropsToName=u,t.setEvaluated=d;const h={};var p;function f(e,t,r=e.opts.strictSchema){if(r){if(t=`strict mode: ${t}`,!0===r)throw new Error(t);e.self.logger.warn(t)}}t.useFunc=function(e,t){return e.scopeValue("func",{ref:t,code:h[t.code]||(h[t.code]=new s._Code(t.code))})},function(e){e[e.Num=0]="Num",e[e.Str=1]="Str"}(p=t.Type||(t.Type={})),t.getErrorPath=function(e,t,r){if(e instanceof n.Name){const s=t===p.Num;return r?s?n._`"[" + ${e} + "]"`:n._`"['" + ${e} + "']"`:s?n._`"/" + ${e}`:n._`"/" + ${e}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,n.getProperty)(e).toString():"/"+i(e)},t.checkStrictMode=f},8876:(e,t)=>{"use strict";function r(e,t){return t.rules.some((t=>n(e,t)))}function n(e,t){var r;return void 0!==e[t.keyword]||(null===(r=t.definition.implements)||void 0===r?void 0:r.some((t=>void 0!==e[t])))}Object.defineProperty(t,"__esModule",{value:!0}),t.shouldUseRule=t.shouldUseGroup=t.schemaHasRulesForType=void 0,t.schemaHasRulesForType=function({schema:e,self:t},n){const s=t.RULES.types[n];return s&&!0!==s&&r(e,s)},t.shouldUseGroup=r,t.shouldUseRule=n},5667:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boolOrEmptySchema=t.topBoolOrEmptySchema=void 0;const n=r(4181),s=r(3487),o=r(2141),a={message:"boolean schema is false"};function i(e,t){const{gen:r,data:s}=e,o={gen:r,keyword:"false schema",data:s,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,n.reportError)(o,a,void 0,t)}t.topBoolOrEmptySchema=function(e){const{gen:t,schema:r,validateName:n}=e;!1===r?i(e,!1):"object"==typeof r&&!0===r.$async?t.return(o.default.data):(t.assign(s._`${n}.errors`,null),t.return(!0))},t.boolOrEmptySchema=function(e,t){const{gen:r,schema:n}=e;!1===n?(r.var(t,!1),i(e)):r.var(t,!0)}},453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportTypeError=t.checkDataTypes=t.checkDataType=t.coerceAndCheckDataType=t.getJSONTypes=t.getSchemaTypes=t.DataType=void 0;const n=r(3141),s=r(8876),o=r(4181),a=r(3487),i=r(6776);var c;function l(e){const t=Array.isArray(e)?e:e?[e]:[];if(t.every(n.isJSONType))return t;throw new Error("type must be JSONType or JSONType[]: "+t.join(","))}!function(e){e[e.Correct=0]="Correct",e[e.Wrong=1]="Wrong"}(c=t.DataType||(t.DataType={})),t.getSchemaTypes=function(e){const t=l(e.type);if(t.includes("null")){if(!1===e.nullable)throw new Error("type: null contradicts nullable: false")}else{if(!t.length&&void 0!==e.nullable)throw new Error('"nullable" cannot be used without "type"');!0===e.nullable&&t.push("null")}return t},t.getJSONTypes=l,t.coerceAndCheckDataType=function(e,t){const{gen:r,data:n,opts:o}=e,i=function(e,t){return t?e.filter((e=>u.has(e)||"array"===t&&"array"===e)):[]}(t,o.coerceTypes),l=t.length>0&&!(0===i.length&&1===t.length&&(0,s.schemaHasRulesForType)(e,t[0]));if(l){const s=h(t,n,o.strictNumbers,c.Wrong);r.if(s,(()=>{i.length?function(e,t,r){const{gen:n,data:s,opts:o}=e,i=n.let("dataType",a._`typeof ${s}`),c=n.let("coerced",a._`undefined`);"array"===o.coerceTypes&&n.if(a._`${i} == 'object' && Array.isArray(${s}) && ${s}.length == 1`,(()=>n.assign(s,a._`${s}[0]`).assign(i,a._`typeof ${s}`).if(h(t,s,o.strictNumbers),(()=>n.assign(c,s))))),n.if(a._`${c} !== undefined`);for(const e of r)(u.has(e)||"array"===e&&"array"===o.coerceTypes)&&l(e);function l(e){switch(e){case"string":return void n.elseIf(a._`${i} == "number" || ${i} == "boolean"`).assign(c,a._`"" + ${s}`).elseIf(a._`${s} === null`).assign(c,a._`""`);case"number":return void n.elseIf(a._`${i} == "boolean" || ${s} === null
              || (${i} == "string" && ${s} && ${s} == +${s})`).assign(c,a._`+${s}`);case"integer":return void n.elseIf(a._`${i} === "boolean" || ${s} === null
              || (${i} === "string" && ${s} && ${s} == +${s} && !(${s} % 1))`).assign(c,a._`+${s}`);case"boolean":return void n.elseIf(a._`${s} === "false" || ${s} === 0 || ${s} === null`).assign(c,!1).elseIf(a._`${s} === "true" || ${s} === 1`).assign(c,!0);case"null":return n.elseIf(a._`${s} === "" || ${s} === 0 || ${s} === false`),void n.assign(c,null);case"array":n.elseIf(a._`${i} === "string" || ${i} === "number"
              || ${i} === "boolean" || ${s} === null`).assign(c,a._`[${s}]`)}}n.else(),f(e),n.endIf(),n.if(a._`${c} !== undefined`,(()=>{n.assign(s,c),function({gen:e,parentData:t,parentDataProperty:r},n){e.if(a._`${t} !== undefined`,(()=>e.assign(a._`${t}[${r}]`,n)))}(e,c)}))}(e,t,i):f(e)}))}return l};const u=new Set(["string","number","integer","boolean","null"]);function d(e,t,r,n=c.Correct){const s=n===c.Correct?a.operators.EQ:a.operators.NEQ;let o;switch(e){case"null":return a._`${t} ${s} null`;case"array":o=a._`Array.isArray(${t})`;break;case"object":o=a._`${t} && typeof ${t} == "object" && !Array.isArray(${t})`;break;case"integer":o=i(a._`!(${t} % 1) && !isNaN(${t})`);break;case"number":o=i();break;default:return a._`typeof ${t} ${s} ${e}`}return n===c.Correct?o:(0,a.not)(o);function i(e=a.nil){return(0,a.and)(a._`typeof ${t} == "number"`,e,r?a._`isFinite(${t})`:a.nil)}}function h(e,t,r,n){if(1===e.length)return d(e[0],t,r,n);let s;const o=(0,i.toHash)(e);if(o.array&&o.object){const e=a._`typeof ${t} != "object"`;s=o.null?e:a._`!${t} || ${e}`,delete o.null,delete o.array,delete o.object}else s=a.nil;o.number&&delete o.integer;for(const e in o)s=(0,a.and)(s,d(e,t,r,n));return s}t.checkDataType=d,t.checkDataTypes=h;const p={message:({schema:e})=>`must be ${e}`,params:({schema:e,schemaValue:t})=>"string"==typeof e?a._`{type: ${e}}`:a._`{type: ${t}}`};function f(e){const t=function(e){const{gen:t,data:r,schema:n}=e,s=(0,i.schemaRefOrVal)(e,n,"type");return{gen:t,keyword:"type",data:r,schema:n.type,schemaCode:s,schemaValue:s,parentSchema:n,params:{},it:e}}(e);(0,o.reportError)(t,p)}t.reportTypeError=f},313:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assignDefaults=void 0;const n=r(3487),s=r(6776);function o(e,t,r){const{gen:o,compositeRule:a,data:i,opts:c}=e;if(void 0===r)return;const l=n._`${i}${(0,n.getProperty)(t)}`;if(a)return void(0,s.checkStrictMode)(e,`default is ignored for: ${l}`);let u=n._`${l} === undefined`;"empty"===c.useDefaults&&(u=n._`${u} || ${l} === null || ${l} === ""`),o.if(u,n._`${l} = ${(0,n.stringify)(r)}`)}t.assignDefaults=function(e,t){const{properties:r,items:n}=e.schema;if("object"===t&&r)for(const t in r)o(e,t,r[t].default);else"array"===t&&Array.isArray(n)&&n.forEach(((t,r)=>o(e,r,t.default)))}},4815:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getData=t.KeywordCxt=t.validateFunctionCode=void 0;const n=r(5667),s=r(453),o=r(8876),a=r(453),i=r(313),c=r(5005),l=r(3099),u=r(3487),d=r(2141),h=r(2531),p=r(6776),f=r(4181);function m({gen:e,validateName:t,schema:r,schemaEnv:n,opts:s},o){s.code.es5?e.func(t,u._`${d.default.data}, ${d.default.valCxt}`,n.$async,(()=>{e.code(u._`"use strict"; ${v(r,s)}`),function(e,t){e.if(d.default.valCxt,(()=>{e.var(d.default.instancePath,u._`${d.default.valCxt}.${d.default.instancePath}`),e.var(d.default.parentData,u._`${d.default.valCxt}.${d.default.parentData}`),e.var(d.default.parentDataProperty,u._`${d.default.valCxt}.${d.default.parentDataProperty}`),e.var(d.default.rootData,u._`${d.default.valCxt}.${d.default.rootData}`),t.dynamicRef&&e.var(d.default.dynamicAnchors,u._`${d.default.valCxt}.${d.default.dynamicAnchors}`)}),(()=>{e.var(d.default.instancePath,u._`""`),e.var(d.default.parentData,u._`undefined`),e.var(d.default.parentDataProperty,u._`undefined`),e.var(d.default.rootData,d.default.data),t.dynamicRef&&e.var(d.default.dynamicAnchors,u._`{}`)}))}(e,s),e.code(o)})):e.func(t,u._`${d.default.data}, ${function(e){return u._`{${d.default.instancePath}="", ${d.default.parentData}, ${d.default.parentDataProperty}, ${d.default.rootData}=${d.default.data}${e.dynamicRef?u._`, ${d.default.dynamicAnchors}={}`:u.nil}}={}`}(s)}`,n.$async,(()=>e.code(v(r,s)).code(o)))}function v(e,t){const r="object"==typeof e&&e[t.schemaId];return r&&(t.code.source||t.code.process)?u._`/*# sourceURL=${r} */`:u.nil}function g({schema:e,self:t}){if("boolean"==typeof e)return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function y(e){return"boolean"!=typeof e.schema}function b(e){(0,p.checkUnknownRules)(e),function(e){const{schema:t,errSchemaPath:r,opts:n,self:s}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(t,s.RULES)&&s.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}(e)}function $(e,t){if(e.opts.jtd)return _(e,[],!1,t);const r=(0,s.getSchemaTypes)(e.schema);_(e,r,!(0,s.coerceAndCheckDataType)(e,r),t)}function w({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:s}){const o=r.$comment;if(!0===s.$comment)e.code(u._`${d.default.self}.logger.log(${o})`);else if("function"==typeof s.$comment){const r=u.str`${n}/$comment`,s=e.scopeValue("root",{ref:t.root});e.code(u._`${d.default.self}.opts.$comment(${o}, ${r}, ${s}.schema)`)}}function _(e,t,r,n){const{gen:s,schema:i,data:c,allErrors:l,opts:h,self:f}=e,{RULES:m}=f;function v(p){(0,o.shouldUseGroup)(i,p)&&(p.type?(s.if((0,a.checkDataType)(p.type,c,h.strictNumbers)),k(e,p),1===t.length&&t[0]===p.type&&r&&(s.else(),(0,a.reportTypeError)(e)),s.endIf()):k(e,p),l||s.if(u._`${d.default.errors} === ${n||0}`))}!i.$ref||!h.ignoreKeywordsWithRef&&(0,p.schemaHasRulesButRef)(i,m)?(h.jtd||function(e,t){!e.schemaEnv.meta&&e.opts.strictTypes&&(function(e,t){t.length&&(e.dataTypes.length?(t.forEach((t=>{E(e.dataTypes,t)||x(e,`type "${t}" not allowed by context "${e.dataTypes.join(",")}"`)})),function(e,t){const r=[];for(const n of e.dataTypes)E(t,n)?r.push(n):t.includes("integer")&&"number"===n&&r.push("integer");e.dataTypes=r}(e,t)):e.dataTypes=t)}(e,t),e.opts.allowUnionTypes||function(e,t){t.length>1&&(2!==t.length||!t.includes("null"))&&x(e,"use allowUnionTypes to allow union type keyword")}(e,t),function(e,t){const r=e.self.RULES.all;for(const n in r){const s=r[n];if("object"==typeof s&&(0,o.shouldUseRule)(e.schema,s)){const{type:r}=s.definition;r.length&&!r.some((e=>{return n=e,(r=t).includes(n)||"number"===n&&r.includes("integer");var r,n}))&&x(e,`missing type "${r.join(",")}" for keyword "${n}"`)}}}(e,e.dataTypes))}(e,t),s.block((()=>{for(const e of m.rules)v(e);v(m.post)}))):s.block((()=>P(e,"$ref",m.all.$ref.definition)))}function k(e,t){const{gen:r,schema:n,opts:{useDefaults:s}}=e;s&&(0,i.assignDefaults)(e,t.type),r.block((()=>{for(const r of t.rules)(0,o.shouldUseRule)(n,r)&&P(e,r.keyword,r.definition,t.type)}))}function E(e,t){return e.includes(t)||"integer"===t&&e.includes("number")}function x(e,t){t+=` at "${e.schemaEnv.baseId+e.errSchemaPath}" (strictTypes)`,(0,p.checkStrictMode)(e,t,e.opts.strictTypes)}t.validateFunctionCode=function(e){y(e)&&(b(e),g(e))?function(e){const{schema:t,opts:r,gen:n}=e;m(e,(()=>{r.$comment&&t.$comment&&w(e),function(e){const{schema:t,opts:r}=e;void 0!==t.default&&r.useDefaults&&r.strictSchema&&(0,p.checkStrictMode)(e,"default is ignored in the schema root")}(e),n.let(d.default.vErrors,null),n.let(d.default.errors,0),r.unevaluated&&function(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",u._`${r}.evaluated`),t.if(u._`${e.evaluated}.dynamicProps`,(()=>t.assign(u._`${e.evaluated}.props`,u._`undefined`))),t.if(u._`${e.evaluated}.dynamicItems`,(()=>t.assign(u._`${e.evaluated}.items`,u._`undefined`)))}(e),$(e),function(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:s,opts:o}=e;r.$async?t.if(u._`${d.default.errors} === 0`,(()=>t.return(d.default.data)),(()=>t.throw(u._`new ${s}(${d.default.vErrors})`))):(t.assign(u._`${n}.errors`,d.default.vErrors),o.unevaluated&&function({gen:e,evaluated:t,props:r,items:n}){r instanceof u.Name&&e.assign(u._`${t}.props`,r),n instanceof u.Name&&e.assign(u._`${t}.items`,n)}(e),t.return(u._`${d.default.errors} === 0`))}(e)}))}(e):m(e,(()=>(0,n.topBoolOrEmptySchema)(e)))};class S{constructor(e,t,r){if((0,c.validateKeywordUsage)(e,t,r),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=r,this.data=e.data,this.schema=e.schema[r],this.$data=t.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,p.schemaRefOrVal)(e,this.schema,r,this.$data),this.schemaType=t.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=t,this.$data)this.schemaCode=e.gen.const("vSchema",O(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,c.validSchemaType)(this.schema,t.schemaType,t.allowUndefined))throw new Error(`${r} value must be ${JSON.stringify(t.schemaType)}`);("code"in t?t.trackErrors:!1!==t.errors)&&(this.errsCount=e.gen.const("_errs",d.default.errors))}result(e,t,r){this.failResult((0,u.not)(e),t,r)}failResult(e,t,r){this.gen.if(e),r?r():this.error(),t?(this.gen.else(),t(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,t){this.failResult((0,u.not)(e),void 0,t)}fail(e){if(void 0===e)return this.error(),void(this.allErrors||this.gen.if(!1));this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);const{schemaCode:t}=this;this.fail(u._`${t} !== undefined && (${(0,u.or)(this.invalid$data(),e)})`)}error(e,t,r){if(t)return this.setParams(t),this._error(e,r),void this.setParams({});this._error(e,r)}_error(e,t){(e?f.reportExtraError:f.reportError)(this,this.def.error,t)}$dataError(){(0,f.reportError)(this,this.def.$dataError||f.keyword$DataError)}reset(){if(void 0===this.errsCount)throw new Error('add "trackErrors" to keyword definition');(0,f.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,t){t?Object.assign(this.params,e):this.params=e}block$data(e,t,r=u.nil){this.gen.block((()=>{this.check$data(e,r),t()}))}check$data(e=u.nil,t=u.nil){if(!this.$data)return;const{gen:r,schemaCode:n,schemaType:s,def:o}=this;r.if((0,u.or)(u._`${n} === undefined`,t)),e!==u.nil&&r.assign(e,!0),(s.length||o.validateSchema)&&(r.elseIf(this.invalid$data()),this.$dataError(),e!==u.nil&&r.assign(e,!1)),r.else()}invalid$data(){const{gen:e,schemaCode:t,schemaType:r,def:n,it:s}=this;return(0,u.or)(function(){if(r.length){if(!(t instanceof u.Name))throw new Error("ajv implementation error");const e=Array.isArray(r)?r:[r];return u._`${(0,a.checkDataTypes)(e,t,s.opts.strictNumbers,a.DataType.Wrong)}`}return u.nil}(),function(){if(n.validateSchema){const r=e.scopeValue("validate$data",{ref:n.validateSchema});return u._`!${r}(${t})`}return u.nil}())}subschema(e,t){const r=(0,l.getSubschema)(this.it,e);(0,l.extendSubschemaData)(r,this.it,e),(0,l.extendSubschemaMode)(r,e);const s={...this.it,...r,items:void 0,props:void 0};return function(e,t){y(e)&&(b(e),g(e))?function(e,t){const{schema:r,gen:n,opts:s}=e;s.$comment&&r.$comment&&w(e),function(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,h.resolveUrl)(e.opts.uriResolver,e.baseId,t))}(e),function(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}(e);const o=n.const("_errs",d.default.errors);$(e,o),n.var(t,u._`${o} === ${d.default.errors}`)}(e,t):(0,n.boolOrEmptySchema)(e,t)}(s,t),s}mergeEvaluated(e,t){const{it:r,gen:n}=this;r.opts.unevaluated&&(!0!==r.props&&void 0!==e.props&&(r.props=p.mergeEvaluated.props(n,e.props,r.props,t)),!0!==r.items&&void 0!==e.items&&(r.items=p.mergeEvaluated.items(n,e.items,r.items,t)))}mergeValidEvaluated(e,t){const{it:r,gen:n}=this;if(r.opts.unevaluated&&(!0!==r.props||!0!==r.items))return n.if(t,(()=>this.mergeEvaluated(e,u.Name))),!0}}function P(e,t,r,n){const s=new S(e,r,t);"code"in r?r.code(s,n):s.$data&&r.validate?(0,c.funcKeywordCode)(s,r):"macro"in r?(0,c.macroKeywordCode)(s,r):(r.compile||r.validate)&&(0,c.funcKeywordCode)(s,r)}t.KeywordCxt=S;const A=/^\/(?:[^~]|~0|~1)*$/,C=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function O(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let s,o;if(""===e)return d.default.rootData;if("/"===e[0]){if(!A.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);s=e,o=d.default.rootData}else{const a=C.exec(e);if(!a)throw new Error(`Invalid JSON-pointer: ${e}`);const i=+a[1];if(s=a[2],"#"===s){if(i>=t)throw new Error(c("property/index",i));return n[t-i]}if(i>t)throw new Error(c("data",i));if(o=r[t-i],!s)return o}let a=o;const i=s.split("/");for(const e of i)e&&(o=u._`${o}${(0,u.getProperty)((0,p.unescapeJsonPointer)(e))}`,a=u._`${a} && ${o}`);return a;function c(e,r){return`Cannot access ${e} ${r} levels up, current level is ${t}`}}t.getData=O},5005:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateKeywordUsage=t.validSchemaType=t.funcKeywordCode=t.macroKeywordCode=void 0;const n=r(3487),s=r(2141),o=r(412),a=r(4181);function i(e){const{gen:t,data:r,it:s}=e;t.if(s.parentData,(()=>t.assign(r,n._`${s.parentData}[${s.parentDataProperty}]`)))}function c(e,t,r){if(void 0===r)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword","function"==typeof r?{ref:r}:{ref:r,code:(0,n.stringify)(r)})}t.macroKeywordCode=function(e,t){const{gen:r,keyword:s,schema:o,parentSchema:a,it:i}=e,l=t.macro.call(i.self,o,a,i),u=c(r,s,l);!1!==i.opts.validateSchema&&i.self.validateSchema(l,!0);const d=r.name("valid");e.subschema({schema:l,schemaPath:n.nil,errSchemaPath:`${i.errSchemaPath}/${s}`,topSchemaRef:u,compositeRule:!0},d),e.pass(d,(()=>e.error(!0)))},t.funcKeywordCode=function(e,t){var r;const{gen:l,keyword:u,schema:d,parentSchema:h,$data:p,it:f}=e;!function({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}(f,t);const m=!p&&t.compile?t.compile.call(f.self,d,h,f):t.validate,v=c(l,u,m),g=l.let("valid");function y(r=(t.async?n._`await `:n.nil)){const a=f.opts.passContext?s.default.this:s.default.self,i=!("compile"in t&&!p||!1===t.schema);l.assign(g,n._`${r}${(0,o.callValidateCode)(e,v,a,i)}`,t.modifying)}function b(e){var r;l.if((0,n.not)(null!==(r=t.valid)&&void 0!==r?r:g),e)}e.block$data(g,(function(){if(!1===t.errors)y(),t.modifying&&i(e),b((()=>e.error()));else{const r=t.async?function(){const e=l.let("ruleErrs",null);return l.try((()=>y(n._`await `)),(t=>l.assign(g,!1).if(n._`${t} instanceof ${f.ValidationError}`,(()=>l.assign(e,n._`${t}.errors`)),(()=>l.throw(t))))),e}():function(){const e=n._`${v}.errors`;return l.assign(e,null),y(n.nil),e}();t.modifying&&i(e),b((()=>function(e,t){const{gen:r}=e;r.if(n._`Array.isArray(${t})`,(()=>{r.assign(s.default.vErrors,n._`${s.default.vErrors} === null ? ${t} : ${s.default.vErrors}.concat(${t})`).assign(s.default.errors,n._`${s.default.vErrors}.length`),(0,a.extendErrors)(e)}),(()=>e.error()))}(e,r)))}})),e.ok(null!==(r=t.valid)&&void 0!==r?r:g)},t.validSchemaType=function(e,t,r=!1){return!t.length||t.some((t=>"array"===t?Array.isArray(e):"object"===t?e&&"object"==typeof e&&!Array.isArray(e):typeof e==t||r&&void 0===e))},t.validateKeywordUsage=function({schema:e,opts:t,self:r,errSchemaPath:n},s,o){if(Array.isArray(s.keyword)?!s.keyword.includes(o):s.keyword!==o)throw new Error("ajv implementation error");const a=s.dependencies;if(null==a?void 0:a.some((t=>!Object.prototype.hasOwnProperty.call(e,t))))throw new Error(`parent schema must have dependencies of ${o}: ${a.join(",")}`);if(s.validateSchema&&!s.validateSchema(e[o])){const e=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(s.validateSchema.errors);if("log"!==t.validateSchema)throw new Error(e);r.logger.error(e)}}},3099:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.extendSubschemaMode=t.extendSubschemaData=t.getSubschema=void 0;const n=r(3487),s=r(6776);t.getSubschema=function(e,{keyword:t,schemaProp:r,schema:o,schemaPath:a,errSchemaPath:i,topSchemaRef:c}){if(void 0!==t&&void 0!==o)throw new Error('both "keyword" and "schema" passed, only one allowed');if(void 0!==t){const o=e.schema[t];return void 0===r?{schema:o,schemaPath:n._`${e.schemaPath}${(0,n.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:o[r],schemaPath:n._`${e.schemaPath}${(0,n.getProperty)(t)}${(0,n.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,s.escapeFragment)(r)}`}}if(void 0!==o){if(void 0===a||void 0===i||void 0===c)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:o,schemaPath:a,topSchemaRef:c,errSchemaPath:i}}throw new Error('either "keyword" or "schema" must be passed')},t.extendSubschemaData=function(e,t,{dataProp:r,dataPropType:o,data:a,dataTypes:i,propertyName:c}){if(void 0!==a&&void 0!==r)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:l}=t;if(void 0!==r){const{errorPath:a,dataPathArr:i,opts:c}=t;u(l.let("data",n._`${t.data}${(0,n.getProperty)(r)}`,!0)),e.errorPath=n.str`${a}${(0,s.getErrorPath)(r,o,c.jsPropertySyntax)}`,e.parentDataProperty=n._`${r}`,e.dataPathArr=[...i,e.parentDataProperty]}function u(r){e.data=r,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,r]}void 0!==a&&(u(a instanceof n.Name?a:l.let("data",a,!0)),void 0!==c&&(e.propertyName=c)),i&&(e.dataTypes=i)},t.extendSubschemaMode=function(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:s,allErrors:o}){void 0!==n&&(e.compositeRule=n),void 0!==s&&(e.createErrors=s),void 0!==o&&(e.allErrors=o),e.jtdDiscriminator=t,e.jtdMetadata=r}},7159:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;var n=r(4815);Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return n.KeywordCxt}});var s=r(3487);Object.defineProperty(t,"_",{enumerable:!0,get:function(){return s._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return s.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return s.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return s.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return s.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return s.CodeGen}});const o=r(7426),a=r(6646),i=r(3141),c=r(5173),l=r(3487),u=r(2531),d=r(453),h=r(6776),p=r(4775),f=r(3589),m=(e,t)=>new RegExp(e,t);m.code="new RegExp";const v=["removeAdditional","useDefaults","coerceTypes"],g=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),y={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},b={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'};function $(e){var t,r,n,s,o,a,i,c,l,u,d,h,p,v,g,y,b,$,w,_,k,E,x,S,P;const A=e.strict,C=null===(t=e.code)||void 0===t?void 0:t.optimize,O=!0===C||void 0===C?1:C||0,N=null!==(n=null===(r=e.code)||void 0===r?void 0:r.regExp)&&void 0!==n?n:m,T=null!==(s=e.uriResolver)&&void 0!==s?s:f.default;return{strictSchema:null===(a=null!==(o=e.strictSchema)&&void 0!==o?o:A)||void 0===a||a,strictNumbers:null===(c=null!==(i=e.strictNumbers)&&void 0!==i?i:A)||void 0===c||c,strictTypes:null!==(u=null!==(l=e.strictTypes)&&void 0!==l?l:A)&&void 0!==u?u:"log",strictTuples:null!==(h=null!==(d=e.strictTuples)&&void 0!==d?d:A)&&void 0!==h?h:"log",strictRequired:null!==(v=null!==(p=e.strictRequired)&&void 0!==p?p:A)&&void 0!==v&&v,code:e.code?{...e.code,optimize:O,regExp:N}:{optimize:O,regExp:N},loopRequired:null!==(g=e.loopRequired)&&void 0!==g?g:200,loopEnum:null!==(y=e.loopEnum)&&void 0!==y?y:200,meta:null===(b=e.meta)||void 0===b||b,messages:null===($=e.messages)||void 0===$||$,inlineRefs:null===(w=e.inlineRefs)||void 0===w||w,schemaId:null!==(_=e.schemaId)&&void 0!==_?_:"$id",addUsedSchema:null===(k=e.addUsedSchema)||void 0===k||k,validateSchema:null===(E=e.validateSchema)||void 0===E||E,validateFormats:null===(x=e.validateFormats)||void 0===x||x,unicodeRegExp:null===(S=e.unicodeRegExp)||void 0===S||S,int32range:null===(P=e.int32range)||void 0===P||P,uriResolver:T}}class w{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...$(e)};const{es5:t,lines:r}=this.opts.code;this.scope=new l.ValueScope({scope:{},prefixes:g,es5:t,lines:r}),this.logger=function(e){if(!1===e)return A;if(void 0===e)return console;if(e.log&&e.warn&&e.error)return e;throw new Error("logger must implement log, warn and error methods")}(e.logger);const n=e.validateFormats;e.validateFormats=!1,this.RULES=(0,i.getRules)(),_.call(this,y,e,"NOT SUPPORTED"),_.call(this,b,e,"DEPRECATED","warn"),this._metaOpts=P.call(this),e.formats&&x.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&S.call(this,e.keywords),"object"==typeof e.meta&&this.addMetaSchema(e.meta),E.call(this),e.validateFormats=n}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:e,meta:t,schemaId:r}=this.opts;let n=p;"id"===r&&(n={...p},n.id=n.$id,delete n.$id),t&&e&&this.addMetaSchema(n,n[r],!1)}defaultMeta(){const{meta:e,schemaId:t}=this.opts;return this.opts.defaultMeta="object"==typeof e?e[t]||e:void 0}validate(e,t){let r;if("string"==typeof e){if(r=this.getSchema(e),!r)throw new Error(`no schema with key or ref "${e}"`)}else r=this.compile(e);const n=r(t);return"$async"in r||(this.errors=r.errors),n}compile(e,t){const r=this._addSchema(e,t);return r.validate||this._compileSchemaEnv(r)}compileAsync(e,t){if("function"!=typeof this.opts.loadSchema)throw new Error("options.loadSchema should be a function");const{loadSchema:r}=this.opts;return n.call(this,e,t);async function n(e,t){await s.call(this,e.$schema);const r=this._addSchema(e,t);return r.validate||o.call(this,r)}async function s(e){e&&!this.getSchema(e)&&await n.call(this,{$ref:e},!0)}async function o(e){try{return this._compileSchemaEnv(e)}catch(t){if(!(t instanceof a.default))throw t;return i.call(this,t),await c.call(this,t.missingSchema),o.call(this,e)}}function i({missingSchema:e,missingRef:t}){if(this.refs[e])throw new Error(`AnySchema ${e} is loaded but ${t} cannot be resolved`)}async function c(e){const r=await l.call(this,e);this.refs[e]||await s.call(this,r.$schema),this.refs[e]||this.addSchema(r,e,t)}async function l(e){const t=this._loading[e];if(t)return t;try{return await(this._loading[e]=r(e))}finally{delete this._loading[e]}}}addSchema(e,t,r,n=this.opts.validateSchema){if(Array.isArray(e)){for(const t of e)this.addSchema(t,void 0,r,n);return this}let s;if("object"==typeof e){const{schemaId:t}=this.opts;if(s=e[t],void 0!==s&&"string"!=typeof s)throw new Error(`schema ${t} must be string`)}return t=(0,u.normalizeId)(t||s),this._checkUnique(t),this.schemas[t]=this._addSchema(e,r,t,n,!0),this}addMetaSchema(e,t,r=this.opts.validateSchema){return this.addSchema(e,t,!0,r),this}validateSchema(e,t){if("boolean"==typeof e)return!0;let r;if(r=e.$schema,void 0!==r&&"string"!=typeof r)throw new Error("$schema must be a string");if(r=r||this.opts.defaultMeta||this.defaultMeta(),!r)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const n=this.validate(r,e);if(!n&&t){const e="schema is invalid: "+this.errorsText();if("log"!==this.opts.validateSchema)throw new Error(e);this.logger.error(e)}return n}getSchema(e){let t;for(;"string"==typeof(t=k.call(this,e));)e=t;if(void 0===t){const{schemaId:r}=this.opts,n=new c.SchemaEnv({schema:{},schemaId:r});if(t=c.resolveSchema.call(this,n,e),!t)return;this.refs[e]=t}return t.validate||this._compileSchemaEnv(t)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const t=k.call(this,e);return"object"==typeof t&&this._cache.delete(t.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{const t=e;this._cache.delete(t);let r=e[this.opts.schemaId];return r&&(r=(0,u.normalizeId)(r),delete this.schemas[r],delete this.refs[r]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(const t of e)this.addKeyword(t);return this}addKeyword(e,t){let r;if("string"==typeof e)r=e,"object"==typeof t&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),t.keyword=r);else{if("object"!=typeof e||void 0!==t)throw new Error("invalid addKeywords parameters");if(r=(t=e).keyword,Array.isArray(r)&&!r.length)throw new Error("addKeywords: keyword must be string or non-empty array")}if(O.call(this,r,t),!t)return(0,h.eachItem)(r,(e=>N.call(this,e))),this;j.call(this,t);const n={...t,type:(0,d.getJSONTypes)(t.type),schemaType:(0,d.getJSONTypes)(t.schemaType)};return(0,h.eachItem)(r,0===n.type.length?e=>N.call(this,e,n):e=>n.type.forEach((t=>N.call(this,e,n,t)))),this}getKeyword(e){const t=this.RULES.all[e];return"object"==typeof t?t.definition:!!t}removeKeyword(e){const{RULES:t}=this;delete t.keywords[e],delete t.all[e];for(const r of t.rules){const t=r.rules.findIndex((t=>t.keyword===e));t>=0&&r.rules.splice(t,1)}return this}addFormat(e,t){return"string"==typeof t&&(t=new RegExp(t)),this.formats[e]=t,this}errorsText(e=this.errors,{separator:t=", ",dataVar:r="data"}={}){return e&&0!==e.length?e.map((e=>`${r}${e.instancePath} ${e.message}`)).reduce(((e,r)=>e+t+r)):"No errors"}$dataMetaSchema(e,t){const r=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(const n of t){const t=n.split("/").slice(1);let s=e;for(const e of t)s=s[e];for(const e in r){const t=r[e];if("object"!=typeof t)continue;const{$data:n}=t.definition,o=s[e];n&&o&&(s[e]=I(o))}}return e}_removeAllSchemas(e,t){for(const r in e){const n=e[r];t&&!t.test(r)||("string"==typeof n?delete e[r]:n&&!n.meta&&(this._cache.delete(n.schema),delete e[r]))}}_addSchema(e,t,r,n=this.opts.validateSchema,s=this.opts.addUsedSchema){let o;const{schemaId:a}=this.opts;if("object"==typeof e)o=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if("boolean"!=typeof e)throw new Error("schema must be object or boolean")}let i=this._cache.get(e);if(void 0!==i)return i;r=(0,u.normalizeId)(o||r);const l=u.getSchemaRefs.call(this,e,r);return i=new c.SchemaEnv({schema:e,schemaId:a,meta:t,baseId:r,localRefs:l}),this._cache.set(i.schema,i),s&&!r.startsWith("#")&&(r&&this._checkUnique(r),this.refs[r]=i),n&&this.validateSchema(e,!0),i}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):c.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){const t=this.opts;this.opts=this._metaOpts;try{c.compileSchema.call(this,e)}finally{this.opts=t}}}function _(e,t,r,n="error"){for(const s in e){const o=s;o in t&&this.logger[n](`${r}: option ${s}. ${e[o]}`)}}function k(e){return e=(0,u.normalizeId)(e),this.schemas[e]||this.refs[e]}function E(){const e=this.opts.schemas;if(e)if(Array.isArray(e))this.addSchema(e);else for(const t in e)this.addSchema(e[t],t)}function x(){for(const e in this.opts.formats){const t=this.opts.formats[e];t&&this.addFormat(e,t)}}function S(e){if(Array.isArray(e))this.addVocabulary(e);else{this.logger.warn("keywords option as map is deprecated, pass array");for(const t in e){const r=e[t];r.keyword||(r.keyword=t),this.addKeyword(r)}}}function P(){const e={...this.opts};for(const t of v)delete e[t];return e}t.default=w,w.ValidationError=o.default,w.MissingRefError=a.default;const A={log(){},warn(){},error(){}},C=/^[a-z_$][a-z0-9_$:-]*$/i;function O(e,t){const{RULES:r}=this;if((0,h.eachItem)(e,(e=>{if(r.keywords[e])throw new Error(`Keyword ${e} is already defined`);if(!C.test(e))throw new Error(`Keyword ${e} has invalid name`)})),t&&t.$data&&!("code"in t)&&!("validate"in t))throw new Error('$data keyword must have "code" or "validate" function')}function N(e,t,r){var n;const s=null==t?void 0:t.post;if(r&&s)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:o}=this;let a=s?o.post:o.rules.find((({type:e})=>e===r));if(a||(a={type:r,rules:[]},o.rules.push(a)),o.keywords[e]=!0,!t)return;const i={keyword:e,definition:{...t,type:(0,d.getJSONTypes)(t.type),schemaType:(0,d.getJSONTypes)(t.schemaType)}};t.before?T.call(this,a,i,t.before):a.rules.push(i),o.all[e]=i,null===(n=t.implements)||void 0===n||n.forEach((e=>this.addKeyword(e)))}function T(e,t,r){const n=e.rules.findIndex((e=>e.keyword===r));n>=0?e.rules.splice(n,0,t):(e.rules.push(t),this.logger.warn(`rule ${r} is not defined`))}function j(e){let{metaSchema:t}=e;void 0!==t&&(e.$data&&this.opts.$data&&(t=I(t)),e.validateSchema=this.compile(t,!0))}const D={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function I(e){return{anyOf:[e,D]}}},3510:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4063);n.code='require("ajv/dist/runtime/equal").default',t.default=n},4499:(e,t)=>{"use strict";function r(e){const t=e.length;let r,n=0,s=0;for(;s<t;)n++,r=e.charCodeAt(s++),r>=55296&&r<=56319&&s<t&&(r=e.charCodeAt(s),56320==(64512&r)&&s++);return n}Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,r.code='require("ajv/dist/runtime/ucs2length").default'},3589:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(540);n.code='require("ajv/dist/runtime/uri").default',t.default=n},7426:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});class r extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}}t.default=r},4783:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateAdditionalItems=void 0;const n=r(3487),s=r(6776),o={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>n.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>n._`{limit: ${e}}`},code(e){const{parentSchema:t,it:r}=e,{items:n}=t;Array.isArray(n)?a(e,n):(0,s.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas')}};function a(e,t){const{gen:r,schema:o,data:a,keyword:i,it:c}=e;c.items=!0;const l=r.const("len",n._`${a}.length`);if(!1===o)e.setParams({len:t.length}),e.pass(n._`${l} <= ${t.length}`);else if("object"==typeof o&&!(0,s.alwaysValidSchema)(c,o)){const o=r.var("valid",n._`${l} <= ${t.length}`);r.if((0,n.not)(o),(()=>function(o){r.forRange("i",t.length,l,(t=>{e.subschema({keyword:i,dataProp:t,dataPropType:s.Type.Num},o),c.allErrors||r.if((0,n.not)(o),(()=>r.break()))}))}(o))),e.ok(o)}}t.validateAdditionalItems=a,t.default=o},9351:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(412),s=r(3487),o=r(2141),a=r(6776),i={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:e})=>s._`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:i,data:c,errsCount:l,it:u}=e;if(!l)throw new Error("ajv implementation error");const{allErrors:d,opts:h}=u;if(u.props=!0,"all"!==h.removeAdditional&&(0,a.alwaysValidSchema)(u,r))return;const p=(0,n.allSchemaProperties)(i.properties),f=(0,n.allSchemaProperties)(i.patternProperties);function m(e){t.code(s._`delete ${c}[${e}]`)}function v(n){if("all"===h.removeAdditional||h.removeAdditional&&!1===r)m(n);else{if(!1===r)return e.setParams({additionalProperty:n}),e.error(),void(d||t.break());if("object"==typeof r&&!(0,a.alwaysValidSchema)(u,r)){const r=t.name("valid");"failing"===h.removeAdditional?(g(n,r,!1),t.if((0,s.not)(r),(()=>{e.reset(),m(n)}))):(g(n,r),d||t.if((0,s.not)(r),(()=>t.break())))}}}function g(t,r,n){const s={keyword:"additionalProperties",dataProp:t,dataPropType:a.Type.Str};!1===n&&Object.assign(s,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(s,r)}t.forIn("key",c,(r=>{p.length||f.length?t.if(function(r){let o;if(p.length>8){const e=(0,a.schemaRefOrVal)(u,i.properties,"properties");o=(0,n.isOwnProperty)(t,e,r)}else o=p.length?(0,s.or)(...p.map((e=>s._`${r} === ${e}`))):s.nil;return f.length&&(o=(0,s.or)(o,...f.map((t=>s._`${(0,n.usePattern)(e,t)}.test(${r})`)))),(0,s.not)(o)}(r),(()=>v(r))):v(r)})),e.ok(s._`${l} === ${o.default.errors}`)}};t.default=i},1125:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6776),s={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:s}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const o=t.name("valid");r.forEach(((t,r)=>{if((0,n.alwaysValidSchema)(s,t))return;const a=e.subschema({keyword:"allOf",schemaProp:r},o);e.ok(o),e.mergeEvaluated(a)}))}};t.default=s},19:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:r(412).validateUnion,error:{message:"must match a schema in anyOf"}};t.default=n},9864:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>void 0===t?n.str`must contain at least ${e} valid item(s)`:n.str`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>void 0===t?n._`{minContains: ${e}}`:n._`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:o,data:a,it:i}=e;let c,l;const{minContains:u,maxContains:d}=o;i.opts.next?(c=void 0===u?1:u,l=d):c=1;const h=t.const("len",n._`${a}.length`);if(e.setParams({min:c,max:l}),void 0===l&&0===c)return void(0,s.checkStrictMode)(i,'"minContains" == 0 without "maxContains": "contains" keyword ignored');if(void 0!==l&&c>l)return(0,s.checkStrictMode)(i,'"minContains" > "maxContains" is always invalid'),void e.fail();if((0,s.alwaysValidSchema)(i,r)){let t=n._`${h} >= ${c}`;return void 0!==l&&(t=n._`${t} && ${h} <= ${l}`),void e.pass(t)}i.items=!0;const p=t.name("valid");function f(){const e=t.name("_valid"),r=t.let("count",0);m(e,(()=>t.if(e,(()=>function(e){t.code(n._`${e}++`),void 0===l?t.if(n._`${e} >= ${c}`,(()=>t.assign(p,!0).break())):(t.if(n._`${e} > ${l}`,(()=>t.assign(p,!1).break())),1===c?t.assign(p,!0):t.if(n._`${e} >= ${c}`,(()=>t.assign(p,!0))))}(r)))))}function m(r,n){t.forRange("i",0,h,(t=>{e.subschema({keyword:"contains",dataProp:t,dataPropType:s.Type.Num,compositeRule:!0},r),n()}))}void 0===l&&1===c?m(p,(()=>t.if(p,(()=>t.break())))):0===c?(t.let(p,!0),void 0!==l&&t.if(n._`${a}.length > 0`,f)):(t.let(p,!1),f()),e.result(p,(()=>e.reset()))}};t.default=o},7772:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateSchemaDeps=t.validatePropertyDeps=t.error=void 0;const n=r(3487),s=r(6776),o=r(412);t.error={message:({params:{property:e,depsCount:t,deps:r}})=>{const s=1===t?"property":"properties";return n.str`must have ${s} ${r} when property ${e} is present`},params:({params:{property:e,depsCount:t,deps:r,missingProperty:s}})=>n._`{property: ${e},
    missingProperty: ${s},
    depsCount: ${t},
    deps: ${r}}`};const a={keyword:"dependencies",type:"object",schemaType:"object",error:t.error,code(e){const[t,r]=function({schema:e}){const t={},r={};for(const n in e)"__proto__"!==n&&((Array.isArray(e[n])?t:r)[n]=e[n]);return[t,r]}(e);i(e,t),c(e,r)}};function i(e,t=e.schema){const{gen:r,data:s,it:a}=e;if(0===Object.keys(t).length)return;const i=r.let("missing");for(const c in t){const l=t[c];if(0===l.length)continue;const u=(0,o.propertyInData)(r,s,c,a.opts.ownProperties);e.setParams({property:c,depsCount:l.length,deps:l.join(", ")}),a.allErrors?r.if(u,(()=>{for(const t of l)(0,o.checkReportMissingProp)(e,t)})):(r.if(n._`${u} && (${(0,o.checkMissingProp)(e,l,i)})`),(0,o.reportMissingProp)(e,i),r.else())}}function c(e,t=e.schema){const{gen:r,data:n,keyword:a,it:i}=e,c=r.name("valid");for(const l in t)(0,s.alwaysValidSchema)(i,t[l])||(r.if((0,o.propertyInData)(r,n,l,i.opts.ownProperties),(()=>{const t=e.subschema({keyword:a,schemaProp:l},c);e.mergeValidEvaluated(t,c)}),(()=>r.var(c,!0))),e.ok(c))}t.validatePropertyDeps=i,t.validateSchemaDeps=c,t.default=a},9434:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>n.str`must match "${e.ifClause}" schema`,params:({params:e})=>n._`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:o}=e;void 0===r.then&&void 0===r.else&&(0,s.checkStrictMode)(o,'"if" without "then" and "else" is ignored');const i=a(o,"then"),c=a(o,"else");if(!i&&!c)return;const l=t.let("valid",!0),u=t.name("_valid");if(function(){const t=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},u);e.mergeEvaluated(t)}(),e.reset(),i&&c){const r=t.let("ifClause");e.setParams({ifClause:r}),t.if(u,d("then",r),d("else",r))}else i?t.if(u,d("then")):t.if((0,n.not)(u),d("else"));function d(r,s){return()=>{const o=e.subschema({keyword:r},u);t.assign(l,u),e.mergeValidEvaluated(o,l),s?t.assign(s,n._`${r}`):e.setParams({ifClause:r})}}e.pass(l,(()=>e.error(!0)))}};function a(e,t){const r=e.schema[t];return void 0!==r&&!(0,s.alwaysValidSchema)(e,r)}t.default=o},8200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4783),s=r(2924),o=r(4665),a=r(1119),i=r(9864),c=r(7772),l=r(3708),u=r(9351),d=r(6239),h=r(2296),p=r(5697),f=r(19),m=r(4200),v=r(1125),g=r(9434),y=r(6552);t.default=function(e=!1){const t=[p.default,f.default,m.default,v.default,g.default,y.default,l.default,u.default,c.default,d.default,h.default];return e?t.push(s.default,a.default):t.push(n.default,o.default),t.push(i.default),t}},4665:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateTuple=void 0;const n=r(3487),s=r(6776),o=r(412),a={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return i(e,"additionalItems",t);r.items=!0,(0,s.alwaysValidSchema)(r,t)||e.ok((0,o.validateArray)(e))}};function i(e,t,r=e.schema){const{gen:o,parentSchema:a,data:i,keyword:c,it:l}=e;!function(e){const{opts:n,errSchemaPath:o}=l,a=r.length,i=a===e.minItems&&(a===e.maxItems||!1===e[t]);if(n.strictTuples&&!i){const e=`"${c}" is ${a}-tuple, but minItems or maxItems/${t} are not specified or different at path "${o}"`;(0,s.checkStrictMode)(l,e,n.strictTuples)}}(a),l.opts.unevaluated&&r.length&&!0!==l.items&&(l.items=s.mergeEvaluated.items(o,r.length,l.items));const u=o.name("valid"),d=o.const("len",n._`${i}.length`);r.forEach(((t,r)=>{(0,s.alwaysValidSchema)(l,t)||(o.if(n._`${d} > ${r}`,(()=>e.subschema({keyword:c,schemaProp:r,dataProp:r},u))),e.ok(u))}))}t.validateTuple=i,t.default=a},1119:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o=r(412),a=r(4783),i={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:e}})=>n.str`must NOT have more than ${e} items`,params:({params:{len:e}})=>n._`{limit: ${e}}`},code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:i}=r;n.items=!0,(0,s.alwaysValidSchema)(n,t)||(i?(0,a.validateAdditionalItems)(e,i):e.ok((0,o.validateArray)(e)))}};t.default=i},5697:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6776),s={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:s}=e;if((0,n.alwaysValidSchema)(s,r))return void e.fail();const o=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},o),e.failResult(o,(()=>e.reset()),(()=>e.error()))},error:{message:"must NOT be valid"}};t.default=s},4200:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:e})=>n._`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,parentSchema:o,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(a.opts.discriminator&&o.discriminator)return;const i=r,c=t.let("valid",!1),l=t.let("passing",null),u=t.name("_valid");e.setParams({passing:l}),t.block((function(){i.forEach(((r,o)=>{let i;(0,s.alwaysValidSchema)(a,r)?t.var(u,!0):i=e.subschema({keyword:"oneOf",schemaProp:o,compositeRule:!0},u),o>0&&t.if(n._`${u} && ${c}`).assign(c,!1).assign(l,n._`[${l}, ${o}]`).else(),t.if(u,(()=>{t.assign(c,!0),t.assign(l,o),i&&e.mergeEvaluated(i,n.Name)}))}))})),e.result(c,(()=>e.reset()),(()=>e.error(!0)))}};t.default=o},2296:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(412),s=r(3487),o=r(6776),a=r(6776),i={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:i,parentSchema:c,it:l}=e,{opts:u}=l,d=(0,n.allSchemaProperties)(r),h=d.filter((e=>(0,o.alwaysValidSchema)(l,r[e])));if(0===d.length||h.length===d.length&&(!l.opts.unevaluated||!0===l.props))return;const p=u.strictSchema&&!u.allowMatchingProperties&&c.properties,f=t.name("valid");!0===l.props||l.props instanceof s.Name||(l.props=(0,a.evaluatedPropsToName)(t,l.props));const{props:m}=l;function v(e){for(const t in p)new RegExp(e).test(t)&&(0,o.checkStrictMode)(l,`property ${t} matches pattern ${e} (use allowMatchingProperties)`)}function g(r){t.forIn("key",i,(o=>{t.if(s._`${(0,n.usePattern)(e,r)}.test(${o})`,(()=>{const n=h.includes(r);n||e.subschema({keyword:"patternProperties",schemaProp:r,dataProp:o,dataPropType:a.Type.Str},f),l.opts.unevaluated&&!0!==m?t.assign(s._`${m}[${o}]`,!0):n||l.allErrors||t.if((0,s.not)(f),(()=>t.break()))}))}))}!function(){for(const e of d)p&&v(e),l.allErrors?g(e):(t.var(f,!0),g(e),t.if(f))}()}};t.default=i},2924:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4665),s={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,n.validateTuple)(e,"items")};t.default=s},6239:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(4815),s=r(412),o=r(6776),a=r(9351),i={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:i,data:c,it:l}=e;"all"===l.opts.removeAdditional&&void 0===i.additionalProperties&&a.default.code(new n.KeywordCxt(l,a.default,"additionalProperties"));const u=(0,s.allSchemaProperties)(r);for(const e of u)l.definedProperties.add(e);l.opts.unevaluated&&u.length&&!0!==l.props&&(l.props=o.mergeEvaluated.props(t,(0,o.toHash)(u),l.props));const d=u.filter((e=>!(0,o.alwaysValidSchema)(l,r[e])));if(0===d.length)return;const h=t.name("valid");for(const r of d)p(r)?f(r):(t.if((0,s.propertyInData)(t,c,r,l.opts.ownProperties)),f(r),l.allErrors||t.else().var(h,!0),t.endIf()),e.it.definedProperties.add(r),e.ok(h);function p(e){return l.opts.useDefaults&&!l.compositeRule&&void 0!==r[e].default}function f(t){e.subschema({keyword:"properties",schemaProp:t,dataProp:t},h)}}};t.default=i},3708:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:e})=>n._`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:o,it:a}=e;if((0,s.alwaysValidSchema)(a,r))return;const i=t.name("valid");t.forIn("key",o,(r=>{e.setParams({propertyName:r}),e.subschema({keyword:"propertyNames",data:r,dataTypes:["string"],propertyName:r,compositeRule:!0},i),t.if((0,n.not)(i),(()=>{e.error(!0),a.allErrors||t.break()}))})),e.ok(i)}};t.default=o},6552:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(6776),s={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){void 0===t.if&&(0,n.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};t.default=s},412:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.validateUnion=t.validateArray=t.usePattern=t.callValidateCode=t.schemaProperties=t.allSchemaProperties=t.noPropertyInData=t.propertyInData=t.isOwnProperty=t.hasPropFunc=t.reportMissingProp=t.checkMissingProp=t.checkReportMissingProp=void 0;const n=r(3487),s=r(6776),o=r(2141),a=r(6776);function i(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:n._`Object.prototype.hasOwnProperty`})}function c(e,t,r){return n._`${i(e)}.call(${t}, ${r})`}function l(e,t,r,s){const o=n._`${t}${(0,n.getProperty)(r)} === undefined`;return s?(0,n.or)(o,(0,n.not)(c(e,t,r))):o}function u(e){return e?Object.keys(e).filter((e=>"__proto__"!==e)):[]}t.checkReportMissingProp=function(e,t){const{gen:r,data:s,it:o}=e;r.if(l(r,s,t,o.opts.ownProperties),(()=>{e.setParams({missingProperty:n._`${t}`},!0),e.error()}))},t.checkMissingProp=function({gen:e,data:t,it:{opts:r}},s,o){return(0,n.or)(...s.map((s=>(0,n.and)(l(e,t,s,r.ownProperties),n._`${o} = ${s}`))))},t.reportMissingProp=function(e,t){e.setParams({missingProperty:t},!0),e.error()},t.hasPropFunc=i,t.isOwnProperty=c,t.propertyInData=function(e,t,r,s){const o=n._`${t}${(0,n.getProperty)(r)} !== undefined`;return s?n._`${o} && ${c(e,t,r)}`:o},t.noPropertyInData=l,t.allSchemaProperties=u,t.schemaProperties=function(e,t){return u(t).filter((r=>!(0,s.alwaysValidSchema)(e,t[r])))},t.callValidateCode=function({schemaCode:e,data:t,it:{gen:r,topSchemaRef:s,schemaPath:a,errorPath:i},it:c},l,u,d){const h=d?n._`${e}, ${t}, ${s}${a}`:t,p=[[o.default.instancePath,(0,n.strConcat)(o.default.instancePath,i)],[o.default.parentData,c.parentData],[o.default.parentDataProperty,c.parentDataProperty],[o.default.rootData,o.default.rootData]];c.opts.dynamicRef&&p.push([o.default.dynamicAnchors,o.default.dynamicAnchors]);const f=n._`${h}, ${r.object(...p)}`;return u!==n.nil?n._`${l}.call(${u}, ${f})`:n._`${l}(${f})`};const d=n._`new RegExp`;t.usePattern=function({gen:e,it:{opts:t}},r){const s=t.unicodeRegExp?"u":"",{regExp:o}=t.code,i=o(r,s);return e.scopeValue("pattern",{key:i.toString(),ref:i,code:n._`${"new RegExp"===o.code?d:(0,a.useFunc)(e,o)}(${r}, ${s})`})},t.validateArray=function(e){const{gen:t,data:r,keyword:o,it:a}=e,i=t.name("valid");if(a.allErrors){const e=t.let("valid",!0);return c((()=>t.assign(e,!1))),e}return t.var(i,!0),c((()=>t.break())),i;function c(a){const c=t.const("len",n._`${r}.length`);t.forRange("i",0,c,(r=>{e.subschema({keyword:o,dataProp:r,dataPropType:s.Type.Num},i),t.if((0,n.not)(i),a)}))}},t.validateUnion=function(e){const{gen:t,schema:r,keyword:o,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some((e=>(0,s.alwaysValidSchema)(a,e)))&&!a.opts.unevaluated)return;const i=t.let("valid",!1),c=t.name("_valid");t.block((()=>r.forEach(((r,s)=>{const a=e.subschema({keyword:o,schemaProp:s,compositeRule:!0},c);t.assign(i,n._`${i} || ${c}`),e.mergeValidEvaluated(a,c)||t.if((0,n.not)(i))})))),e.result(i,(()=>e.reset()),(()=>e.error(!0)))}},8386:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};t.default=r},5684:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(8386),s=r(8280),o=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",n.default,s.default];t.default=o},8280:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.callRef=t.getValidate=void 0;const n=r(6646),s=r(412),o=r(3487),a=r(2141),i=r(5173),c=r(6776),l={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:s}=e,{baseId:a,schemaEnv:c,validateName:l,opts:h,self:p}=s,{root:f}=c;if(("#"===r||"#/"===r)&&a===f.baseId)return function(){if(c===f)return d(e,l,c,c.$async);const r=t.scopeValue("root",{ref:f});return d(e,o._`${r}.validate`,f,f.$async)}();const m=i.resolveRef.call(p,f,a,r);if(void 0===m)throw new n.default(s.opts.uriResolver,a,r);return m instanceof i.SchemaEnv?function(t){const r=u(e,t);d(e,r,t,t.$async)}(m):function(n){const s=t.scopeValue("schema",!0===h.code.source?{ref:n,code:(0,o.stringify)(n)}:{ref:n}),a=t.name("valid"),i=e.subschema({schema:n,dataTypes:[],schemaPath:o.nil,topSchemaRef:s,errSchemaPath:r},a);e.mergeEvaluated(i),e.ok(a)}(m)}};function u(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):o._`${r.scopeValue("wrapper",{ref:t})}.validate`}function d(e,t,r,n){const{gen:i,it:l}=e,{allErrors:u,schemaEnv:d,opts:h}=l,p=h.passContext?a.default.this:o.nil;function f(e){const t=o._`${e}.errors`;i.assign(a.default.vErrors,o._`${a.default.vErrors} === null ? ${t} : ${a.default.vErrors}.concat(${t})`),i.assign(a.default.errors,o._`${a.default.vErrors}.length`)}function m(e){var t;if(!l.opts.unevaluated)return;const n=null===(t=null==r?void 0:r.validate)||void 0===t?void 0:t.evaluated;if(!0!==l.props)if(n&&!n.dynamicProps)void 0!==n.props&&(l.props=c.mergeEvaluated.props(i,n.props,l.props));else{const t=i.var("props",o._`${e}.evaluated.props`);l.props=c.mergeEvaluated.props(i,t,l.props,o.Name)}if(!0!==l.items)if(n&&!n.dynamicItems)void 0!==n.items&&(l.items=c.mergeEvaluated.items(i,n.items,l.items));else{const t=i.var("items",o._`${e}.evaluated.items`);l.items=c.mergeEvaluated.items(i,t,l.items,o.Name)}}n?function(){if(!d.$async)throw new Error("async schema referenced by sync schema");const r=i.let("valid");i.try((()=>{i.code(o._`await ${(0,s.callValidateCode)(e,t,p)}`),m(t),u||i.assign(r,!0)}),(e=>{i.if(o._`!(${e} instanceof ${l.ValidationError})`,(()=>i.throw(e))),f(e),u||i.assign(r,!1)})),e.ok(r)}():e.result((0,s.callValidateCode)(e,t,p),(()=>m(t)),(()=>f(t)))}t.getValidate=u,t.callRef=d,t.default=l},1240:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(9306),o=r(5173),a=r(6776),i={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:e,tagName:t}})=>e===s.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>n._`{error: ${e}, tag: ${r}, tagValue: ${t}}`},code(e){const{gen:t,data:r,schema:i,parentSchema:c,it:l}=e,{oneOf:u}=c;if(!l.opts.discriminator)throw new Error("discriminator: requires discriminator option");const d=i.propertyName;if("string"!=typeof d)throw new Error("discriminator: requires propertyName");if(i.mapping)throw new Error("discriminator: mapping is not supported");if(!u)throw new Error("discriminator: requires oneOf keyword");const h=t.let("valid",!1),p=t.const("tag",n._`${r}${(0,n.getProperty)(d)}`);function f(r){const s=t.name("valid"),o=e.subschema({keyword:"oneOf",schemaProp:r},s);return e.mergeEvaluated(o,n.Name),s}t.if(n._`typeof ${p} == "string"`,(()=>function(){const r=function(){var e;const t={},r=s(c);let n=!0;for(let t=0;t<u.length;t++){let c=u[t];(null==c?void 0:c.$ref)&&!(0,a.schemaHasRulesButRef)(c,l.self.RULES)&&(c=o.resolveRef.call(l.self,l.schemaEnv.root,l.baseId,null==c?void 0:c.$ref),c instanceof o.SchemaEnv&&(c=c.schema));const h=null===(e=null==c?void 0:c.properties)||void 0===e?void 0:e[d];if("object"!=typeof h)throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${d}"`);n=n&&(r||s(c)),i(h,t)}if(!n)throw new Error(`discriminator: "${d}" must be required`);return t;function s({required:e}){return Array.isArray(e)&&e.includes(d)}function i(e,t){if(e.const)h(e.const,t);else{if(!e.enum)throw new Error(`discriminator: "properties/${d}" must have "const" or "enum"`);for(const r of e.enum)h(r,t)}}function h(e,r){if("string"!=typeof e||e in t)throw new Error(`discriminator: "${d}" values must be unique strings`);t[e]=r}}();t.if(!1);for(const e in r)t.elseIf(n._`${p} === ${e}`),t.assign(h,f(r[e]));t.else(),e.error(!1,{discrError:s.DiscrError.Mapping,tag:p,tagName:d}),t.endIf()}()),(()=>e.error(!1,{discrError:s.DiscrError.Tag,tag:p,tagName:d}))),e.ok(h)}};t.default=i},9306:(e,t)=>{"use strict";var r;Object.defineProperty(t,"__esModule",{value:!0}),t.DiscrError=void 0,(r=t.DiscrError||(t.DiscrError={})).Tag="tag",r.Mapping="mapping"},3924:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(5684),s=r(2649),o=r(8200),a=r(9502),i=r(6167),c=[n.default,s.default,(0,o.default)(),a.default,i.metadataVocabulary,i.contentVocabulary];t.default=c},9651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>n.str`must match format "${e}"`,params:({schemaCode:e})=>n._`{format: ${e}}`},code(e,t){const{gen:r,data:s,$data:o,schema:a,schemaCode:i,it:c}=e,{opts:l,errSchemaPath:u,schemaEnv:d,self:h}=c;l.validateFormats&&(o?function(){const o=r.scopeValue("formats",{ref:h.formats,code:l.code.formats}),a=r.const("fDef",n._`${o}[${i}]`),c=r.let("fType"),u=r.let("format");r.if(n._`typeof ${a} == "object" && !(${a} instanceof RegExp)`,(()=>r.assign(c,n._`${a}.type || "string"`).assign(u,n._`${a}.validate`)),(()=>r.assign(c,n._`"string"`).assign(u,a))),e.fail$data((0,n.or)(!1===l.strictSchema?n.nil:n._`${i} && !${u}`,function(){const e=d.$async?n._`(${a}.async ? await ${u}(${s}) : ${u}(${s}))`:n._`${u}(${s})`,r=n._`(typeof ${u} == "function" ? ${e} : ${u}.test(${s}))`;return n._`${u} && ${u} !== true && ${c} === ${t} && !${r}`}()))}():function(){const o=h.formats[a];if(!o)return void function(){if(!1!==l.strictSchema)throw new Error(e());function e(){return`unknown format "${a}" ignored in schema at path "${u}"`}h.logger.warn(e())}();if(!0===o)return;const[i,c,p]=function(e){const t=e instanceof RegExp?(0,n.regexpCode)(e):l.code.formats?n._`${l.code.formats}${(0,n.getProperty)(a)}`:void 0,s=r.scopeValue("formats",{key:a,ref:e,code:t});return"object"!=typeof e||e instanceof RegExp?["string",e,s]:[e.type||"string",e.validate,n._`${s}.validate`]}(o);i===t&&e.pass(function(){if("object"==typeof o&&!(o instanceof RegExp)&&o.async){if(!d.$async)throw new Error("async format in sync schema");return n._`await ${p}(${s})`}return"function"==typeof c?n._`${p}(${s})`:n._`${p}.test(${s})`}())}())}};t.default=s},9502:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=[r(9651).default];t.default=n},6167:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.contentVocabulary=t.metadataVocabulary=void 0,t.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],t.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]},4693:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o=r(3510),a={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:e})=>n._`{allowedValue: ${e}}`},code(e){const{gen:t,data:r,$data:a,schemaCode:i,schema:c}=e;a||c&&"object"==typeof c?e.fail$data(n._`!${(0,s.useFunc)(t,o.default)}(${r}, ${i})`):e.fail(n._`${c} !== ${r}`)}};t.default=a},966:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o=r(3510),a={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:e})=>n._`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:a,schema:i,schemaCode:c,it:l}=e;if(!a&&0===i.length)throw new Error("enum must have non-empty array");const u=i.length>=l.opts.loopEnum;let d;const h=()=>null!=d?d:d=(0,s.useFunc)(t,o.default);let p;if(u||a)p=t.let("valid"),e.block$data(p,(function(){t.assign(p,!1),t.forOf("v",c,(e=>t.if(n._`${h()}(${r}, ${e})`,(()=>t.assign(p,!0).break()))))}));else{if(!Array.isArray(i))throw new Error("ajv implementation error");const e=t.const("vSchema",c);p=(0,n.or)(...i.map(((t,s)=>function(e,t){const s=i[t];return"object"==typeof s&&null!==s?n._`${h()}(${r}, ${e}[${t}])`:n._`${r} === ${s}`}(e,s))))}e.pass(p)}};t.default=a},2649:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3983),s=r(430),o=r(3229),a=r(4336),i=r(498),c=r(3301),l=r(1687),u=r(2958),d=r(4693),h=r(966),p=[n.default,s.default,o.default,a.default,i.default,c.default,l.default,u.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},d.default,h.default];t.default=p},1687:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxItems"===e?"more":"fewer";return n.str`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:s}=e,o="maxItems"===t?n.operators.GT:n.operators.LT;e.fail$data(n._`${r}.length ${o} ${s}`)}};t.default=s},3229:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=r(6776),o=r(4499),a={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxLength"===e?"more":"fewer";return n.str`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:a,it:i}=e,c="maxLength"===t?n.operators.GT:n.operators.LT,l=!1===i.opts.unicode?n._`${r}.length`:n._`${(0,s.useFunc)(e.gen,o.default)}(${r})`;e.fail$data(n._`${l} ${c} ${a}`)}};t.default=a},3983:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s=n.operators,o={maximum:{okStr:"<=",ok:s.LTE,fail:s.GT},minimum:{okStr:">=",ok:s.GTE,fail:s.LT},exclusiveMaximum:{okStr:"<",ok:s.LT,fail:s.GTE},exclusiveMinimum:{okStr:">",ok:s.GT,fail:s.LTE}},a={message:({keyword:e,schemaCode:t})=>n.str`must be ${o[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>n._`{comparison: ${o[e].okStr}, limit: ${t}}`},i={keyword:Object.keys(o),type:"number",schemaType:"number",$data:!0,error:a,code(e){const{keyword:t,data:r,schemaCode:s}=e;e.fail$data(n._`${r} ${o[t].fail} ${s} || isNaN(${r})`)}};t.default=i},498:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r="maxProperties"===e?"more":"fewer";return n.str`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>n._`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:s}=e,o="maxProperties"===t?n.operators.GT:n.operators.LT;e.fail$data(n._`Object.keys(${r}).length ${o} ${s}`)}};t.default=s},430:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(3487),s={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>n.str`must be multiple of ${e}`,params:({schemaCode:e})=>n._`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:s,it:o}=e,a=o.opts.multipleOfPrecision,i=t.let("res"),c=a?n._`Math.abs(Math.round(${i}) - ${i}) > 1e-${a}`:n._`${i} !== parseInt(${i})`;e.fail$data(n._`(${s} === 0 || (${i} = ${r}/${s}, ${c}))`)}};t.default=s},4336:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(412),s=r(3487),o={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>s.str`must match pattern "${e}"`,params:({schemaCode:e})=>s._`{pattern: ${e}}`},code(e){const{data:t,$data:r,schema:o,schemaCode:a,it:i}=e,c=i.opts.unicodeRegExp?"u":"",l=r?s._`(new RegExp(${a}, ${c}))`:(0,n.usePattern)(e,o);e.fail$data(s._`!${l}.test(${t})`)}};t.default=o},3301:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(412),s=r(3487),o=r(6776),a={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>s.str`must have required property '${e}'`,params:({params:{missingProperty:e}})=>s._`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:a,data:i,$data:c,it:l}=e,{opts:u}=l;if(!c&&0===r.length)return;const d=r.length>=u.loopRequired;if(l.allErrors?function(){if(d||c)e.block$data(s.nil,h);else for(const t of r)(0,n.checkReportMissingProp)(e,t)}():function(){const o=t.let("missing");if(d||c){const r=t.let("valid",!0);e.block$data(r,(()=>function(r,o){e.setParams({missingProperty:r}),t.forOf(r,a,(()=>{t.assign(o,(0,n.propertyInData)(t,i,r,u.ownProperties)),t.if((0,s.not)(o),(()=>{e.error(),t.break()}))}),s.nil)}(o,r))),e.ok(r)}else t.if((0,n.checkMissingProp)(e,r,o)),(0,n.reportMissingProp)(e,o),t.else()}(),u.strictRequired){const t=e.parentSchema.properties,{definedProperties:n}=e.it;for(const e of r)if(void 0===(null==t?void 0:t[e])&&!n.has(e)){const t=`required property "${e}" is not defined at "${l.schemaEnv.baseId+l.errSchemaPath}" (strictRequired)`;(0,o.checkStrictMode)(l,t,l.opts.strictRequired)}}function h(){t.forOf("prop",a,(r=>{e.setParams({missingProperty:r}),t.if((0,n.noPropertyInData)(t,i,r,u.ownProperties),(()=>e.error()))}))}}};t.default=a},2958:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=r(453),s=r(3487),o=r(6776),a=r(3510),i={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>s.str`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>s._`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:i,schema:c,parentSchema:l,schemaCode:u,it:d}=e;if(!i&&!c)return;const h=t.let("valid"),p=l.items?(0,n.getSchemaTypes)(l.items):[];function f(o,a){const i=t.name("item"),c=(0,n.checkDataTypes)(p,i,d.opts.strictNumbers,n.DataType.Wrong),l=t.const("indices",s._`{}`);t.for(s._`;${o}--;`,(()=>{t.let(i,s._`${r}[${o}]`),t.if(c,s._`continue`),p.length>1&&t.if(s._`typeof ${i} == "string"`,s._`${i} += "_"`),t.if(s._`typeof ${l}[${i}] == "number"`,(()=>{t.assign(a,s._`${l}[${i}]`),e.error(),t.assign(h,!1).break()})).code(s._`${l}[${i}] = ${o}`)}))}function m(n,i){const c=(0,o.useFunc)(t,a.default),l=t.name("outer");t.label(l).for(s._`;${n}--;`,(()=>t.for(s._`${i} = ${n}; ${i}--;`,(()=>t.if(s._`${c}(${r}[${n}], ${r}[${i}])`,(()=>{e.error(),t.assign(h,!1).break(l)}))))))}e.block$data(h,(function(){const n=t.let("i",s._`${r}.length`),o=t.let("j");e.setParams({i:n,j:o}),t.assign(h,!0),t.if(s._`${n} > 1`,(()=>(p.length>0&&!p.some((e=>"object"===e||"array"===e))?f:m)(n,o)))}),s._`${u} === false`),e.ok(h)}};t.default=i},4063:e=>{"use strict";e.exports=function e(t,r){if(t===r)return!0;if(t&&r&&"object"==typeof t&&"object"==typeof r){if(t.constructor!==r.constructor)return!1;var n,s,o;if(Array.isArray(t)){if((n=t.length)!=r.length)return!1;for(s=n;0!=s--;)if(!e(t[s],r[s]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if((n=(o=Object.keys(t)).length)!==Object.keys(r).length)return!1;for(s=n;0!=s--;)if(!Object.prototype.hasOwnProperty.call(r,o[s]))return!1;for(s=n;0!=s--;){var a=o[s];if(!e(t[a],r[a]))return!1}return!0}return t!=t&&r!=r}},9461:e=>{"use strict";var t=e.exports=function(e,t,n){"function"==typeof t&&(n=t,t={}),r(t,"function"==typeof(n=t.cb||n)?n:n.pre||function(){},n.post||function(){},e,"",e)};function r(e,n,s,o,a,i,c,l,u,d){if(o&&"object"==typeof o&&!Array.isArray(o)){for(var h in n(o,a,i,c,l,u,d),o){var p=o[h];if(Array.isArray(p)){if(h in t.arrayKeywords)for(var f=0;f<p.length;f++)r(e,n,s,p[f],a+"/"+h+"/"+f,i,a,h,o,f)}else if(h in t.propsKeywords){if(p&&"object"==typeof p)for(var m in p)r(e,n,s,p[m],a+"/"+h+"/"+m.replace(/~/g,"~0").replace(/\//g,"~1"),i,a,h,o,m)}else(h in t.keywords||e.allKeys&&!(h in t.skipKeywords))&&r(e,n,s,p,a+"/"+h,i,a,h,o)}s(o,a,i,c,l,u,d)}}t.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},t.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},t.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},t.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0}},8998:(e,t,r)=>{e.exports=function e(t,r,n){function s(a,i){if(!r[a]){if(!t[a]){if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var l=r[a]={exports:{}};t[a][0].call(l.exports,(function(e){return s(t[a][1][e]||e)}),l,l.exports,e,t,r,n)}return r[a].exports}for(var o=void 0,a=0;a<n.length;a++)s(n[a]);return s}({1:[function(e,t,r){const n=e("./utils"),s=function(){"use strict";const e=n.stringToArray,t=["Zero","One","Two","Three","Four","Five","Six","Seven","Eight","Nine","Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["Zeroth","First","Second","Third","Fourth","Fifth","Sixth","Seventh","Eighth","Ninth","Tenth","Eleventh","Twelfth","Thirteenth","Fourteenth","Fifteenth","Sixteenth","Seventeenth","Eighteenth","Nineteenth"],s=["Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety","Hundred"],o=["Thousand","Million","Billion","Trillion"];const a={};t.forEach((function(e,t){a[e.toLowerCase()]=t})),r.forEach((function(e,t){a[e.toLowerCase()]=t})),s.forEach((function(e,t){const r=e.toLowerCase();a[r]=10*(t+2),a[r.substring(0,e.length-1)+"ieth"]=a[r]})),a.hundredth=100,o.forEach((function(e,t){const r=e.toLowerCase(),n=Math.pow(10,3*(t+1));a[r]=n,a[r+"th"]=n}));const i=[[1e3,"m"],[900,"cm"],[500,"d"],[400,"cd"],[100,"c"],[90,"xc"],[50,"l"],[40,"xl"],[10,"x"],[9,"ix"],[5,"v"],[4,"iv"],[1,"i"]],c={M:1e3,D:500,C:100,L:50,X:10,V:5,I:1};function l(e){for(var t=0;t<i.length;t++){const r=i[t];if(e>=r[0])return r[1]+l(e-r[0])}return""}function u(e,t){if(void 0!==e)return b(e=Math.floor(e),w(t))}const d="decimal",h="letters",p="roman",f="words",m="sequence",v="upper",g="lower",y="title";function b(n,a){let i;const c=n<0;switch(n=Math.abs(n),a.primary){case h:i=function(e,t){for(var r=[],n=t.charCodeAt(0);e>0;)r.unshift(String.fromCharCode((e-1)%26+n)),e=Math.floor((e-1)/26);return r.join("")}(n,a.case===v?"A":"a");break;case p:i=l(n),a.case===v&&(i=i.toUpperCase());break;case f:i=function(e,n){var a=function(e,n,i){var c="";if(e<=19)c=(n?" and ":"")+(i?r[e]:t[e]);else if(e<100){const t=Math.floor(e/10),r=e%10;c=(n?" and ":"")+s[t-2],r>0?c+="-"+a(r,!1,i):i&&(c=c.substring(0,c.length-1)+"ieth")}else if(e<1e3){const r=Math.floor(e/100),s=e%100;c=(n?", ":"")+t[r]+" Hundred",s>0?c+=a(s,!0,i):i&&(c+="th")}else{var l=Math.floor(Math.log10(e)/3);l>o.length&&(l=o.length);const t=Math.pow(10,3*l),r=Math.floor(e/t),s=e-r*t;c=(n?", ":"")+a(r,!1,!1)+" "+o[l-1],s>0?c+=a(s,!0,i):i&&(c+="th")}return c};return a(e,!1,n)}(n,a.ordinal),a.case===v?i=i.toUpperCase():a.case===g&&(i=i.toLowerCase());break;case d:i=""+n;var u=a.mandatoryDigits-i.length;if(u>0){var y=new Array(u+1).join("0");i=y+i}if(48!==a.zeroCode&&(i=e(i).map((e=>String.fromCodePoint(e.codePointAt(0)+a.zeroCode-48))).join("")),a.regular)for(let e=Math.floor((i.length-1)/a.groupingSeparators.position);e>0;e--){const t=i.length-e*a.groupingSeparators.position;i=i.substr(0,t)+a.groupingSeparators.character+i.substr(t)}else a.groupingSeparators.reverse().forEach((e=>{const t=i.length-e.position;i=i.substr(0,t)+e.character+i.substr(t)}));if(a.ordinal){var b={1:"st",2:"nd",3:"rd"}[i[i.length-1]];(!b||i.length>1&&"1"===i[i.length-2])&&(b="th"),i+=b}break;case m:throw{code:"D3130",value:a.token}}return c&&(i="-"+i),i}const $=[48,1632,1776,1984,2406,2534,2662,2790,2918,3046,3174,3302,3430,3558,3664,3792,3872,4160,4240,6112,6160,6470,6608,6784,6800,6992,7088,7232,7248,42528,43216,43264,43472,43504,43600,44016,65296];function w(t){const r={type:"integer",primary:d,case:g,ordinal:!1};let n,s;const o=t.lastIndexOf(";");switch(-1===o?n=t:(n=t.substring(0,o),s=t.substring(o+1),"o"===s[0]&&(r.ordinal=!0)),n){case"A":r.case=v;case"a":r.primary=h;break;case"I":r.case=v;case"i":r.primary=p;break;case"W":r.case=v,r.primary=f;break;case"Ww":r.case=y,r.primary=f;break;case"w":r.primary=f;break;default:{let t=null,s=0,o=0,a=[],i=0;if(e(n).map((e=>e.codePointAt(0))).reverse().forEach((e=>{let r=!1;for(let n=0;n<$.length;n++){const o=$[n];if(e>=o&&e<=o+9){if(r=!0,s++,i++,null===t)t=o;else if(o!==t)throw{code:"D3131"};break}}r||(35===e?(i++,o++):a.push({position:i,character:String.fromCodePoint(e)}))})),s>0){r.primary=d,r.zeroCode=t,r.mandatoryDigits=s,r.optionalDigits=o;const e=function(e){if(0===e.length)return 0;const t=e[0].character;for(let r=1;r<e.length;r++)if(e[r].character!==t)return 0;const r=e.map((e=>e.position)),n=function(e,t){return 0===t?e:n(t,e%t)},s=r.reduce(n);for(let e=1;e<=r.length;e++)if(-1===r.indexOf(e*s))return 0;return s}(a);e>0?(r.regular=!0,r.groupingSeparators={position:e,character:a[0].character}):(r.regular=!1,r.groupingSeparators=a)}else r.primary=m,r.token=n}}return r}const _={Y:"1",M:"1",D:"1",d:"1",F:"n",W:"1",w:"1",X:"1",x:"1",H:"1",h:"1",P:"n",m:"01",s:"01",f:"1",Z:"01:01",z:"01:01",C:"n",E:"n"};function k(e){var t=[];const r={type:"datetime",parts:t},n=function(r,n){if(n>r){let s=e.substring(r,n);s=s.split("]]").join("]"),t.push({type:"literal",value:s})}};for(var s=0,o=0;o<e.length;){if("["===e.charAt(o)){if("["===e.charAt(o+1)){n(s,o),t.push({type:"literal",value:"["}),s=o+=2;continue}if(n(s,o),s=o,-1===(o=e.indexOf("]",s)))throw{code:"D3135"};let r=e.substring(s+1,o);r=r.split(/\s+/).join("");var a,i={type:"marker",component:r.charAt(0)},c=r.lastIndexOf(",");if(-1!==c){const e=r.substring(c+1),t=e.indexOf("-");let n,s;const o=function(e){return void 0===e||"*"===e?void 0:parseInt(e)};-1===t?n=e:(n=e.substring(0,t),s=e.substring(t+1));const l={min:o(n),max:o(s)};i.width=l,a=r.substring(1,c)}else a=r.substring(1);if(1===a.length)i.presentation1=a;else if(a.length>1){var l=a.charAt(a.length-1);-1!=="atco".indexOf(l)?(i.presentation2=l,"o"===l&&(i.ordinal=!0),i.presentation1=a.substring(0,a.length-1)):i.presentation1=a}else i.presentation1=_[i.component];if(void 0===i.presentation1)throw{code:"D3132",value:i.component};if("n"===i.presentation1[0])i.names=g;else if("N"===i.presentation1[0])"n"===i.presentation1[1]?i.names=y:i.names=v;else if(-1!=="YMDdFWwXxHhmsf".indexOf(i.component)){var u=i.presentation1;if(i.presentation2&&(u+=";"+i.presentation2),i.integerFormat=w(u),i.width&&void 0!==i.width.min&&i.integerFormat.mandatoryDigits<i.width.min&&(i.integerFormat.mandatoryDigits=i.width.min),"Y"===i.component)if(i.n=-1,i.width&&void 0!==i.width.max)i.n=i.width.max,i.integerFormat.mandatoryDigits=i.n;else{var d=i.integerFormat.mandatoryDigits+i.integerFormat.optionalDigits;d>=2&&(i.n=d)}}"Z"!==i.component&&"z"!==i.component||(i.integerFormat=w(i.presentation1)),t.push(i),s=o+1}o++}return n(s,o),r}const E=["","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],x=["January","February","March","April","May","June","July","August","September","October","November","December"],S=864e5,P=function(e){const t=Date.UTC(e.year,e.month);var r=new Date(t).getUTCDay();return 0===r&&(r=7),r>4?t+(8-r)*S:t-(r-1)*S},A=function(e,t){return{year:e,month:t,nextMonth:function(){return 11===t?A(e+1,0):A(e,t+1)},previousMonth:function(){return 0===t?A(e-1,11):A(e,t-1)},nextYear:function(){return A(e+1,t)},previousYear:function(){return A(e-1,t)}}},C=function(e,t){return(t-e)/6048e5+1},O=(e,t)=>{let r;switch(t){case"Y":r=e.getUTCFullYear();break;case"M":r=e.getUTCMonth()+1;break;case"D":r=e.getUTCDate();break;case"d":r=(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())-Date.UTC(e.getUTCFullYear(),0))/S+1;break;case"F":r=e.getUTCDay(),0===r&&(r=7);break;case"W":{const t=A(e.getUTCFullYear(),0),n=P(t),s=Date.UTC(t.year,e.getUTCMonth(),e.getUTCDate());let o=C(n,s);if(o>52)s>=P(t.nextYear())&&(o=1);else if(o<1){const e=P(t.previousYear());o=C(e,s)}r=Math.floor(o);break}case"w":{const t=A(e.getUTCFullYear(),e.getUTCMonth()),n=P(t),s=Date.UTC(t.year,t.month,e.getUTCDate());let o=C(n,s);if(o>4)s>=P(t.nextMonth())&&(o=1);else if(o<1){const e=P(t.previousMonth());o=C(e,s)}r=Math.floor(o);break}case"X":{const t=A(e.getUTCFullYear(),0),n=P(t),s=P(t.nextYear()),o=e.getTime();r=o<n?t.year-1:o>=s?t.year+1:t.year;break}case"x":{const t=A(e.getUTCFullYear(),e.getUTCMonth()),n=P(t),s=t.nextMonth(),o=P(s),a=e.getTime();r=a<n?t.previousMonth().month+1:a>=o?s.month+1:t.month+1;break}case"H":r=e.getUTCHours();break;case"h":r=e.getUTCHours(),r%=12,0===r&&(r=12);break;case"P":r=e.getUTCHours()>=12?"pm":"am";break;case"m":r=e.getUTCMinutes();break;case"s":r=e.getUTCSeconds();break;case"f":r=e.getUTCMilliseconds();break;case"Z":case"z":break;case"C":case"E":r="ISO"}return r};let N=null;function T(e,t,r){var n=0,s=0;if(void 0!==r){const e=parseInt(r);n=Math.floor(e/100),s=e%100}let o;void 0===t?(null===N&&(N=k("[Y0001]-[M01]-[D01]T[H01]:[m01]:[s01].[f001][Z01:01t]")),o=N):o=k(t);const a=new Date(e+60*(60*n+s)*1e3);let i="";return o.parts.forEach((function(e){"literal"===e.type?i+=e.value:i+=function(e,t){var r=O(e,t.component);if(-1!=="YMDdFWwXxHhms".indexOf(t.component))if("Y"===t.component&&-1!==t.n&&(r%=Math.pow(10,t.n)),t.names){if("M"===t.component||"x"===t.component)r=x[r-1];else{if("F"!==t.component)throw{code:"D3133",value:t.component};r=E[r]}t.names===v?r=r.toUpperCase():t.names===g&&(r=r.toLowerCase()),t.width&&r.length>t.width.max&&(r=r.substring(0,t.width.max))}else r=b(r,t.integerFormat);else if("f"===t.component)r=b(r,t.integerFormat);else if("Z"===t.component||"z"===t.component){const e=100*n+s;if(t.integerFormat.regular)r=b(e,t.integerFormat);else{const o=t.integerFormat.mandatoryDigits;if(1===o||2===o)r=b(n,t.integerFormat),0!==s&&(r+=":"+u(s,"00"));else{if(3!==o&&4!==o)throw{code:"D3134",value:o};r=b(e,t.integerFormat)}}e>=0&&(r="+"+r),"z"===t.component&&(r="GMT"+r),0===e&&"t"===t.presentation2&&(r="Z")}return r}(a,e)})),i}function j(e){var t={};if("datetime"===e.type)t.type="datetime",t.parts=e.parts.map((function(e){var t={};if("literal"===e.type)t.regex=e.value.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");else if("Z"===e.component||"z"===e.component){let r;Array.isArray(e.integerFormat.groupingSeparators)||(r=e.integerFormat.groupingSeparators),t.regex="","z"===e.component&&(t.regex="GMT"),t.regex+="[-+][0-9]+",r&&(t.regex+=r.character+"[0-9]+"),t.parse=function(t){"z"===e.component&&(t=t.substring(3));let n=0,s=0;return r?(n=Number.parseInt(t.substring(0,t.indexOf(r.character))),s=Number.parseInt(t.substring(t.indexOf(r.character)+1))):t.length-1<=2?n=Number.parseInt(t):(n=Number.parseInt(t.substring(0,3)),s=Number.parseInt(t.substring(3))),60*n+s}}else if(e.integerFormat)t=j(e.integerFormat);else{t.regex="[a-zA-Z]+";var r={};if("M"===e.component||"x"===e.component)x.forEach((function(t,n){e.width&&e.width.max?r[t.substring(0,e.width.max)]=n+1:r[t]=n+1}));else if("F"===e.component)E.forEach((function(t,n){n>0&&(e.width&&e.width.max?r[t.substring(0,e.width.max)]=n:r[t]=n)}));else{if("P"!==e.component)throw{code:"D3133",value:e.component};r={am:0,AM:0,pm:1,PM:1}}t.parse=function(e){return r[e]}}return t.component=e.component,t}));else{t.type="integer";const r=e.case===v;switch(e.primary){case h:t.regex=r?"[A-Z]+":"[a-z]+",t.parse=function(e){return function(e,t){for(var r=t.charCodeAt(0),n=0,s=0;s<e.length;s++)n+=(e.charCodeAt(e.length-s-1)-r+1)*Math.pow(26,s);return n}(e,r?"A":"a")};break;case p:t.regex=r?"[MDCLXVI]+":"[mdclxvi]+",t.parse=function(e){return function(e){for(var t=0,r=1,n=e.length-1;n>=0;n--){const s=e[n],o=c[s];o<r?t-=o:(r=o,t+=o)}return t}(r?e:e.toUpperCase())};break;case f:t.regex="(?:"+Object.keys(a).concat("and","[\\-, ]").join("|")+")+",t.parse=function(e){return function(e){const t=e.split(/,\s|\sand\s|[\s\\-]/).map((e=>a[e]));let r=[0];return t.forEach((e=>{if(e<100){let t=r.pop();t>=1e3&&(r.push(t),t=0),r.push(t+e)}else r.push(r.pop()*e)})),r.reduce(((e,t)=>e+t),0)}(e.toLowerCase())};break;case d:t.regex="[0-9]+",e.ordinal&&(t.regex+="(?:th|st|nd|rd)"),t.parse=function(t){let r=t;return e.ordinal&&(r=t.substring(0,t.length-2)),e.regular?r=r.split(",").join(""):e.groupingSeparators.forEach((e=>{r=r.split(e.character).join("")})),48!==e.zeroCode&&(r=r.split("").map((t=>String.fromCodePoint(t.codePointAt(0)-e.zeroCode+48))).join("")),parseInt(r)};break;case m:throw{code:"D3130",value:e.token}}}return t}function D(e,t){const r=j(k(t)),n="^"+r.parts.map((e=>"("+e.regex+")")).join("")+"$";var s=new RegExp(n,"i").exec(e);if(null!==s){const e=161,t=130,n=84,a=72,i=23,c=47,l={};for(let e=1;e<s.length;e++){const t=r.parts[e-1];t.parse&&(l[t.component]=t.parse(s[e]))}if(0===Object.getOwnPropertyNames(l).length)return;let u=0;const d=e=>{u<<=1,u+=e?1:0},h=e=>!(~e&u||!(e&u));"YXMxWwdD".split("").forEach((e=>d(l[e])));const p=!h(e)&&h(t),f=h(n),m=!f&&h(a);u=0,"PHhmsf".split("").forEach((e=>d(l[e])));const v=!h(i)&&h(c),g=(p?"YD":f?"XxwF":m?"XWF":"YMD")+(v?"Phmsf":"Hmsf"),y=this.environment.timestamp;let b=!1,$=!1;if(g.split("").forEach((e=>{if(void 0===l[e])b?(l[e]=-1!=="MDd".indexOf(e)?1:0,$=!0):l[e]=O(y,e);else if(b=!0,$)throw{code:"D3136"}})),l.M>0?l.M-=1:l.M=0,p){const e=Date.UTC(l.Y,0),t=1e3*(l.d-1)*60*60*24,r=new Date(e+t);l.M=r.getUTCMonth(),l.D=r.getUTCDate()}if(f)throw{code:"D3136"};if(m)throw{code:"D3136"};v&&(l.H=12===l.h?0:l.h,1===l.P&&(l.H+=12));var o=Date.UTC(l.Y,l.M,l.D,l.H,l.m,l.s,l.f);return(l.Z||l.z)&&(o-=60*(l.Z||l.z)*1e3),o}}var I=new RegExp("^\\d{4}(-[01]\\d)*(-[0-3]\\d)*(T[0-2]\\d:[0-5]\\d:[0-5]\\d)*(\\.\\d+)?([+-][0-2]\\d:?[0-5]\\d|Z)?$");return{formatInteger:u,parseInteger:function(e,t){if(void 0!==e)return j(w(t)).parse(e)},fromMillis:function(e,t,r){if(void 0!==e)return T.call(this,e,t,r)},toMillis:function(e,t){if(void 0!==e){if(void 0===t){if(!I.test(e))throw{stack:(new Error).stack,code:"D3110",value:e};return Date.parse(e)}return D.call(this,e,t)}}}}();t.exports=s},{"./utils":6}],2:[function(e,t,n){(function(r){(function(){var n=e("./utils");const s=(()=>{"use strict";var e=n.isNumeric,t=n.isArrayOfStrings,s=n.isArrayOfNumbers,o=n.createSequence,a=n.isSequence,i=n.isFunction,c=n.isLambda,l=n.isIterable,u=n.getFunctionArity,d=n.isDeepEqual,h=n.stringToArray;function p(e,t,r){if(void 0!==e){var n=h(e),s=n.length;if(s+t<0&&(t=0),void 0!==r){if(r<=0)return"";var o=t>=0?t+r:s+t+r;return n.slice(t,o).join("")}return n.slice(t).join("")}}function f(e){if(void 0!==e)return h(e).length}function*m(e,t){var r=e.apply(this,[t]);if(l(r)&&(r=yield*r),r&&"number"!=typeof r.start&&"number"!==r.end&&!Array.isArray(r.groups)&&!i(r.next))throw{code:"T1010",stack:(new Error).stack};return r}function v(e,t){var r;if(void 0!==e){if(t){var n=e.toString().split("e");e=+(n[0]+"e"+(n[1]?+n[1]+t:t))}var s=(r=Math.round(e))-e;return.5===Math.abs(s)&&1===Math.abs(r%2)&&(r-=1),t&&(n=r.toString().split("e"),r=+(n[0]+"e"+(n[1]?+n[1]-t:-t))),Object.is(r,-0)&&(r=0),r}}function g(t){if(void 0!==t){var r=!1;return Array.isArray(t)?1===t.length?r=g(t[0]):t.length>1&&(r=t.filter((function(e){return g(e)})).length>0):"string"==typeof t?t.length>0&&(r=!0):e(t)?0!==t&&(r=!0):null!==t&&"object"==typeof t?Object.keys(t).length>0&&(r=!0):"boolean"==typeof t&&!0===t&&(r=!0),r}}function y(e,t,r,n){var s=[t],o=u(e);return o>=2&&s.push(r),o>=3&&s.push(n),s}function b(e,t){return void 0===e?t:void 0===t?e:(Array.isArray(e)||(e=o(e)),Array.isArray(t)||(t=[t]),e.concat(t))}return{sum:function(e){if(void 0!==e){var t=0;return e.forEach((function(e){t+=e})),t}},count:function(e){return void 0===e?0:e.length},max:function(e){if(void 0!==e&&0!==e.length)return Math.max.apply(Math,e)},min:function(e){if(void 0!==e&&0!==e.length)return Math.min.apply(Math,e)},average:function(e){if(void 0!==e&&0!==e.length){var t=0;return e.forEach((function(e){t+=e})),t/e.length}},string:function(t,r=!1){if(void 0!==t){var n;if("string"==typeof t)n=t;else if(i(t))n="";else{if("number"==typeof t&&!isFinite(t))throw{code:"D3001",value:t,stack:(new Error).stack};var s=r?2:0;Array.isArray(t)&&t.outerWrapper&&(t=t[0]),n=JSON.stringify(t,(function(t,r){return null!=r&&r.toPrecision&&e(r)?Number(r.toPrecision(15)):r&&i(r)?"":r}),s)}return n}},substring:p,substringBefore:function(e,t){if(void 0!==e){var r=e.indexOf(t);return r>-1?e.substr(0,r):e}},substringAfter:function(e,t){if(void 0!==e){var r=e.indexOf(t);return r>-1?e.substr(r+t.length):e}},lowercase:function(e){if(void 0!==e)return e.toLowerCase()},uppercase:function(e){if(void 0!==e)return e.toUpperCase()},length:f,trim:function(e){if(void 0!==e){var t=e.replace(/[ \t\n\r]+/gm," ");return" "===t.charAt(0)&&(t=t.substring(1))," "===t.charAt(t.length-1)&&(t=t.substring(0,t.length-1)),t}},pad:function(e,t,r){if(void 0!==e){var n;void 0!==r&&0!==r.length||(r=" ");var s=Math.abs(t)-f(e);if(s>0){var o=new Array(s+1).join(r);r.length>1&&(o=p(o,0,s)),n=t>0?e+o:o+e}else n=e;return n}},match:function*(e,t,r){if(void 0!==e){if(r<0)throw{stack:(new Error).stack,value:r,code:"D3040",index:3};var n=o();if(void 0===r||r>0){var s=0,a=yield*m(t,e);if(void 0!==a)for(;void 0!==a&&(void 0===r||s<r);)n.push({match:a.match,index:a.start,groups:a.groups}),a=yield*m(a.next),s++}return n}},contains:function*(e,t){if(void 0!==e)return"string"==typeof t?-1!==e.indexOf(t):void 0!==(yield*m(t,e))},replace:function*(e,t,r,n){if(void 0!==e){var s;if(""===t)throw{code:"D3010",stack:(new Error).stack,value:t,index:2};if(n<0)throw{code:"D3011",stack:(new Error).stack,value:n,index:4};s="string"==typeof r?function(e){for(var t="",n=0,s=r.indexOf("$",n);-1!==s&&n<r.length;){t+=r.substring(n,s),n=s+1;var o=r.charAt(n);if("$"===o)t+="$",n++;else if("0"===o)t+=e.match,n++;else{var a;if(a=0===e.groups.length?1:Math.floor(Math.log(e.groups.length)*Math.LOG10E)+1,s=parseInt(r.substring(n,n+a),10),a>1&&s>e.groups.length&&(s=parseInt(r.substring(n,n+a-1),10)),isNaN(s))t+="$";else{if(e.groups.length>0){var i=e.groups[s-1];void 0!==i&&(t+=i)}n+=s.toString().length}}s=r.indexOf("$",n)}return t+r.substring(n)}:r;var o="",a=0;if(void 0===n||n>0){var i=0;if("string"==typeof t){for(var c=e.indexOf(t,a);-1!==c&&(void 0===n||i<n);)o+=e.substring(a,c),o+=r,a=c+t.length,i++,c=e.indexOf(t,a);o+=e.substring(a)}else{var u=yield*m(t,e);if(void 0!==u){for(;void 0!==u&&(void 0===n||i<n);){o+=e.substring(a,u.start);var d=s.apply(this,[u]);if(l(d)&&(d=yield*d),"string"!=typeof d)throw{code:"D3012",stack:(new Error).stack,value:d};o+=d,a=u.start+u.match.length,i++,u=yield*m(u.next)}o+=e.substring(a)}else o=e}}else o=e;return o}},split:function*(e,t,r){if(void 0!==e){if(r<0)throw{code:"D3020",stack:(new Error).stack,value:r,index:3};var n=[];if(void 0===r||r>0)if("string"==typeof t)n=e.split(t,r);else{var s=0,o=yield*m(t,e);if(void 0!==o){for(var a=0;void 0!==o&&(void 0===r||s<r);)n.push(e.substring(a,o.start)),a=o.end,o=yield*m(o.next),s++;(void 0===r||s<r)&&n.push(e.substring(a))}else n.push(e)}return n}},join:function(e,t){if(void 0!==e)return void 0===t&&(t=""),e.join(t)},formatNumber:function(e,t,r){if(void 0!==e){var n={"decimal-separator":".","grouping-separator":",","exponent-separator":"e",infinity:"Infinity","minus-sign":"-",NaN:"NaN",percent:"%","per-mille":"","zero-digit":"0",digit:"#","pattern-separator":";"};void 0!==r&&Object.keys(r).forEach((function(e){n[e]=r[e]}));for(var s=[],o=n["zero-digit"].charCodeAt(0),a=o;a<o+10;a++)s.push(String.fromCharCode(a));var i=s.concat([n["decimal-separator"],n["exponent-separator"],n["grouping-separator"],n.digit,n["pattern-separator"]]),c=t.split(n["pattern-separator"]);if(c.length>2)throw{code:"D3080",stack:(new Error).stack};var l=c.map((function(e){var t,r,s,o,a=function(){for(var t,r=0;r<e.length;r++)if(t=e.charAt(r),-1!==i.indexOf(t)&&t!==n["exponent-separator"])return e.substring(0,r)}(),c=function(){for(var t,r=e.length-1;r>=0;r--)if(t=e.charAt(r),-1!==i.indexOf(t)&&t!==n["exponent-separator"])return e.substring(r+1)}(),l=e.substring(a.length,e.length-c.length),u=e.indexOf(n["exponent-separator"],a.length);-1===u||u>e.length-c.length?(t=l,r=void 0):(t=l.substring(0,u),r=l.substring(u+1));var d=t.indexOf(n["decimal-separator"]);return-1===d?(s=t,o=c):(s=t.substring(0,d),o=t.substring(d+1)),{prefix:a,suffix:c,activePart:l,mantissaPart:t,exponentPart:r,integerPart:s,fractionalPart:o,subpicture:e}}));l.forEach((function(e){var t,r,o=e.subpicture,a=o.indexOf(n["decimal-separator"]);a!==o.lastIndexOf(n["decimal-separator"])&&(t="D3081"),o.indexOf(n.percent)!==o.lastIndexOf(n.percent)&&(t="D3082"),o.indexOf(n["per-mille"])!==o.lastIndexOf(n["per-mille"])&&(t="D3083"),-1!==o.indexOf(n.percent)&&-1!==o.indexOf(n["per-mille"])&&(t="D3084");var c=!1;for(r=0;r<e.mantissaPart.length;r++){var l=e.mantissaPart.charAt(r);if(-1!==s.indexOf(l)||l===n.digit){c=!0;break}}c||(t="D3085"),-1!==e.activePart.split("").map((function(e){return-1===i.indexOf(e)?"p":"a"})).join("").indexOf("p")&&(t="D3086"),-1!==a?o.charAt(a-1)!==n["grouping-separator"]&&o.charAt(a+1)!==n["grouping-separator"]||(t="D3087"):e.integerPart.charAt(e.integerPart.length-1)===n["grouping-separator"]&&(t="D3088"),-1!==o.indexOf(n["grouping-separator"]+n["grouping-separator"])&&(t="D3089");var u=e.integerPart.indexOf(n.digit);-1!==u&&e.integerPart.substring(0,u).split("").filter((function(e){return s.indexOf(e)>-1})).length>0&&(t="D3090"),-1!==(u=e.fractionalPart.lastIndexOf(n.digit))&&e.fractionalPart.substring(u).split("").filter((function(e){return s.indexOf(e)>-1})).length>0&&(t="D3091");var d="string"==typeof e.exponentPart;if(d&&e.exponentPart.length>0&&(-1!==o.indexOf(n.percent)||-1!==o.indexOf(n["per-mille"]))&&(t="D3092"),d&&(0===e.exponentPart.length||e.exponentPart.split("").filter((function(e){return-1===s.indexOf(e)})).length>0)&&(t="D3093"),t)throw{code:t,stack:(new Error).stack}}));var u,d,h,p,f=l.map((function(e){var t=function(t,r){for(var o=[],a=t.indexOf(n["grouping-separator"]);-1!==a;){var i=(r?t.substring(0,a):t.substring(a)).split("").filter((function(e){return-1!==s.indexOf(e)||e===n.digit})).length;o.push(i),a=e.integerPart.indexOf(n["grouping-separator"],a+1)}return o},r=t(e.integerPart),o=function(e){if(0===e.length)return 0;for(var t=function(e,r){return 0===r?e:t(r,e%r)},r=e.reduce(t),n=1;n<=e.length;n++)if(-1===e.indexOf(n*r))return 0;return r}(r),a=t(e.fractionalPart,!0),i=e.integerPart.split("").filter((function(e){return-1!==s.indexOf(e)})).length,c=i,l=e.fractionalPart.split(""),u=l.filter((function(e){return-1!==s.indexOf(e)})).length,d=l.filter((function(e){return-1!==s.indexOf(e)||e===n.digit})).length,h="string"==typeof e.exponentPart;0===i&&0===d&&(h?(u=1,d=1):i=1),h&&0===i&&-1!==e.integerPart.indexOf(n.digit)&&(i=1),0===i&&0===u&&(u=1);var p=0;return h&&(p=e.exponentPart.split("").filter((function(e){return-1!==s.indexOf(e)})).length),{integerPartGroupingPositions:r,regularGrouping:o,minimumIntegerPartSize:i,scalingFactor:c,prefix:e.prefix,fractionalPartGroupingPositions:a,minimumFactionalPartSize:u,maximumFactionalPartSize:d,minimumExponentSize:p,suffix:e.suffix,picture:e.subpicture}})),m=n["minus-sign"],g=n["zero-digit"],y=n["decimal-separator"],b=n["grouping-separator"];if(1===f.length&&(f.push(JSON.parse(JSON.stringify(f[0]))),f[1].prefix=m+f[1].prefix),d=-1!==(u=e>=0?f[0]:f[1]).picture.indexOf(n.percent)?100*e:-1!==u.picture.indexOf(n["per-mille"])?1e3*e:e,0===u.minimumExponentSize)h=d;else{var $=Math.pow(10,u.scalingFactor),w=Math.pow(10,u.scalingFactor-1);for(h=d,p=0;h<w;)h*=10,p-=1;for(;h>$;)h/=10,p+=1}var _=function(e,t){var r=Math.abs(e).toFixed(t);return"0"!==g&&(r=r.split("").map((function(e){return e>="0"&&e<="9"?s[e.charCodeAt(0)-48]:e})).join("")),r},k=_(v(h,u.maximumFactionalPartSize),u.maximumFactionalPartSize),E=k.indexOf(".");for(-1===E?k+=y:k=k.replace(".",y);k.charAt(0)===g;)k=k.substring(1);for(;k.charAt(k.length-1)===g;)k=k.substring(0,k.length-1);E=k.indexOf(y);var x=u.minimumIntegerPartSize-E,S=u.minimumFactionalPartSize-(k.length-E-1);if(k=(x>0?new Array(x+1).join(g):"")+k,k+=S>0?new Array(S+1).join(g):"",E=k.indexOf(y),u.regularGrouping>0)for(var P=Math.floor((E-1)/u.regularGrouping),A=1;A<=P;A++)k=[k.slice(0,E-A*u.regularGrouping),b,k.slice(E-A*u.regularGrouping)].join("");else u.integerPartGroupingPositions.forEach((function(e){k=[k.slice(0,E-e),b,k.slice(E-e)].join(""),E++}));if(E=k.indexOf(y),u.fractionalPartGroupingPositions.forEach((function(e){k=[k.slice(0,e+E+1),b,k.slice(e+E+1)].join("")})),E=k.indexOf(y),-1!==u.picture.indexOf(y)&&E!==k.length-1||(k=k.substring(0,k.length-1)),void 0!==p){var C=_(p,0);(x=u.minimumExponentSize-C.length)>0&&(C=new Array(x+1).join(g)+C),k=k+n["exponent-separator"]+(p<0?m:"")+C}return k=u.prefix+k+u.suffix}},formatBase:function(e,t){if(void 0!==e){if(e=v(e),(t=void 0===t?10:v(t))<2||t>36)throw{code:"D3100",stack:(new Error).stack,value:t};return e.toString(t)}},number:function(e){var t;if(void 0!==e){if("number"==typeof e)t=e;else if("string"==typeof e&&/^-?[0-9]+(\.[0-9]+)?([Ee][-+]?[0-9]+)?$/.test(e)&&!isNaN(parseFloat(e))&&isFinite(e))t=parseFloat(e);else if(!0===e)t=1;else{if(!1!==e)throw{code:"D3030",value:e,stack:(new Error).stack,index:1};t=0}return t}},floor:function(e){if(void 0!==e)return Math.floor(e)},ceil:function(e){if(void 0!==e)return Math.ceil(e)},round:v,abs:function(e){if(void 0!==e)return Math.abs(e)},sqrt:function(e){if(void 0!==e){if(e<0)throw{stack:(new Error).stack,code:"D3060",index:1,value:e};return Math.sqrt(e)}},power:function(e,t){var r;if(void 0!==e){if(r=Math.pow(e,t),!isFinite(r))throw{stack:(new Error).stack,code:"D3061",index:1,value:e,exp:t};return r}},random:function(){return Math.random()},boolean:g,not:function(e){if(void 0!==e)return!g(e)},map:function*(e,t){if(void 0!==e){for(var r=o(),n=0;n<e.length;n++){var s=y(t,e[n],n,e),a=yield*t.apply(this,s);void 0!==a&&r.push(a)}return r}},zip:function(){for(var e=[],t=Array.prototype.slice.call(arguments),r=Math.min.apply(Math,t.map((function(e){return Array.isArray(e)?e.length:0}))),n=0;n<r;n++){var s=t.map((e=>e[n]));e.push(s)}return e},filter:function*(e,t){if(void 0!==e){for(var r=o(),n=0;n<e.length;n++){var s=e[n],a=y(t,s,n,e);g(yield*t.apply(this,a))&&r.push(s)}return r}},single:function*(e,t){if(void 0!==e){for(var r,n=!1,s=0;s<e.length;s++){var o=e[s],a=!0;if(void 0!==t){var i=y(t,o,s,e);a=g(yield*t.apply(this,i))}if(a){if(n)throw{stack:(new Error).stack,code:"D3138",index:s};r=o,n=!0}}if(!n)throw{stack:(new Error).stack,code:"D3139"};return r}},foldLeft:function*(e,t,r){if(void 0!==e){var n,s,o=u(t);if(o<2)throw{stack:(new Error).stack,code:"D3050",index:1};for(void 0===r&&e.length>0?(n=e[0],s=1):(n=r,s=0);s<e.length;){var a=[n,e[s]];o>=3&&a.push(s),o>=4&&a.push(e),n=yield*t.apply(this,a),s++}return n}},sift:function*(e,t){var r={};for(var n in e){var s=e[n],o=y(t,s,n,e);g(yield*t.apply(this,o))&&(r[n]=s)}return 0===Object.keys(r).length&&(r=void 0),r},keys:function e(t){var r=o();if(Array.isArray(t)){var n={};t.forEach((function(t){e(t).forEach((function(e){n[e]=!0}))})),r=e(n)}else null===t||"object"!=typeof t||c(t)||Object.keys(t).forEach((e=>r.push(e)));return r},lookup:function e(t,r){var n;if(Array.isArray(t)){n=o();for(var s=0;s<t.length;s++){var a=e(t[s],r);void 0!==a&&(Array.isArray(a)?a.forEach((e=>n.push(e))):n.push(a))}}else null!==t&&"object"==typeof t&&(n=t[r]);return n},append:b,exists:function(e){return void 0!==e},spread:function e(t){var r=o();if(Array.isArray(t))t.forEach((function(t){r=b(r,e(t))}));else if(null===t||"object"!=typeof t||c(t))r=t;else for(var n in t){var s={};s[n]=t[n],r.push(s)}return r},merge:function(e){if(void 0!==e){var t={};return e.forEach((function(e){for(var r in e)t[r]=e[r]})),t}},reverse:function(e){if(void 0!==e){if(e.length<=1)return e;for(var t=e.length,r=new Array(t),n=0;n<t;n++)r[t-n-1]=e[n];return r}},each:function*(e,t){var r=o();for(var n in e){var s=y(t,e[n],n,e),a=yield*t.apply(this,s);void 0!==a&&r.push(a)}return r},error:function(e){throw{code:"D3137",stack:(new Error).stack,message:e||"$error() function evaluated"}},assert:function(e,t){if(!e)throw{code:"D3141",stack:(new Error).stack,message:t||"$assert() statement failed"}},type:function(t){if(void 0!==t)return null===t?"null":e(t)?"number":"string"==typeof t?"string":"boolean"==typeof t?"boolean":Array.isArray(t)?"array":i(t)?"function":"object"},sort:function*(e,r){if(void 0!==e){if(e.length<=1)return e;var n;if(void 0===r){if(!s(e)&&!t(e))throw{stack:(new Error).stack,code:"D3070",index:1};n=function*(e,t){return e>t}}else n=r;var o=function*(e){if(!Array.isArray(e)||e.length<=1)return e;var t=Math.floor(e.length/2),r=e.slice(0,t),s=e.slice(t);return r=yield*o(r),s=yield*o(s),yield*function*(e,t){var r=function*(e,t,s){0===t.length?Array.prototype.push.apply(e,s):0===s.length?Array.prototype.push.apply(e,t):(yield*n(t[0],s[0]))?(e.push(s[0]),yield*r(e,t,s.slice(1))):(e.push(t[0]),yield*r(e,t.slice(1),s))},s=[];return yield*r(s,e,t),s}(r,s)};return yield*o(e)}},shuffle:function(e){if(void 0!==e){if(e.length<=1)return e;for(var t=new Array(e.length),r=0;r<e.length;r++){var n=Math.floor(Math.random()*(r+1));r!==n&&(t[r]=t[n]),t[n]=e[r]}return t}},distinct:function(e){if(void 0!==e){if(!Array.isArray(e)||e.length<=1)return e;for(var t=a(e)?o():[],r=0;r<e.length;r++){for(var n=e[r],s=!1,i=0;i<t.length;i++)if(d(n,t[i])){s=!0;break}s||t.push(n)}return t}},base64encode:function(e){if(void 0!==e){var t="undefined"!=typeof window?window.btoa:function(e){return new r.Buffer.from(e,"binary").toString("base64")};return t(e)}},base64decode:function(e){if(void 0!==e){var t="undefined"!=typeof window?window.atob:function(e){return new r.Buffer(e,"base64").toString("binary")};return t(e)}},encodeUrlComponent:function(e){if(void 0!==e){var t;try{t=encodeURIComponent(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"encodeUrlComponent"}}return t}},encodeUrl:function(e){if(void 0!==e){var t;try{t=encodeURI(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"encodeUrl"}}return t}},decodeUrlComponent:function(e){if(void 0!==e){var t;try{t=decodeURIComponent(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"decodeUrlComponent"}}return t}},decodeUrl:function(e){if(void 0!==e){var t;try{t=decodeURI(e)}catch(t){throw{code:"D3140",stack:(new Error).stack,value:e,functionName:"decodeUrl"}}return t}}}})();t.exports=s}).call(this)}).call(this,void 0!==r.g?r.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./utils":6}],3:[function(e,t,r){var n=e("./datetime"),s=e("./functions"),o=e("./utils"),a=e("./parser"),i=e("./signature"),c=function(){"use strict";var e=o.isNumeric,t=o.isArrayOfStrings,r=o.isArrayOfNumbers,c=o.createSequence,l=o.isSequence,u=o.isFunction,d=o.isLambda,h=o.isIterable,p=o.getFunctionArity,f=o.isDeepEqual,m=M(null);function*v(r,n,o){var a,i=o.lookup("__evaluate_entry");switch(i&&i(r,n,o),r.type){case"path":a=yield*function*(e,t,r){var n,s;n=Array.isArray(t)&&"variable"!==e.steps[0].type?t:c(t);for(var o=!1,a=void 0,i=0;i<e.steps.length;i++){var l=e.steps[i];if(l.tuple&&(o=!0),0===i&&l.consarray?s=yield*v(l,n,r):o?a=yield*$(l,n,a,r):s=yield*y(l,n,r,i===e.steps.length-1),!o&&(void 0===s||0===s.length))break;void 0===l.focus&&(n=s)}if(o)if(e.tuple)s=a;else for(s=c(),i=0;i<a.length;i++)s.push(a[i]["@"]);return e.keepSingletonArray&&(Array.isArray(s)&&s.cons&&!s.sequence&&(s=c(s)),s.keepSingleton=!0),e.hasOwnProperty("group")&&(s=yield*x(e.group,o?a:s,r)),s}(r,n,o);break;case"binary":a=yield*function*(t,r,n){var o,a=yield*v(t.lhs,r,n),i=t.value,c=function*(){return yield*v(t.rhs,r,n)};if("and"===i||"or"===i)try{return yield*function*(e,t,r){var n,s=E(e);switch(r){case"and":n=s&&E(yield*t());break;case"or":n=s||E(yield*t())}return n}(a,c,i)}catch(e){throw e.position=t.position,e.token=i,e}var l=yield*c();try{switch(i){case"+":case"-":case"*":case"/":case"%":o=function(t,r,n){var s;if(void 0!==t&&!e(t))throw{code:"T2001",stack:(new Error).stack,value:t};if(void 0!==r&&!e(r))throw{code:"T2002",stack:(new Error).stack,value:r};if(void 0===t||void 0===r)return s;switch(n){case"+":s=t+r;break;case"-":s=t-r;break;case"*":s=t*r;break;case"/":s=t/r;break;case"%":s=t%r}return s}(a,l,i);break;case"=":case"!=":o=function(e,t,r){var n;if(void 0===e||void 0===t)return!1;switch(r){case"=":n=f(e,t);break;case"!=":n=!f(e,t)}return n}(a,l,i);break;case"<":case"<=":case">":case">=":o=function(e,t,r){var n,s=typeof e,o=typeof t;if("undefined"!==s&&"string"!==s&&"number"!==s||"undefined"!==o&&"string"!==o&&"number"!==o)throw{code:"T2010",stack:(new Error).stack,value:"string"!==s&&"number"!==s?e:t};if("undefined"!==s&&"undefined"!==o){if(s!==o)throw{code:"T2009",stack:(new Error).stack,value:e,value2:t};switch(r){case"<":n=e<t;break;case"<=":n=e<=t;break;case">":n=e>t;break;case">=":n=e>=t}return n}}(a,l,i);break;case"&":o=function(e,t){var r="",n="";return void 0!==e&&(r=s.string(e)),void 0!==t&&(n=s.string(t)),r.concat(n)}(a,l);break;case"..":o=function(e,t){var r;if(void 0!==e&&!Number.isInteger(e))throw{code:"T2003",stack:(new Error).stack,value:e};if(void 0!==t&&!Number.isInteger(t))throw{code:"T2004",stack:(new Error).stack,value:t};if(void 0===e||void 0===t)return r;if(e>t)return r;var n=t-e+1;if(n>1e7)throw{code:"D2014",stack:(new Error).stack,value:n};r=new Array(n);for(var s=e,o=0;s<=t;s++,o++)r[o]=s;return r.sequence=!0,r}(a,l);break;case"in":o=function(e,t){var r=!1;if(void 0===e||void 0===t)return!1;Array.isArray(t)||(t=[t]);for(var n=0;n<t.length;n++)if(t[n]===e){r=!0;break}return r}(a,l)}}catch(e){throw e.position=t.position,e.token=i,e}return o}(r,n,o);break;case"unary":a=yield*function*(t,r,n){var o;switch(t.value){case"-":if(void 0===(o=yield*v(t.expression,r,n)))o=void 0;else{if(!e(o))throw{code:"D1002",stack:(new Error).stack,position:t.position,token:t.value,value:o};o=-o}break;case"[":o=[];for(var a=0;a<t.expressions.length;a++){var i=t.expressions[a],c=yield*v(i,r,n);void 0!==c&&("["===i.value?o.push(c):o=s.append(o,c))}t.consarray&&Object.defineProperty(o,"cons",{enumerable:!1,configurable:!1,value:!0});break;case"{":o=yield*x(t,r,n)}return o}(r,n,o);break;case"name":a=function(e,t,r){return s.lookup(t,e.value)}(r,n);break;case"string":case"number":case"value":a=function(e){return e.value}(r);break;case"wildcard":a=function(e,t){var r=c();return Array.isArray(t)&&t.outerWrapper&&t.length>0&&(t=t[0]),null!==t&&"object"==typeof t&&Object.keys(t).forEach((function(e){var n=t[e];Array.isArray(n)?(n=_(n),r=s.append(r,n)):r.push(n)})),r}(0,n);break;case"descendant":a=function(e,t){var r,n=c();return void 0!==t&&(k(t,n),r=1===n.length?n[0]:n),r}(0,n);break;case"parent":a=o.lookup(r.slot.label);break;case"condition":a=yield*function*(e,t,r){var n,o=yield*v(e.condition,t,r);return s.boolean(o)?n=yield*v(e.then,t,r):void 0!==e.else&&(n=yield*v(e.else,t,r)),n}(r,n,o);break;case"block":a=yield*function*(e,t,r){for(var n,s=M(r),o=0;o<e.expressions.length;o++)n=yield*v(e.expressions[o],t,s);return n}(r,n,o);break;case"bind":a=yield*function*(e,t,r){var n=yield*v(e.rhs,t,r);return r.bind(e.lhs.value,n),n}(r,n,o);break;case"regex":a=function(e){var t=new U.RegexEngine(e.value),r=function(n,s){var o;t.lastIndex=s||0;var a=t.exec(n);if(null!==a){if(o={match:a[0],start:a.index,end:a.index+a[0].length,groups:[]},a.length>1)for(var i=1;i<a.length;i++)o.groups.push(a[i]);o.next=function(){if(!(t.lastIndex>=n.length)){var s=r(n,t.lastIndex);if(s&&""===s.match)throw{code:"D1004",stack:(new Error).stack,position:e.position,value:e.value.source};return s}}}return o};return r}(r);break;case"function":a=yield*C(r,n,o);break;case"variable":a=function(e,t,r){return""===e.value?t&&t.outerWrapper?t[0]:t:r.lookup(e.value)}(r,n,o);break;case"lambda":a=function(e,t,r){var n={_jsonata_lambda:!0,input:t,environment:r,arguments:e.arguments,signature:e.signature,body:e.body};return!0===e.thunk&&(n.thunk=!0),n.apply=function*(e,r){return yield*O(n,r,t,e.environment)},n}(r,n,o);break;case"partial":a=yield*function*(e,t,r){for(var n,s=[],o=0;o<e.arguments.length;o++){var a=e.arguments[o];"operator"===a.type&&"?"===a.value?s.push(a):s.push(yield*v(a,t,r))}var i=yield*v(e.procedure,t,r);if(void 0===i&&"path"===e.procedure.type&&r.lookup(e.procedure.steps[0].value))throw{code:"T1007",stack:(new Error).stack,position:e.position,token:e.procedure.steps[0].value};if(d(i))n=T(i,s);else if(i&&!0===i._jsonata_function)n=j(i.implementation,s);else{if("function"!=typeof i)throw{code:"T1008",stack:(new Error).stack,position:e.position,token:"path"===e.procedure.type?e.procedure.steps[0].value:e.procedure.value};n=j(i,s)}return n}(r,n,o);break;case"apply":a=yield*function*(e,t,r){var n,s=yield*v(e.lhs,t,r);if("function"===e.rhs.type)n=yield*C(e.rhs,t,r,{context:s});else{var o=yield*v(e.rhs,t,r);if(!u(o))throw{code:"T2006",stack:(new Error).stack,position:e.position,value:o};if(u(s)){var a=yield*v(A,null,r);n=yield*O(a,[s,o],null,r)}else n=yield*O(o,[s],null,r)}return n}(r,n,o);break;case"transform":a=function(e,r,n){return I((function*(r){if(void 0!==r){var s=n.lookup("clone");if(!u(s))throw{code:"T2013",stack:(new Error).stack,position:e.position};var o=yield*O(s,[r],null,n),a=yield*v(e.pattern,o,n);if(void 0!==a){Array.isArray(a)||(a=[a]);for(var i=0;i<a.length;i++){var c=a[i],l=yield*v(e.update,c,n),d=typeof l;if("undefined"!==d){if("object"!==d||null===l||Array.isArray(l))throw{code:"T2011",stack:(new Error).stack,position:e.update.position,value:l};for(var h in l)c[h]=l[h]}if(void 0!==e.delete){var p=yield*v(e.delete,c,n);if(void 0!==p){var f=p;if(Array.isArray(p)||(p=[p]),!t(p))throw{code:"T2012",stack:(new Error).stack,position:e.delete.position,value:f};for(var m=0;m<p.length;m++)"object"==typeof c&&null!==c&&delete c[p[m]]}}}}return o}}),"<(oa):o>")}(r,0,o)}if(!o.async||null!=a&&"function"==typeof a.then||(a=Promise.resolve(a)),o.async&&"function"==typeof a.then&&r.nextFunction&&"function"==typeof a[r.nextFunction]||(a=yield a),Object.prototype.hasOwnProperty.call(r,"predicate"))for(var h=0;h<r.predicate.length;h++)a=yield*w(r.predicate[h].expr,a,o);"path"!==r.type&&Object.prototype.hasOwnProperty.call(r,"group")&&(a=yield*x(r.group,a,o));var p=o.lookup("__evaluate_exit");return p&&p(r,n,o,a),a&&l(a)&&!a.tupleStream&&(r.keepArray&&(a.keepSingleton=!0),0===a.length?a=void 0:1===a.length&&(a=a.keepSingleton?a:a[0])),a}function g(e,t){var r=M(e);for(const e in t)r.bind(e,t[e]);return r}function*y(e,t,r,n){var s;if("sort"===e.type)return s=yield*P(e,t,r),e.stages&&(s=yield*b(e.stages,s,r)),s;s=c();for(var o=0;o<t.length;o++){var a=yield*v(e,t[o],r);if(e.stages)for(var i=0;i<e.stages.length;i++)a=yield*w(e.stages[i].expr,a,r);void 0!==a&&s.push(a)}var u=c();return n&&1===s.length&&Array.isArray(s[0])&&!l(s[0])?u=s[0]:s.forEach((function(e){!Array.isArray(e)||e.cons?u.push(e):e.forEach((e=>u.push(e)))})),u}function*b(e,t,r){for(var n=t,s=0;s<e.length;s++){var o=e[s];switch(o.type){case"filter":n=yield*w(o.expr,n,r);break;case"index":for(var a=0;a<n.length;a++)n[a][o.value]=a}}return n}function*$(e,t,r,n){var s;if("sort"===e.type){if(r)s=yield*P(e,r,n);else{var o=yield*P(e,t,n);(s=c()).tupleStream=!0;for(var a=0;a<o.length;a++){var i={"@":o[a]};i[e.index]=a,s.push(i)}}return e.stages&&(s=yield*b(e.stages,s,n)),s}(s=c()).tupleStream=!0;var l=n;void 0===r&&(r=t.map((e=>({"@":e}))));for(var u=0;u<r.length;u++){l=g(n,r[u]);var d=yield*v(e,r[u]["@"],l);if(void 0!==d){Array.isArray(d)||(d=[d]);for(var h=0;h<d.length;h++)i={},Object.assign(i,r[u]),d.tupleStream?Object.assign(i,d[h]):(e.focus?(i[e.focus]=d[h],i["@"]=r[u]["@"]):i["@"]=d[h],e.index&&(i[e.index]=h),e.ancestor&&(i[e.ancestor.label]=r[u]["@"])),s.push(i)}}return e.stages&&(s=yield*b(e.stages,s,n)),s}function*w(t,n,o){var a=c();if(n&&n.tupleStream&&(a.tupleStream=!0),Array.isArray(n)||(n=c(n)),"number"===t.type){var i=Math.floor(t.value);i<0&&(i=n.length+i),void 0!==(l=n[i])&&(Array.isArray(l)?a=l:a.push(l))}else for(i=0;i<n.length;i++){var l,u=l=n[i],d=o;n.tupleStream&&(u=l["@"],d=g(o,l));var h=yield*v(t,u,d);e(h)&&(h=[h]),r(h)?h.forEach((function(e){var t=Math.floor(e);t<0&&(t=n.length+t),t===i&&a.push(l)})):s.boolean(h)&&a.push(l)}return a}function _(e,t){return void 0===t&&(t=[]),Array.isArray(e)?e.forEach((function(e){_(e,t)})):t.push(e),t}function k(e,t){Array.isArray(e)||t.push(e),Array.isArray(e)?e.forEach((function(e){k(e,t)})):null!==e&&"object"==typeof e&&Object.keys(e).forEach((function(r){k(e[r],t)}))}function E(e){var t=s.boolean(e);return void 0!==t&&t}function*x(e,t,r){var n={},o={},a=!(!t||!t.tupleStream);Array.isArray(t)||(t=c(t)),0===t.length&&t.push(void 0);for(var i=0;i<t.length;i++)for(var l=t[i],u=a?g(r,l):r,d=0;d<e.lhs.length;d++){var h=e.lhs[d],p=yield*v(h[0],a?l["@"]:l,u);if("string"!=typeof p)throw{code:"T1003",stack:(new Error).stack,position:e.position,value:p};var f={data:l,exprIndex:d};if(o.hasOwnProperty(p)){if(o[p].exprIndex!==d)throw{code:"D1009",stack:(new Error).stack,position:e.position,value:p};o[p].data=s.append(o[p].data,l)}else o[p]=f}for(p in o){var m=(f=o[p]).data;if(u=r,a){var y=S(f.data);m=y["@"],delete y["@"],u=g(r,y)}var b=yield*v(e.lhs[f.exprIndex][1],m,u);void 0!==b&&(n[p]=b)}return n}function S(e){if(!Array.isArray(e))return e;var t={};Object.assign(t,e[0]);for(var r=1;r<e.length;r++)for(const n in e[r])t[n]=s.append(t[n],e[r][n]);return t}function*P(e,t,r){var n=t,o=!!t.tupleStream,a={environment:r,input:t};return yield*s.sort.apply(a,[n,function*(t,n){for(var s=0,a=0;0===s&&a<e.terms.length;a++){var i=e.terms[a],c=t,l=r;o&&(c=t["@"],l=g(r,t));var u=yield*v(i.expression,c,l);c=n,l=r,o&&(c=n["@"],l=g(r,n));var d=yield*v(i.expression,c,l),h=typeof u,p=typeof d;if("undefined"!==h)if("undefined"!==p){if("string"!==h&&"number"!==h||"string"!==p&&"number"!==p)throw{code:"T2008",stack:(new Error).stack,position:e.position,value:"string"!==h&&"number"!==h?u:d};if(h!==p)throw{code:"T2007",stack:(new Error).stack,position:e.position,value:u,value2:d};u!==d&&(s=u<d?-1:1,!0===i.descending&&(s=-s))}else s=-1;else s="undefined"===p?0:1}return 1===s}])}var A=a("function($f, $g) { function($x){ $g($f($x)) } }");function*C(e,t,r,n){var s,o=yield*v(e.procedure,t,r);if(void 0===o&&"path"===e.procedure.type&&r.lookup(e.procedure.steps[0].value))throw{code:"T1005",stack:(new Error).stack,position:e.position,token:e.procedure.steps[0].value};var a=[];void 0!==n&&a.push(n.context);for(var i=0;i<e.arguments.length;i++){const n=yield*v(e.arguments[i],t,r);if(u(n)){const e=function*(...e){return yield*O(n,e,null,r)};e.arity=p(n),a.push(e)}else a.push(n)}var c="path"===e.procedure.type?e.procedure.steps[0].value:e.procedure.value;try{"object"==typeof o&&(o.token=c,o.position=e.position),s=yield*O(o,a,t,r)}catch(t){throw t.position||(t.position=e.position),t.token||(t.token=c),t}return s}function*O(e,t,r,n){var s;for(s=yield*N(e,t,r,n);d(s)&&!0===s.thunk;){var o=yield*v(s.body.procedure,s.input,s.environment);"variable"===s.body.procedure.type&&(o.token=s.body.procedure.value),o.position=s.body.procedure.position;for(var a=[],i=0;i<s.body.arguments.length;i++)a.push(yield*v(s.body.arguments[i],s.input,s.environment));s=yield*N(o,a,r,n)}return s}function*N(e,t,r,n){var s;try{var o=t;if(e&&(o=function(e,t,r){return void 0===e?t:e.validate(t,r)}(e.signature,t,r)),d(e))s=yield*function*(e,t){var r=M(e.environment);return e.arguments.forEach((function(e,n){r.bind(e.value,t[n])})),"function"==typeof e.body?yield*function*(e,t){var r=D(e).map((function(e){return t.lookup(e.trim())})),n={environment:t},s=e.apply(n,r);return h(s)&&(s=yield*s),s}(e.body,r):yield*v(e.body,e.input,r)}(e,o);else if(e&&!0===e._jsonata_function){var a={environment:n,input:r};s=e.implementation.apply(a,o),h(s)&&(s=yield*s)}else{if("function"!=typeof e)throw{code:"T1006",stack:(new Error).stack};s=e.apply(r,o),h(s)&&(s=yield*s)}}catch(t){throw e&&(void 0===t.token&&void 0!==e.token&&(t.token=e.token),t.position=e.position),t}return s}function T(e,t){var r=M(e.environment),n=[];return e.arguments.forEach((function(e,s){var o=t[s];o&&"operator"===o.type&&"?"===o.value?n.push(e):r.bind(e.value,o)})),{_jsonata_lambda:!0,input:e.input,environment:r,arguments:n,body:e.body}}function j(e,t){var r=D(e),n="function("+(r=r.map((function(e){return"$"+e.trim()}))).join(", ")+"){ _ }",s=a(n);return s.body=e,T(s,t)}function D(e){var t=e.toString();return/\(([^)]*)\)/.exec(t)[1].split(",")}function I(e,t){var r={_jsonata_function:!0,implementation:e};return void 0!==t&&(r.signature=i(t)),r}function M(e){var t={};return{bind:function(e,r){t[e]=r},lookup:function(r){var n;return t.hasOwnProperty(r)?n=t[r]:e&&(n=e.lookup(r)),n},timestamp:e?e.timestamp:null,async:!!e&&e.async,global:e?e.global:{ancestry:[null]}}}m.bind("sum",I(s.sum,"<a<n>:n>")),m.bind("count",I(s.count,"<a:n>")),m.bind("max",I(s.max,"<a<n>:n>")),m.bind("min",I(s.min,"<a<n>:n>")),m.bind("average",I(s.average,"<a<n>:n>")),m.bind("string",I(s.string,"<x-b?:s>")),m.bind("substring",I(s.substring,"<s-nn?:s>")),m.bind("substringBefore",I(s.substringBefore,"<s-s:s>")),m.bind("substringAfter",I(s.substringAfter,"<s-s:s>")),m.bind("lowercase",I(s.lowercase,"<s-:s>")),m.bind("uppercase",I(s.uppercase,"<s-:s>")),m.bind("length",I(s.length,"<s-:n>")),m.bind("trim",I(s.trim,"<s-:s>")),m.bind("pad",I(s.pad,"<s-ns?:s>")),m.bind("match",I(s.match,"<s-f<s:o>n?:a<o>>")),m.bind("contains",I(s.contains,"<s-(sf):b>")),m.bind("replace",I(s.replace,"<s-(sf)(sf)n?:s>")),m.bind("split",I(s.split,"<s-(sf)n?:a<s>>")),m.bind("join",I(s.join,"<a<s>s?:s>")),m.bind("formatNumber",I(s.formatNumber,"<n-so?:s>")),m.bind("formatBase",I(s.formatBase,"<n-n?:s>")),m.bind("formatInteger",I(n.formatInteger,"<n-s:s>")),m.bind("parseInteger",I(n.parseInteger,"<s-s:n>")),m.bind("number",I(s.number,"<(nsb)-:n>")),m.bind("floor",I(s.floor,"<n-:n>")),m.bind("ceil",I(s.ceil,"<n-:n>")),m.bind("round",I(s.round,"<n-n?:n>")),m.bind("abs",I(s.abs,"<n-:n>")),m.bind("sqrt",I(s.sqrt,"<n-:n>")),m.bind("power",I(s.power,"<n-n:n>")),m.bind("random",I(s.random,"<:n>")),m.bind("boolean",I(s.boolean,"<x-:b>")),m.bind("not",I(s.not,"<x-:b>")),m.bind("map",I(s.map,"<af>")),m.bind("zip",I(s.zip,"<a+>")),m.bind("filter",I(s.filter,"<af>")),m.bind("single",I(s.single,"<af?>")),m.bind("reduce",I(s.foldLeft,"<afj?:j>")),m.bind("sift",I(s.sift,"<o-f?:o>")),m.bind("keys",I(s.keys,"<x-:a<s>>")),m.bind("lookup",I(s.lookup,"<x-s:x>")),m.bind("append",I(s.append,"<xx:a>")),m.bind("exists",I(s.exists,"<x:b>")),m.bind("spread",I(s.spread,"<x-:a<o>>")),m.bind("merge",I(s.merge,"<a<o>:o>")),m.bind("reverse",I(s.reverse,"<a:a>")),m.bind("each",I(s.each,"<o-f:a>")),m.bind("error",I(s.error,"<s?:x>")),m.bind("assert",I(s.assert,"<bs?:x>")),m.bind("type",I(s.type,"<x:s>")),m.bind("sort",I(s.sort,"<af?:a>")),m.bind("shuffle",I(s.shuffle,"<a:a>")),m.bind("distinct",I(s.distinct,"<x:x>")),m.bind("base64encode",I(s.base64encode,"<s-:s>")),m.bind("base64decode",I(s.base64decode,"<s-:s>")),m.bind("encodeUrlComponent",I(s.encodeUrlComponent,"<s-:s>")),m.bind("encodeUrl",I(s.encodeUrl,"<s-:s>")),m.bind("decodeUrlComponent",I(s.decodeUrlComponent,"<s-:s>")),m.bind("decodeUrl",I(s.decodeUrl,"<s-:s>")),m.bind("eval",I((function*(e,t){if(void 0!==e){var r=this.input;void 0!==t&&(r=t,Array.isArray(r)&&!l(r)&&((r=c(r)).outerWrapper=!0));try{var n=a(e,!1)}catch(e){throw F(e),{stack:(new Error).stack,code:"D3120",value:e.message,error:e}}try{var s=yield*v(n,r,this.environment)}catch(e){throw F(e),{stack:(new Error).stack,code:"D3121",value:e.message,error:e}}return s}}),"<sx?:x>")),m.bind("toMillis",I(n.toMillis,"<s-s?:n>")),m.bind("fromMillis",I(n.fromMillis,"<n-s?s?:s>")),m.bind("clone",I((function(e){if(void 0!==e)return JSON.parse(s.string(e))}),"<(oa)-:o>"));var R={S0101:"String literal must be terminated by a matching quote",S0102:"Number out of range: {{token}}",S0103:"Unsupported escape sequence: \\{{token}}",S0104:"The escape sequence \\u must be followed by 4 hex digits",S0105:"Quoted property name must be terminated with a backquote (`)",S0106:"Comment has no closing tag",S0201:"Syntax error: {{token}}",S0202:"Expected {{value}}, got {{token}}",S0203:"Expected {{value}} before end of expression",S0204:"Unknown operator: {{token}}",S0205:"Unexpected token: {{token}}",S0206:"Unknown expression type: {{token}}",S0207:"Unexpected end of expression",S0208:"Parameter {{value}} of function definition must be a variable name (start with $)",S0209:"A predicate cannot follow a grouping expression in a step",S0210:"Each step can only have one grouping expression",S0211:"The symbol {{token}} cannot be used as a unary operator",S0212:"The left side of := must be a variable name (start with $)",S0213:"The literal value {{value}} cannot be used as a step within a path expression",S0214:"The right side of {{token}} must be a variable name (start with $)",S0215:"A context variable binding must precede any predicates on a step",S0216:"A context variable binding must precede the 'order-by' clause on a step",S0217:"The object representing the 'parent' cannot be derived from this expression",S0301:"Empty regular expressions are not allowed",S0302:"No terminating / in regular expression",S0402:"Choice groups containing parameterized types are not supported",S0401:"Type parameters can only be applied to functions and arrays",S0500:"Attempted to evaluate an expression containing syntax error(s)",T0410:"Argument {{index}} of function {{token}} does not match function signature",T0411:"Context value is not a compatible type with argument {{index}} of function {{token}}",T0412:"Argument {{index}} of function {{token}} must be an array of {{type}}",D1001:"Number out of range: {{value}}",D1002:"Cannot negate a non-numeric value: {{value}}",T1003:"Key in object structure must evaluate to a string; got: {{value}}",D1004:"Regular expression matches zero length string",T1005:"Attempted to invoke a non-function. Did you mean ${{{token}}}?",T1006:"Attempted to invoke a non-function",T1007:"Attempted to partially apply a non-function. Did you mean ${{{token}}}?",T1008:"Attempted to partially apply a non-function",D1009:"Multiple key definitions evaluate to same key: {{value}}",T1010:"The matcher function argument passed to function {{token}} does not return the correct object structure",T2001:"The left side of the {{token}} operator must evaluate to a number",T2002:"The right side of the {{token}} operator must evaluate to a number",T2003:"The left side of the range operator (..) must evaluate to an integer",T2004:"The right side of the range operator (..) must evaluate to an integer",D2005:"The left side of := must be a variable name (start with $)",T2006:"The right side of the function application operator ~> must be a function",T2007:"Type mismatch when comparing values {{value}} and {{value2}} in order-by clause",T2008:"The expressions within an order-by clause must evaluate to numeric or string values",T2009:"The values {{value}} and {{value2}} either side of operator {{token}} must be of the same data type",T2010:"The expressions either side of operator {{token}} must evaluate to numeric or string values",T2011:"The insert/update clause of the transform expression must evaluate to an object: {{value}}",T2012:"The delete clause of the transform expression must evaluate to a string or array of strings: {{value}}",T2013:"The transform expression clones the input object using the $clone() function.  This has been overridden in the current scope by a non-function.",D2014:"The size of the sequence allocated by the range operator (..) must not exceed 1e6.  Attempted to allocate {{value}}.",D3001:"Attempting to invoke string function on Infinity or NaN",D3010:"Second argument of replace function cannot be an empty string",D3011:"Fourth argument of replace function must evaluate to a positive number",D3012:"Attempted to replace a matched string with a non-string value",D3020:"Third argument of split function must evaluate to a positive number",D3030:"Unable to cast value to a number: {{value}}",D3040:"Third argument of match function must evaluate to a positive number",D3050:"The second argument of reduce function must be a function with at least two arguments",D3060:"The sqrt function cannot be applied to a negative number: {{value}}",D3061:"The power function has resulted in a value that cannot be represented as a JSON number: base={{value}}, exponent={{exp}}",D3070:"The single argument form of the sort function can only be applied to an array of strings or an array of numbers.  Use the second argument to specify a comparison function",D3080:"The picture string must only contain a maximum of two sub-pictures",D3081:"The sub-picture must not contain more than one instance of the 'decimal-separator' character",D3082:"The sub-picture must not contain more than one instance of the 'percent' character",D3083:"The sub-picture must not contain more than one instance of the 'per-mille' character",D3084:"The sub-picture must not contain both a 'percent' and a 'per-mille' character",D3085:"The mantissa part of a sub-picture must contain at least one character that is either an 'optional digit character' or a member of the 'decimal digit family'",D3086:"The sub-picture must not contain a passive character that is preceded by an active character and that is followed by another active character",D3087:"The sub-picture must not contain a 'grouping-separator' character that appears adjacent to a 'decimal-separator' character",D3088:"The sub-picture must not contain a 'grouping-separator' at the end of the integer part",D3089:"The sub-picture must not contain two adjacent instances of the 'grouping-separator' character",D3090:"The integer part of the sub-picture must not contain a member of the 'decimal digit family' that is followed by an instance of the 'optional digit character'",D3091:"The fractional part of the sub-picture must not contain an instance of the 'optional digit character' that is followed by a member of the 'decimal digit family'",D3092:"A sub-picture that contains a 'percent' or 'per-mille' character must not contain a character treated as an 'exponent-separator'",D3093:"The exponent part of the sub-picture must comprise only of one or more characters that are members of the 'decimal digit family'",D3100:"The radix of the formatBase function must be between 2 and 36.  It was given {{value}}",D3110:"The argument of the toMillis function must be an ISO 8601 formatted timestamp. Given {{value}}",D3120:"Syntax error in expression passed to function eval: {{value}}",D3121:"Dynamic error evaluating the expression passed to function eval: {{value}}",D3130:"Formatting or parsing an integer as a sequence starting with {{value}} is not supported by this implementation",D3131:"In a decimal digit pattern, all digits must be from the same decimal group",D3132:"Unknown component specifier {{value}} in date/time picture string",D3133:"The 'name' modifier can only be applied to months and days in the date/time picture string, not {{value}}",D3134:"The timezone integer format specifier cannot have more than four digits",D3135:"No matching closing bracket ']' in date/time picture string",D3136:"The date/time picture string is missing specifiers required to parse the timestamp",D3137:"{{{message}}}",D3138:"The $single() function expected exactly 1 matching result.  Instead it matched more.",D3139:"The $single() function expected exactly 1 matching result.  Instead it matched 0.",D3140:"Malformed URL passed to ${{{functionName}}}(): {{value}}",D3141:"{{{message}}}"};function F(e){var t=R[e.code];if(void 0!==t){var r=t.replace(/\{\{\{([^}]+)}}}/g,(function(){return e[arguments[1]]}));r=r.replace(/\{\{([^}]+)}}/g,(function(){return JSON.stringify(e[arguments[1]])})),e.message=r}}function U(e,t){var r,s;try{r=a(e,t&&t.recover),s=r.errors,delete r.errors}catch(e){throw F(e),e}var o=M(m),i=new Date;return o.bind("now",I((function(e,t){return n.fromMillis(i.getTime(),e,t)}),"<s?s?:s>")),o.bind("millis",I((function(){return i.getTime()}),"<:n>")),t&&t.RegexEngine?U.RegexEngine=t.RegexEngine:U.RegexEngine=RegExp,{evaluate:function(e,t,n){if(void 0!==s){var a={code:"S0500",position:0};throw F(a),a}var u,d,h;if(void 0!==t)for(var p in u=M(o),t)u.bind(p,t[p]);else u=o;if(u.bind("$",e),i=new Date,u.timestamp=i,Array.isArray(e)&&!l(e)&&((e=c(e)).outerWrapper=!0),"function"==typeof n){u.async=!0;var f=function(e){F(e),n(e,null)},m=function(e){(d=h.next(e)).done?n(null,d.value):d.value.then(m).catch(f)};h=v(r,e,u),(d=h.next()).value.then(m).catch(f)}else try{for(h=v(r,e,u),d=h.next();!d.done;)d=h.next(d.value);return d.value}catch(a){throw F(a),a}},assign:function(e,t){o.bind(e,t)},registerFunction:function(e,t,r){var n=I(t,r);o.bind(e,n)},ast:function(){return r},errors:function(){return s}}}return U.parser=a,U}();t.exports=c},{"./datetime":1,"./functions":2,"./parser":4,"./signature":5,"./utils":6}],4:[function(e,t,r){var n=e("./signature");const s=(()=>{"use strict";var e={".":75,"[":80,"]":0,"{":70,"}":0,"(":80,")":0,",":0,"@":80,"#":80,";":80,":":80,"?":20,"+":50,"-":50,"*":60,"/":60,"%":60,"|":20,"=":40,"<":40,">":40,"^":40,"**":60,"..":20,":=":10,"!=":40,"<=":40,">=":40,"~>":40,and:30,or:25,in:40,"&":50,"!":0,"~":0},t={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},r=function(r){var n=0,s=r.length,o=function(e,t){return{type:e,value:t,position:n}},a=function(i){if(n>=s)return null;for(var c=r.charAt(n);n<s&&" \t\n\r\v".indexOf(c)>-1;)n++,c=r.charAt(n);if("/"===c&&"*"===r.charAt(n+1)){var l=n;for(n+=2,c=r.charAt(n);"*"!==c||"/"!==r.charAt(n+1);)if(c=r.charAt(++n),n>=s)throw{code:"S0106",stack:(new Error).stack,position:l};return n+=2,c=r.charAt(n),a(i)}if(!0!==i&&"/"===c)return n++,o("regex",function(){for(var e,t,o=n,a=0;n<s;){var i=r.charAt(n);if("/"===i&&"\\"!==r.charAt(n-1)&&0===a){if(""===(e=r.substring(o,n)))throw{code:"S0301",stack:(new Error).stack,position:n};for(n++,i=r.charAt(n),o=n;"i"===i||"m"===i;)n++,i=r.charAt(n);return t=r.substring(o,n)+"g",new RegExp(e,t)}"("!==i&&"["!==i&&"{"!==i||"\\"===r.charAt(n-1)||a++,")"!==i&&"]"!==i&&"}"!==i||"\\"===r.charAt(n-1)||a--,n++}throw{code:"S0302",stack:(new Error).stack,position:n}}());if("."===c&&"."===r.charAt(n+1))return n+=2,o("operator","..");if(":"===c&&"="===r.charAt(n+1))return n+=2,o("operator",":=");if("!"===c&&"="===r.charAt(n+1))return n+=2,o("operator","!=");if(">"===c&&"="===r.charAt(n+1))return n+=2,o("operator",">=");if("<"===c&&"="===r.charAt(n+1))return n+=2,o("operator","<=");if("*"===c&&"*"===r.charAt(n+1))return n+=2,o("operator","**");if("~"===c&&">"===r.charAt(n+1))return n+=2,o("operator","~>");if(Object.prototype.hasOwnProperty.call(e,c))return n++,o("operator",c);if('"'===c||"'"===c){var u=c;n++;for(var d="";n<s;){if("\\"===(c=r.charAt(n)))if(n++,c=r.charAt(n),Object.prototype.hasOwnProperty.call(t,c))d+=t[c];else{if("u"!==c)throw{code:"S0103",stack:(new Error).stack,position:n,token:c};var h=r.substr(n+1,4);if(!/^[0-9a-fA-F]+$/.test(h))throw{code:"S0104",stack:(new Error).stack,position:n};var p=parseInt(h,16);d+=String.fromCharCode(p),n+=4}else{if(c===u)return n++,o("string",d);d+=c}n++}throw{code:"S0101",stack:(new Error).stack,position:n}}var f,m=/^-?(0|([1-9][0-9]*))(\.[0-9]+)?([Ee][-+]?[0-9]+)?/.exec(r.substring(n));if(null!==m){var v=parseFloat(m[0]);if(!isNaN(v)&&isFinite(v))return n+=m[0].length,o("number",v);throw{code:"S0102",stack:(new Error).stack,position:n,token:m[0]}}if("`"===c){n++;var g=r.indexOf("`",n);if(-1!==g)return f=r.substring(n,g),n=g+1,o("name",f);throw n=s,{code:"S0105",stack:(new Error).stack,position:n}}for(var y,b=n;;)if(y=r.charAt(b),b===s||" \t\n\r\v".indexOf(y)>-1||Object.prototype.hasOwnProperty.call(e,y)){if("$"===r.charAt(n))return f=r.substring(n+1,b),n=b,o("variable",f);switch(f=r.substring(n,b),n=b,f){case"or":case"in":case"and":return o("operator",f);case"true":return o("value",!0);case"false":return o("value",!1);case"null":return o("value",null);default:return n===s&&""===f?null:o("name",f)}}else b++};return a};return function(t,s){var o,a,i={},c=[],l=function(){var e=[];"(end)"!==o.id&&e.push({type:o.type,value:o.value,position:o.position});for(var t=a();null!==t;)e.push(t),t=a();return e},u={nud:function(){var e={code:"S0211",token:this.value,position:this.position};if(s)return e.remaining=l(),e.type="error",c.push(e),e;throw e.stack=(new Error).stack,e}},d=function(e,t){var r=i[e];return t=t||0,r?t>=r.lbp&&(r.lbp=t):((r=Object.create(u)).id=r.value=e,r.lbp=t,i[e]=r),r},h=function(e){if(s){e.remaining=l(),c.push(e);var t=i["(error)"];return(o=Object.create(t)).error=e,o.type="(error)",o}throw e.stack=(new Error).stack,e},p=function(e,r){if(e&&o.id!==e){var n={code:"(end)"===o.id?"S0203":"S0202",position:o.position,token:o.value,value:e};return h(n)}var s=a(r);if(null===s)return(o=i["(end)"]).position=t.length,o;var c,l=s.value,u=s.type;switch(u){case"name":case"variable":c=i["(name)"];break;case"operator":if(!(c=i[l]))return h({code:"S0204",stack:(new Error).stack,position:s.position,token:l});break;case"string":case"number":case"value":c=i["(literal)"];break;case"regex":u="regex",c=i["(regex)"];break;default:return h({code:"S0205",stack:(new Error).stack,position:s.position,token:l})}return(o=Object.create(c)).value=l,o.type=u,o.position=s.position,o},f=function(e){var t,r=o;for(p(null,!0),t=r.nud();e<o.lbp;)r=o,p(),t=r.led(t);return t},m=function(e){d(e,0).nud=function(){return this}},v=function(t,r,n){var s=r||e[t],o=d(t,s);return o.led=n||function(e){return this.lhs=e,this.rhs=f(s),this.type="binary",this},o},g=function(e,t,r){var n=d(e,t);return n.led=r,n},y=function(e,t){var r=d(e);return r.nud=t||function(){return this.expression=f(70),this.type="unary",this},r};m("(end)"),m("(name)"),m("(literal)"),m("(regex)"),d(":"),d(";"),d(","),d(")"),d("]"),d("}"),d(".."),v("."),v("+"),v("-"),v("*"),v("/"),v("%"),v("="),v("<"),v(">"),v("!="),v("<="),v(">="),v("&"),v("and"),v("or"),v("in"),m("and"),m("or"),m("in"),y("-"),v("~>"),g("(error)",10,(function(e){return this.lhs=e,this.error=o.error,this.remaining=l(),this.type="error",this})),y("*",(function(){return this.type="wildcard",this})),y("**",(function(){return this.type="descendant",this})),y("%",(function(){return this.type="parent",this})),v("(",e["("],(function(e){if(this.procedure=e,this.type="function",this.arguments=[],")"!==o.id)for(;"operator"===o.type&&"?"===o.id?(this.type="partial",this.arguments.push(o),p("?")):this.arguments.push(f(0)),","===o.id;)p(",");if(p(")",!0),"name"===e.type&&("function"===e.value||""===e.value)){if(this.arguments.forEach((function(e,t){if("variable"!==e.type)return h({code:"S0208",stack:(new Error).stack,position:e.position,token:e.value,value:t+1})})),this.type="lambda","<"===o.id){for(var t=o.position,r=1,s="<";r>0&&"{"!==o.id&&"(end)"!==o.id;){var a=p();">"===a.id?r--:"<"===a.id&&r++,s+=a.value}p(">");try{this.signature=n(s)}catch(e){return e.position=t+e.offset,h(e)}}p("{"),this.body=f(0),p("}")}return this})),y("(",(function(){for(var e=[];")"!==o.id&&(e.push(f(0)),";"===o.id);)p(";");return p(")",!0),this.type="block",this.expressions=e,this})),y("[",(function(){var e=[];if("]"!==o.id)for(;;){var t=f(0);if(".."===o.id){var r={type:"binary",value:"..",position:o.position,lhs:t};p(".."),r.rhs=f(0),t=r}if(e.push(t),","!==o.id)break;p(",")}return p("]",!0),this.expressions=e,this.type="unary",this})),v("[",e["["],(function(t){if("]"===o.id){for(var r=t;r&&"binary"===r.type&&"["===r.value;)r=r.lhs;return r.keepArray=!0,p("]"),t}return this.lhs=t,this.rhs=f(e["]"]),this.type="binary",p("]",!0),this})),v("^",e["^"],(function(e){p("(");for(var t=[];;){var r={descending:!1};if("<"===o.id?p("<"):">"===o.id&&(r.descending=!0,p(">")),r.expression=f(0),t.push(r),","!==o.id)break;p(",")}return p(")"),this.lhs=e,this.rhs=t,this.type="binary",this}));var b=function(e){var t=[];if("}"!==o.id)for(;;){var r=f(0);p(":");var n=f(0);if(t.push([r,n]),","!==o.id)break;p(",")}return p("}",!0),void 0===e?(this.lhs=t,this.type="unary"):(this.lhs=e,this.rhs=t,this.type="binary"),this};y("{",b),v("{",e["{"],b),g(":=",e[":="],(function(t){return"variable"!==t.type?h({code:"S0212",stack:(new Error).stack,position:t.position,token:t.value}):(this.lhs=t,this.rhs=f(e[":="]-1),this.type="binary",this)})),v("@",e["@"],(function(t){return this.lhs=t,this.rhs=f(e["@"]),"variable"!==this.rhs.type?h({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"@"}):(this.type="binary",this)})),v("#",e["#"],(function(t){return this.lhs=t,this.rhs=f(e["#"]),"variable"!==this.rhs.type?h({code:"S0214",stack:(new Error).stack,position:this.rhs.position,token:"#"}):(this.type="binary",this)})),v("?",e["?"],(function(e){return this.type="condition",this.condition=e,this.then=f(0),":"===o.id&&(p(":"),this.else=f(0)),this})),y("|",(function(){return this.type="transform",this.pattern=f(0),p("|"),this.update=f(0),","===o.id&&(p(","),this.delete=f(0)),p("|"),this}));var $=function(e){var t;if("function"!==e.type||e.predicate)if("condition"===e.type)e.then=$(e.then),void 0!==e.else&&(e.else=$(e.else)),t=e;else if("block"===e.type){var r=e.expressions.length;r>0&&(e.expressions[r-1]=$(e.expressions[r-1])),t=e}else t=e;else{var n={type:"lambda",thunk:!0,arguments:[],position:e.position};n.body=e,t=n}return t},w=0,_=0,k=[],E=function(e,t){switch(e.type){case"name":case"wildcard":t.level--,0===t.level&&(void 0===e.ancestor||(k[t.index].slot.label=e.ancestor.label),e.ancestor=t,e.tuple=!0);break;case"parent":t.level++;break;case"block":e.expressions.length>0&&(e.tuple=!0,t=E(e.expressions[e.expressions.length-1],t));break;case"path":e.tuple=!0;var r=e.steps.length-1;for(t=E(e.steps[r--],t);t.level>0&&r>=0;)t=E(e.steps[r--],t);break;default:throw{code:"S0217",token:e.type,position:e.position}}return t},x=function(e,t){if(void 0!==t.seekingParent||"parent"===t.type){var r=void 0!==t.seekingParent?t.seekingParent:[];"parent"===t.type&&r.push(t.slot),void 0===e.seekingParent?e.seekingParent=r:Array.prototype.push.apply(e.seekingParent,r)}},S=function(e){var t=e.steps.length-1,r=e.steps[t],n=void 0!==r.seekingParent?r.seekingParent:[];"parent"===r.type&&n.push(r.slot);for(var s=0;s<n.length;s++){var o=n[s];for(t=e.steps.length-2;o.level>0;){if(t<0){void 0===e.seekingParent?e.seekingParent=[o]:e.seekingParent.push(o);break}for(var a=e.steps[t--];t>=0&&a.focus&&e.steps[t].focus;)a=e.steps[t--];o=E(a,o)}}},P=function(e){var t;switch(e.type){case"binary":switch(e.value){case".":var r=P(e.lhs);t="path"===r.type?r:{type:"path",steps:[r]},"parent"===r.type&&(t.seekingParent=[r.slot]);var n=P(e.rhs);"function"===n.type&&"path"===n.procedure.type&&1===n.procedure.steps.length&&"name"===n.procedure.steps[0].type&&"function"===t.steps[t.steps.length-1].type&&(t.steps[t.steps.length-1].nextFunction=n.procedure.steps[0].value),"path"===n.type?Array.prototype.push.apply(t.steps,n.steps):(void 0!==n.predicate&&(n.stages=n.predicate,delete n.predicate),t.steps.push(n)),t.steps.filter((function(e){if("number"===e.type||"value"===e.type)throw{code:"S0213",stack:(new Error).stack,position:e.position,value:e.value};return"string"===e.type})).forEach((function(e){e.type="name"})),t.steps.filter((function(e){return!0===e.keepArray})).length>0&&(t.keepSingletonArray=!0);var o=t.steps[0];"unary"===o.type&&"["===o.value&&(o.consarray=!0);var a=t.steps[t.steps.length-1];"unary"===a.type&&"["===a.value&&(a.consarray=!0),S(t);break;case"[":var i=t=P(e.lhs),l="predicate";if("path"===t.type&&(i=t.steps[t.steps.length-1],l="stages"),void 0!==i.group)throw{code:"S0209",stack:(new Error).stack,position:e.position};void 0===i[l]&&(i[l]=[]);var u=P(e.rhs);void 0!==u.seekingParent&&(u.seekingParent.forEach((e=>{1===e.level?E(i,e):e.level--})),x(i,u)),i[l].push({type:"filter",expr:u,position:e.position});break;case"{":if(void 0!==(t=P(e.lhs)).group)throw{code:"S0210",stack:(new Error).stack,position:e.position};t.group={lhs:e.rhs.map((function(e){return[P(e[0]),P(e[1])]})),position:e.position};break;case"^":"path"!==(t=P(e.lhs)).type&&(t={type:"path",steps:[t]});var d={type:"sort",position:e.position};d.terms=e.rhs.map((function(e){var t=P(e.expression);return x(d,t),{descending:e.descending,expression:t}})),t.steps.push(d),S(t);break;case":=":(t={type:"bind",value:e.value,position:e.position}).lhs=P(e.lhs),t.rhs=P(e.rhs),x(t,t.rhs);break;case"@":if(t=P(e.lhs),i=t,"path"===t.type&&(i=t.steps[t.steps.length-1]),void 0!==i.stages||void 0!==i.predicate)throw{code:"S0215",stack:(new Error).stack,position:e.position};if("sort"===i.type)throw{code:"S0216",stack:(new Error).stack,position:e.position};e.keepArray&&(i.keepArray=!0),i.focus=e.rhs.value,i.tuple=!0;break;case"#":t=P(e.lhs),i=t,"path"===t.type?i=t.steps[t.steps.length-1]:(t={type:"path",steps:[t]},void 0!==i.predicate&&(i.stages=i.predicate,delete i.predicate)),void 0===i.stages?i.index=e.rhs.value:i.stages.push({type:"index",value:e.rhs.value,position:e.position}),i.tuple=!0;break;case"~>":(t={type:"apply",value:e.value,position:e.position}).lhs=P(e.lhs),t.rhs=P(e.rhs);break;default:(t={type:e.type,value:e.value,position:e.position}).lhs=P(e.lhs),t.rhs=P(e.rhs),x(t,t.lhs),x(t,t.rhs)}break;case"unary":t={type:e.type,value:e.value,position:e.position},"["===e.value?t.expressions=e.expressions.map((function(e){var r=P(e);return x(t,r),r})):"{"===e.value?t.lhs=e.lhs.map((function(e){var r=P(e[0]);x(t,r);var n=P(e[1]);return x(t,n),[r,n]})):(t.expression=P(e.expression),"-"===e.value&&"number"===t.expression.type?(t=t.expression).value=-t.value:x(t,t.expression));break;case"function":case"partial":(t={type:e.type,name:e.name,value:e.value,position:e.position}).arguments=e.arguments.map((function(e){var r=P(e);return x(t,r),r})),t.procedure=P(e.procedure);break;case"lambda":t={type:e.type,arguments:e.arguments,signature:e.signature,position:e.position};var h=P(e.body);t.body=$(h);break;case"condition":(t={type:e.type,position:e.position}).condition=P(e.condition),x(t,t.condition),t.then=P(e.then),x(t,t.then),void 0!==e.else&&(t.else=P(e.else),x(t,t.else));break;case"transform":(t={type:e.type,position:e.position}).pattern=P(e.pattern),t.update=P(e.update),void 0!==e.delete&&(t.delete=P(e.delete));break;case"block":(t={type:e.type,position:e.position}).expressions=e.expressions.map((function(e){var r=P(e);return x(t,r),(r.consarray||"path"===r.type&&r.steps[0].consarray)&&(t.consarray=!0),r}));break;case"name":t={type:"path",steps:[e]},e.keepArray&&(t.keepSingletonArray=!0);break;case"parent":t={type:"parent",slot:{label:"!"+w++,level:1,index:_++}},k.push(t);break;case"string":case"number":case"value":case"wildcard":case"descendant":case"variable":case"regex":t=e;break;case"operator":if("and"===e.value||"or"===e.value||"in"===e.value)e.type="name",t=P(e);else{if("?"!==e.value)throw{code:"S0201",stack:(new Error).stack,position:e.position,token:e.value};t=e}break;case"error":t=e,e.lhs&&(t=P(e.lhs));break;default:var p="S0206";"(end)"===e.id&&(p="S0207");var f={code:p,position:e.position,token:e.value};if(s)return c.push(f),{type:"error",error:f};throw f.stack=(new Error).stack,f}return e.keepArray&&(t.keepArray=!0),t};a=r(t),p();var A=f(0);if("(end)"!==o.id){var C={code:"S0201",position:o.position,token:o.value};h(C)}if("parent"===(A=P(A)).type||void 0!==A.seekingParent)throw{code:"S0217",token:A.type,position:A.position};return c.length>0&&(A.errors=c),A}})();t.exports=s},{"./signature":5}],5:[function(e,t,r){var n=e("./utils");const s=(()=>{"use strict";var e={a:"arrays",b:"booleans",f:"functions",n:"numbers",o:"objects",s:"strings"};return function(t){for(var r=1,s=[],o={},a=o;r<t.length;){var i=t.charAt(r);if(":"===i)break;var c=function(){s.push(o),a=o,o={}},l=function(e,t,r,n){for(var s=1,o=t;o<e.length;)if(o++,(i=e.charAt(o))===n){if(0==--s)break}else i===r&&s++;return o};switch(i){case"s":case"n":case"b":case"l":case"o":o.regex="["+i+"m]",o.type=i,c();break;case"a":o.regex="[asnblfom]",o.type=i,o.array=!0,c();break;case"f":o.regex="f",o.type=i,c();break;case"j":o.regex="[asnblom]",o.type=i,c();break;case"x":o.regex="[asnblfom]",o.type=i,c();break;case"-":a.context=!0,a.contextRegex=new RegExp(a.regex),a.regex+="?";break;case"?":case"+":a.regex+=i;break;case"(":var u=l(t,r,"(",")"),d=t.substring(r+1,u);if(-1!==d.indexOf("<"))throw{code:"S0402",stack:(new Error).stack,value:d,offset:r};o.regex="["+d+"m]",o.type="("+d+")",r=u,c();break;case"<":if("a"!==a.type&&"f"!==a.type)throw{code:"S0401",stack:(new Error).stack,value:a.type,offset:r};var h=l(t,r,"<",">");a.subtype=t.substring(r+1,h),r=h}r++}var p="^"+s.map((function(e){return"("+e.regex+")"})).join("")+"$",f=new RegExp(p),m=function(e){var t;if(n.isFunction(e))t="f";else switch(typeof e){case"string":t="s";break;case"number":t="n";break;case"boolean":t="b";break;case"object":t=null===e?"l":Array.isArray(e)?"a":"o";break;default:t="m"}return t};return{definition:t,validate:function(t,r){var n="";t.forEach((function(e){n+=m(e)}));var o=f.exec(n);if(o){var a=[],i=0;return s.forEach((function(n,s){var c=t[i],l=o[s+1];if(""===l)if(n.context&&n.contextRegex){var u=m(r);if(!n.contextRegex.test(u))throw{code:"T0411",stack:(new Error).stack,value:r,index:i+1};a.push(r)}else a.push(c),i++;else l.split("").forEach((function(r){if("a"===n.type){if("m"===r)c=void 0;else{c=t[i];var s=!0;if(void 0!==n.subtype)if("a"!==r&&l!==n.subtype)s=!1;else if("a"===r&&c.length>0){var o=m(c[0]);s=o===n.subtype.charAt(0)&&0===c.filter((function(e){return m(e)!==o})).length}if(!s)throw{code:"T0412",stack:(new Error).stack,value:c,index:i+1,type:e[n.subtype]};"a"!==r&&(c=[c])}a.push(c),i++}else a.push(c),i++}))})),a}!function(e,t){for(var r="^",n=0,o=0;o<s.length;o++){r+=s[o].regex;var a=t.match(r);if(null===a)throw{code:"T0410",stack:(new Error).stack,value:e[n],index:n+1};n=a[0].length}throw{code:"T0410",stack:(new Error).stack,value:e[n],index:n+1}}(t,n)}}}})();t.exports=s},{"./utils":6}],6:[function(e,t,r){const n=(()=>{"use strict";function e(e){var t=!1;if("number"==typeof e&&(t=!isNaN(e))&&!isFinite(e))throw{code:"D1001",value:e,stack:(new Error).stack};return t}var t=("function"==typeof Symbol?Symbol:{}).iterator||"@@iterator";return{isNumeric:e,isArrayOfStrings:function(e){var t=!1;return Array.isArray(e)&&(t=0===e.filter((function(e){return"string"!=typeof e})).length),t},isArrayOfNumbers:function(t){var r=!1;return Array.isArray(t)&&(r=0===t.filter((function(t){return!e(t)})).length),r},createSequence:function(){var e=[];return e.sequence=!0,1===arguments.length&&e.push(arguments[0]),e},isSequence:function(e){return!0===e.sequence&&Array.isArray(e)},isFunction:function(e){return e&&(!0===e._jsonata_function||!0===e._jsonata_lambda)||"function"==typeof e},isLambda:function(e){return e&&!0===e._jsonata_lambda},isIterable:function(e){return"object"==typeof e&&null!==e&&t in e&&"next"in e&&"function"==typeof e.next},getFunctionArity:function(e){return"number"==typeof e.arity?e.arity:"function"==typeof e.implementation?e.implementation.length:"number"==typeof e.length?e.length:e.arguments.length},isDeepEqual:function e(t,r){if(t===r)return!0;if("object"==typeof t&&"object"==typeof r&&null!==t&&null!==r){if(Array.isArray(t)&&Array.isArray(r)){if(t.length!==r.length)return!1;for(var n=0;n<t.length;n++)if(!e(t[n],r[n]))return!1;return!0}var s=Object.getOwnPropertyNames(t),o=Object.getOwnPropertyNames(r);if(s.length!==o.length)return!1;for(s=s.sort(),o=o.sort(),n=0;n<s.length;n++)if(s[n]!==o[n])return!1;for(n=0;n<s.length;n++){var a=s[n];if(!e(t[a],r[a]))return!1}return!0}return!1},stringToArray:function(e){var t=[];for(let r of e)t.push(r);return t}}})();t.exports=n},{}]},{},[3])(3)},540:function(e,t){!function(e){"use strict";function t(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(t.length>1){t[0]=t[0].slice(0,-1);for(var n=t.length-1,s=1;s<n;++s)t[s]=t[s].slice(1,-1);return t[n]=t[n].slice(1),t.join("")}return t[0]}function r(e){return"(?:"+e+")"}function n(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).split(" ").pop().split("]").shift().toLowerCase()}function s(e){return e.toUpperCase()}function o(e){var n="[A-Za-z]",s="[0-9]",o=t(s,"[A-Fa-f]"),a=r(r("%[EFef]"+o+"%"+o+o+"%"+o+o)+"|"+r("%[89A-Fa-f]"+o+"%"+o+o)+"|"+r("%"+o+o)),i="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",c=t("[\\:\\/\\?\\#\\[\\]\\@]",i),l=e?"[\\uE000-\\uF8FF]":"[]",u=t(n,s,"[\\-\\.\\_\\~]",e?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]"),d=r(n+t(n,s,"[\\+\\-\\.]")+"*"),h=r(r(a+"|"+t(u,i,"[\\:]"))+"*"),p=(r(r("25[0-5]")+"|"+r("2[0-4]"+s)+"|"+r("1"+s+s)+"|"+r("[1-9]"+s)+"|"+s),r(r("25[0-5]")+"|"+r("2[0-4]"+s)+"|"+r("1"+s+s)+"|"+r("0?[1-9]"+s)+"|0?0?"+s)),f=r(p+"\\."+p+"\\."+p+"\\."+p),m=r(o+"{1,4}"),v=r(r(m+"\\:"+m)+"|"+f),g=r(r(m+"\\:")+"{6}"+v),y=r("\\:\\:"+r(m+"\\:")+"{5}"+v),b=r(r(m)+"?\\:\\:"+r(m+"\\:")+"{4}"+v),$=r(r(r(m+"\\:")+"{0,1}"+m)+"?\\:\\:"+r(m+"\\:")+"{3}"+v),w=r(r(r(m+"\\:")+"{0,2}"+m)+"?\\:\\:"+r(m+"\\:")+"{2}"+v),_=r(r(r(m+"\\:")+"{0,3}"+m)+"?\\:\\:"+m+"\\:"+v),k=r(r(r(m+"\\:")+"{0,4}"+m)+"?\\:\\:"+v),E=r(r(r(m+"\\:")+"{0,5}"+m)+"?\\:\\:"+m),x=r(r(r(m+"\\:")+"{0,6}"+m)+"?\\:\\:"),S=r([g,y,b,$,w,_,k,E,x].join("|")),P=r(r(u+"|"+a)+"+"),A=(r(S+"\\%25"+P),r(S+r("\\%25|\\%(?!"+o+"{2})")+P)),C=r("[vV]"+o+"+\\."+t(u,i,"[\\:]")+"+"),O=r("\\["+r(A+"|"+S+"|"+C)+"\\]"),N=r(r(a+"|"+t(u,i))+"*"),T=r(O+"|"+f+"(?!"+N+")|"+N),j=r(s+"*"),D=r(r(h+"@")+"?"+T+r("\\:"+j)+"?"),I=r(a+"|"+t(u,i,"[\\:\\@]")),M=r(I+"*"),R=r(I+"+"),F=r(r(a+"|"+t(u,i,"[\\@]"))+"+"),U=r(r("\\/"+M)+"*"),z=r("\\/"+r(R+U)+"?"),V=r(F+U),q=r(R+U),L="(?!"+I+")",H=(r(U+"|"+z+"|"+V+"|"+q+"|"+L),r(r(I+"|"+t("[\\/\\?]",l))+"*")),K=r(r(I+"|[\\/\\?]")+"*"),G=r(r("\\/\\/"+D+U)+"|"+z+"|"+q+"|"+L),B=r(d+"\\:"+G+r("\\?"+H)+"?"+r("\\#"+K)+"?"),J=r(r("\\/\\/"+D+U)+"|"+z+"|"+V+"|"+L),W=r(J+r("\\?"+H)+"?"+r("\\#"+K)+"?");return r(B+"|"+W),r(d+"\\:"+G+r("\\?"+H)+"?"),r(r("\\/\\/("+r("("+h+")@")+"?("+T+")"+r("\\:("+j+")")+"?)")+"?("+U+"|"+z+"|"+q+"|"+L+")"),r("\\?("+H+")"),r("\\#("+K+")"),r(r("\\/\\/("+r("("+h+")@")+"?("+T+")"+r("\\:("+j+")")+"?)")+"?("+U+"|"+z+"|"+V+"|"+L+")"),r("\\?("+H+")"),r("\\#("+K+")"),r(r("\\/\\/("+r("("+h+")@")+"?("+T+")"+r("\\:("+j+")")+"?)")+"?("+U+"|"+z+"|"+q+"|"+L+")"),r("\\?("+H+")"),r("\\#("+K+")"),r("("+h+")@"),r("\\:("+j+")"),{NOT_SCHEME:new RegExp(t("[^]",n,s,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(t("[^\\%\\:]",u,i),"g"),NOT_HOST:new RegExp(t("[^\\%\\[\\]\\:]",u,i),"g"),NOT_PATH:new RegExp(t("[^\\%\\/\\:\\@]",u,i),"g"),NOT_PATH_NOSCHEME:new RegExp(t("[^\\%\\/\\@]",u,i),"g"),NOT_QUERY:new RegExp(t("[^\\%]",u,i,"[\\:\\@\\/\\?]",l),"g"),NOT_FRAGMENT:new RegExp(t("[^\\%]",u,i,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(t("[^]",u,i),"g"),UNRESERVED:new RegExp(u,"g"),OTHER_CHARS:new RegExp(t("[^\\%]",u,c),"g"),PCT_ENCODED:new RegExp(a,"g"),IPV4ADDRESS:new RegExp("^("+f+")$"),IPV6ADDRESS:new RegExp("^\\[?("+S+")"+r(r("\\%25|\\%(?!"+o+"{2})")+"("+P+")")+"?\\]?$")}}var a=o(!1),i=o(!0),c=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,s=!1,o=void 0;try{for(var a,i=e[Symbol.iterator]();!(n=(a=i.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){s=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(s)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=2147483647,u=36,d=/^xn--/,h=/[^\0-\x7E]/,p=/[\x2E\u3002\uFF0E\uFF61]/g,f={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},m=Math.floor,v=String.fromCharCode;function g(e){throw new RangeError(f[e])}function y(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+function(e,t){for(var r=[],n=e.length;n--;)r[n]=t(e[n]);return r}((e=e.replace(p,".")).split("."),t).join(".")}function b(e){for(var t=[],r=0,n=e.length;r<n;){var s=e.charCodeAt(r++);if(s>=55296&&s<=56319&&r<n){var o=e.charCodeAt(r++);56320==(64512&o)?t.push(((1023&s)<<10)+(1023&o)+65536):(t.push(s),r--)}else t.push(s)}return t}var $=function(e,t){return e+22+75*(e<26)-((0!=t)<<5)},w=function(e,t,r){var n=0;for(e=r?m(e/700):e>>1,e+=m(e/t);e>455;n+=u)e=m(e/35);return m(n+36*e/(e+38))},_=function(e){var t,r=[],n=e.length,s=0,o=128,a=72,i=e.lastIndexOf("-");i<0&&(i=0);for(var c=0;c<i;++c)e.charCodeAt(c)>=128&&g("not-basic"),r.push(e.charCodeAt(c));for(var d=i>0?i+1:0;d<n;){for(var h=s,p=1,f=u;;f+=u){d>=n&&g("invalid-input");var v=(t=e.charCodeAt(d++))-48<10?t-22:t-65<26?t-65:t-97<26?t-97:u;(v>=u||v>m((l-s)/p))&&g("overflow"),s+=v*p;var y=f<=a?1:f>=a+26?26:f-a;if(v<y)break;var b=u-y;p>m(l/b)&&g("overflow"),p*=b}var $=r.length+1;a=w(s-h,$,0==h),m(s/$)>l-o&&g("overflow"),o+=m(s/$),s%=$,r.splice(s++,0,o)}return String.fromCodePoint.apply(String,r)},k=function(e){var t=[],r=(e=b(e)).length,n=128,s=0,o=72,a=!0,i=!1,c=void 0;try{for(var d,h=e[Symbol.iterator]();!(a=(d=h.next()).done);a=!0){var p=d.value;p<128&&t.push(v(p))}}catch(e){i=!0,c=e}finally{try{!a&&h.return&&h.return()}finally{if(i)throw c}}var f=t.length,y=f;for(f&&t.push("-");y<r;){var _=l,k=!0,E=!1,x=void 0;try{for(var S,P=e[Symbol.iterator]();!(k=(S=P.next()).done);k=!0){var A=S.value;A>=n&&A<_&&(_=A)}}catch(e){E=!0,x=e}finally{try{!k&&P.return&&P.return()}finally{if(E)throw x}}var C=y+1;_-n>m((l-s)/C)&&g("overflow"),s+=(_-n)*C,n=_;var O=!0,N=!1,T=void 0;try{for(var j,D=e[Symbol.iterator]();!(O=(j=D.next()).done);O=!0){var I=j.value;if(I<n&&++s>l&&g("overflow"),I==n){for(var M=s,R=u;;R+=u){var F=R<=o?1:R>=o+26?26:R-o;if(M<F)break;var U=M-F,z=u-F;t.push(v($(F+U%z,0))),M=m(U/z)}t.push(v($(M,0))),o=w(s,C,y==f),s=0,++y}}}catch(e){N=!0,T=e}finally{try{!O&&D.return&&D.return()}finally{if(N)throw T}}++s,++n}return t.join("")},E=function(e){return y(e,(function(e){return h.test(e)?"xn--"+k(e):e}))},x=function(e){return y(e,(function(e){return d.test(e)?_(e.slice(4).toLowerCase()):e}))},S={};function P(e){var t=e.charCodeAt(0);return t<16?"%0"+t.toString(16).toUpperCase():t<128?"%"+t.toString(16).toUpperCase():t<2048?"%"+(t>>6|192).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase():"%"+(t>>12|224).toString(16).toUpperCase()+"%"+(t>>6&63|128).toString(16).toUpperCase()+"%"+(63&t|128).toString(16).toUpperCase()}function A(e){for(var t="",r=0,n=e.length;r<n;){var s=parseInt(e.substr(r+1,2),16);if(s<128)t+=String.fromCharCode(s),r+=3;else if(s>=194&&s<224){if(n-r>=6){var o=parseInt(e.substr(r+4,2),16);t+=String.fromCharCode((31&s)<<6|63&o)}else t+=e.substr(r,6);r+=6}else if(s>=224){if(n-r>=9){var a=parseInt(e.substr(r+4,2),16),i=parseInt(e.substr(r+7,2),16);t+=String.fromCharCode((15&s)<<12|(63&a)<<6|63&i)}else t+=e.substr(r,9);r+=9}else t+=e.substr(r,3),r+=3}return t}function C(e,t){function r(e){var r=A(e);return r.match(t.UNRESERVED)?r:e}return e.scheme&&(e.scheme=String(e.scheme).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_SCHEME,"")),void 0!==e.userinfo&&(e.userinfo=String(e.userinfo).replace(t.PCT_ENCODED,r).replace(t.NOT_USERINFO,P).replace(t.PCT_ENCODED,s)),void 0!==e.host&&(e.host=String(e.host).replace(t.PCT_ENCODED,r).toLowerCase().replace(t.NOT_HOST,P).replace(t.PCT_ENCODED,s)),void 0!==e.path&&(e.path=String(e.path).replace(t.PCT_ENCODED,r).replace(e.scheme?t.NOT_PATH:t.NOT_PATH_NOSCHEME,P).replace(t.PCT_ENCODED,s)),void 0!==e.query&&(e.query=String(e.query).replace(t.PCT_ENCODED,r).replace(t.NOT_QUERY,P).replace(t.PCT_ENCODED,s)),void 0!==e.fragment&&(e.fragment=String(e.fragment).replace(t.PCT_ENCODED,r).replace(t.NOT_FRAGMENT,P).replace(t.PCT_ENCODED,s)),e}function O(e){return e.replace(/^0*(.*)/,"$1")||"0"}function N(e,t){var r=e.match(t.IPV4ADDRESS)||[],n=c(r,2)[1];return n?n.split(".").map(O).join("."):e}function T(e,t){var r=e.match(t.IPV6ADDRESS)||[],n=c(r,3),s=n[1],o=n[2];if(s){for(var a=s.toLowerCase().split("::").reverse(),i=c(a,2),l=i[0],u=i[1],d=u?u.split(":").map(O):[],h=l.split(":").map(O),p=t.IPV4ADDRESS.test(h[h.length-1]),f=p?7:8,m=h.length-f,v=Array(f),g=0;g<f;++g)v[g]=d[g]||h[m+g]||"";p&&(v[f-1]=N(v[f-1],t));var y=v.reduce((function(e,t,r){if(!t||"0"===t){var n=e[e.length-1];n&&n.index+n.length===r?n.length++:e.push({index:r,length:1})}return e}),[]).sort((function(e,t){return t.length-e.length}))[0],b=void 0;if(y&&y.length>1){var $=v.slice(0,y.index),w=v.slice(y.index+y.length);b=$.join(":")+"::"+w.join(":")}else b=v.join(":");return o&&(b+="%"+o),b}return e}var j=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,D=void 0==="".match(/(){0}/)[1];function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r={},n=!1!==t.iri?i:a;"suffix"===t.reference&&(e=(t.scheme?t.scheme+":":"")+"//"+e);var s=e.match(j);if(s){D?(r.scheme=s[1],r.userinfo=s[3],r.host=s[4],r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=s[7],r.fragment=s[8],isNaN(r.port)&&(r.port=s[5])):(r.scheme=s[1]||void 0,r.userinfo=-1!==e.indexOf("@")?s[3]:void 0,r.host=-1!==e.indexOf("//")?s[4]:void 0,r.port=parseInt(s[5],10),r.path=s[6]||"",r.query=-1!==e.indexOf("?")?s[7]:void 0,r.fragment=-1!==e.indexOf("#")?s[8]:void 0,isNaN(r.port)&&(r.port=e.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?s[4]:void 0)),r.host&&(r.host=T(N(r.host,n),n)),void 0!==r.scheme||void 0!==r.userinfo||void 0!==r.host||void 0!==r.port||r.path||void 0!==r.query?void 0===r.scheme?r.reference="relative":void 0===r.fragment?r.reference="absolute":r.reference="uri":r.reference="same-document",t.reference&&"suffix"!==t.reference&&t.reference!==r.reference&&(r.error=r.error||"URI is not a "+t.reference+" reference.");var o=S[(t.scheme||r.scheme||"").toLowerCase()];if(t.unicodeSupport||o&&o.unicodeSupport)C(r,n);else{if(r.host&&(t.domainHost||o&&o.domainHost))try{r.host=E(r.host.replace(n.PCT_ENCODED,A).toLowerCase())}catch(e){r.error=r.error||"Host's domain name can not be converted to ASCII via punycode: "+e}C(r,a)}o&&o.parse&&o.parse(r,t)}else r.error=r.error||"URI can not be parsed.";return r}function M(e,t){var r=!1!==t.iri?i:a,n=[];return void 0!==e.userinfo&&(n.push(e.userinfo),n.push("@")),void 0!==e.host&&n.push(T(N(String(e.host),r),r).replace(r.IPV6ADDRESS,(function(e,t,r){return"["+t+(r?"%25"+r:"")+"]"}))),"number"!=typeof e.port&&"string"!=typeof e.port||(n.push(":"),n.push(String(e.port))),n.length?n.join(""):void 0}var R=/^\.\.?\//,F=/^\/\.(\/|$)/,U=/^\/\.\.(\/|$)/,z=/^\/?(?:.|\n)*?(?=\/|$)/;function V(e){for(var t=[];e.length;)if(e.match(R))e=e.replace(R,"");else if(e.match(F))e=e.replace(F,"/");else if(e.match(U))e=e.replace(U,"/"),t.pop();else if("."===e||".."===e)e="";else{var r=e.match(z);if(!r)throw new Error("Unexpected dot segment condition");var n=r[0];e=e.slice(n.length),t.push(n)}return t.join("")}function q(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.iri?i:a,n=[],s=S[(t.scheme||e.scheme||"").toLowerCase()];if(s&&s.serialize&&s.serialize(e,t),e.host)if(r.IPV6ADDRESS.test(e.host));else if(t.domainHost||s&&s.domainHost)try{e.host=t.iri?x(e.host):E(e.host.replace(r.PCT_ENCODED,A).toLowerCase())}catch(r){e.error=e.error||"Host's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+r}C(e,r),"suffix"!==t.reference&&e.scheme&&(n.push(e.scheme),n.push(":"));var o=M(e,t);if(void 0!==o&&("suffix"!==t.reference&&n.push("//"),n.push(o),e.path&&"/"!==e.path.charAt(0)&&n.push("/")),void 0!==e.path){var c=e.path;t.absolutePath||s&&s.absolutePath||(c=V(c)),void 0===o&&(c=c.replace(/^\/\//,"/%2F")),n.push(c)}return void 0!==e.query&&(n.push("?"),n.push(e.query)),void 0!==e.fragment&&(n.push("#"),n.push(e.fragment)),n.join("")}function L(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={};return arguments[3]||(e=I(q(e,r),r),t=I(q(t,r),r)),!(r=r||{}).tolerant&&t.scheme?(n.scheme=t.scheme,n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=V(t.path||""),n.query=t.query):(void 0!==t.userinfo||void 0!==t.host||void 0!==t.port?(n.userinfo=t.userinfo,n.host=t.host,n.port=t.port,n.path=V(t.path||""),n.query=t.query):(t.path?("/"===t.path.charAt(0)?n.path=V(t.path):(void 0===e.userinfo&&void 0===e.host&&void 0===e.port||e.path?e.path?n.path=e.path.slice(0,e.path.lastIndexOf("/")+1)+t.path:n.path=t.path:n.path="/"+t.path,n.path=V(n.path)),n.query=t.query):(n.path=e.path,void 0!==t.query?n.query=t.query:n.query=e.query),n.userinfo=e.userinfo,n.host=e.host,n.port=e.port),n.scheme=e.scheme),n.fragment=t.fragment,n}function H(e,t){return e&&e.toString().replace(t&&t.iri?i.PCT_ENCODED:a.PCT_ENCODED,A)}var K={scheme:"http",domainHost:!0,parse:function(e,t){return e.host||(e.error=e.error||"HTTP URIs must have a host."),e},serialize:function(e,t){var r="https"===String(e.scheme).toLowerCase();return e.port!==(r?443:80)&&""!==e.port||(e.port=void 0),e.path||(e.path="/"),e}},G={scheme:"https",domainHost:K.domainHost,parse:K.parse,serialize:K.serialize};function B(e){return"boolean"==typeof e.secure?e.secure:"wss"===String(e.scheme).toLowerCase()}var J={scheme:"ws",domainHost:!0,parse:function(e,t){var r=e;return r.secure=B(r),r.resourceName=(r.path||"/")+(r.query?"?"+r.query:""),r.path=void 0,r.query=void 0,r},serialize:function(e,t){if(e.port!==(B(e)?443:80)&&""!==e.port||(e.port=void 0),"boolean"==typeof e.secure&&(e.scheme=e.secure?"wss":"ws",e.secure=void 0),e.resourceName){var r=e.resourceName.split("?"),n=c(r,2),s=n[0],o=n[1];e.path=s&&"/"!==s?s:void 0,e.query=o,e.resourceName=void 0}return e.fragment=void 0,e}},W={scheme:"wss",domainHost:J.domainHost,parse:J.parse,serialize:J.serialize},Y={},Z="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",X="[0-9A-Fa-f]",Q=r(r("%[EFef]"+X+"%"+X+X+"%"+X+X)+"|"+r("%[89A-Fa-f]"+X+"%"+X+X)+"|"+r("%"+X+X)),ee=t("[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",'[\\"\\\\]'),te=new RegExp(Z,"g"),re=new RegExp(Q,"g"),ne=new RegExp(t("[^]","[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]","[\\.]",'[\\"]',ee),"g"),se=new RegExp(t("[^]",Z,"[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]"),"g"),oe=se;function ae(e){var t=A(e);return t.match(te)?t:e}var ie={scheme:"mailto",parse:function(e,t){var r=e,n=r.to=r.path?r.path.split(","):[];if(r.path=void 0,r.query){for(var s=!1,o={},a=r.query.split("&"),i=0,c=a.length;i<c;++i){var l=a[i].split("=");switch(l[0]){case"to":for(var u=l[1].split(","),d=0,h=u.length;d<h;++d)n.push(u[d]);break;case"subject":r.subject=H(l[1],t);break;case"body":r.body=H(l[1],t);break;default:s=!0,o[H(l[0],t)]=H(l[1],t)}}s&&(r.headers=o)}r.query=void 0;for(var p=0,f=n.length;p<f;++p){var m=n[p].split("@");if(m[0]=H(m[0]),t.unicodeSupport)m[1]=H(m[1],t).toLowerCase();else try{m[1]=E(H(m[1],t).toLowerCase())}catch(e){r.error=r.error||"Email address's domain name can not be converted to ASCII via punycode: "+e}n[p]=m.join("@")}return r},serialize:function(e,t){var r,n=e,o=null!=(r=e.to)?r instanceof Array?r:"number"!=typeof r.length||r.split||r.setInterval||r.call?[r]:Array.prototype.slice.call(r):[];if(o){for(var a=0,i=o.length;a<i;++a){var c=String(o[a]),l=c.lastIndexOf("@"),u=c.slice(0,l).replace(re,ae).replace(re,s).replace(ne,P),d=c.slice(l+1);try{d=t.iri?x(d):E(H(d,t).toLowerCase())}catch(e){n.error=n.error||"Email address's domain name can not be converted to "+(t.iri?"Unicode":"ASCII")+" via punycode: "+e}o[a]=u+"@"+d}n.path=o.join(",")}var h=e.headers=e.headers||{};e.subject&&(h.subject=e.subject),e.body&&(h.body=e.body);var p=[];for(var f in h)h[f]!==Y[f]&&p.push(f.replace(re,ae).replace(re,s).replace(se,P)+"="+h[f].replace(re,ae).replace(re,s).replace(oe,P));return p.length&&(n.query=p.join("&")),n}},ce=/^([^\:]+)\:(.*)/,le={scheme:"urn",parse:function(e,t){var r=e.path&&e.path.match(ce),n=e;if(r){var s=t.scheme||n.scheme||"urn",o=r[1].toLowerCase(),a=r[2],i=s+":"+(t.nid||o),c=S[i];n.nid=o,n.nss=a,n.path=void 0,c&&(n=c.parse(n,t))}else n.error=n.error||"URN can not be parsed.";return n},serialize:function(e,t){var r=t.scheme||e.scheme||"urn",n=e.nid,s=r+":"+(t.nid||n),o=S[s];o&&(e=o.serialize(e,t));var a=e,i=e.nss;return a.path=(n||t.nid)+":"+i,a}},ue=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,de={scheme:"urn:uuid",parse:function(e,t){var r=e;return r.uuid=r.nss,r.nss=void 0,t.tolerant||r.uuid&&r.uuid.match(ue)||(r.error=r.error||"UUID is not valid."),r},serialize:function(e,t){var r=e;return r.nss=(e.uuid||"").toLowerCase(),r}};S[K.scheme]=K,S[G.scheme]=G,S[J.scheme]=J,S[W.scheme]=W,S[ie.scheme]=ie,S[le.scheme]=le,S[de.scheme]=de,e.SCHEMES=S,e.pctEncChar=P,e.pctDecChars=A,e.parse=I,e.removeDotSegments=V,e.serialize=q,e.resolveComponents=L,e.resolve=function(e,t,r){var n=function(e,t){var r=e;if(t)for(var n in t)r[n]=t[n];return r}({scheme:"null"},r);return q(L(I(e,n),I(t,n),n,!0),n)},e.normalize=function(e,t){return"string"==typeof e?e=q(I(e,t),t):"object"===n(e)&&(e=I(q(e,t),t)),e},e.equal=function(e,t,r){return"string"==typeof e?e=q(I(e,r),r):"object"===n(e)&&(e=q(e,r)),"string"==typeof t?t=q(I(t,r),r):"object"===n(t)&&(t=q(t,r)),e===t},e.escapeComponent=function(e,t){return e&&e.toString().replace(t&&t.iri?i.ESCAPE:a.ESCAPE,P)},e.unescapeComponent=H,Object.defineProperty(e,"__esModule",{value:!0})}(t)},4775:e=>{"use strict";e.exports=JSON.parse('{"$id":"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#","description":"Meta-schema for $data reference (JSON AnySchema extension proposal)","type":"object","required":["$data"],"properties":{"$data":{"type":"string","anyOf":[{"format":"relative-json-pointer"},{"format":"json-pointer"}]}},"additionalProperties":false}')},98:e=>{"use strict";e.exports=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","$id":"http://json-schema.org/draft-07/schema#","title":"Core schema meta-schema","definitions":{"schemaArray":{"type":"array","minItems":1,"items":{"$ref":"#"}},"nonNegativeInteger":{"type":"integer","minimum":0},"nonNegativeIntegerDefault0":{"allOf":[{"$ref":"#/definitions/nonNegativeInteger"},{"default":0}]},"simpleTypes":{"enum":["array","boolean","integer","null","number","object","string"]},"stringArray":{"type":"array","items":{"type":"string"},"uniqueItems":true,"default":[]}},"type":["object","boolean"],"properties":{"$id":{"type":"string","format":"uri-reference"},"$schema":{"type":"string","format":"uri"},"$ref":{"type":"string","format":"uri-reference"},"$comment":{"type":"string"},"title":{"type":"string"},"description":{"type":"string"},"default":true,"readOnly":{"type":"boolean","default":false},"examples":{"type":"array","items":true},"multipleOf":{"type":"number","exclusiveMinimum":0},"maximum":{"type":"number"},"exclusiveMaximum":{"type":"number"},"minimum":{"type":"number"},"exclusiveMinimum":{"type":"number"},"maxLength":{"$ref":"#/definitions/nonNegativeInteger"},"minLength":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"pattern":{"type":"string","format":"regex"},"additionalItems":{"$ref":"#"},"items":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/schemaArray"}],"default":true},"maxItems":{"$ref":"#/definitions/nonNegativeInteger"},"minItems":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"uniqueItems":{"type":"boolean","default":false},"contains":{"$ref":"#"},"maxProperties":{"$ref":"#/definitions/nonNegativeInteger"},"minProperties":{"$ref":"#/definitions/nonNegativeIntegerDefault0"},"required":{"$ref":"#/definitions/stringArray"},"additionalProperties":{"$ref":"#"},"definitions":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"properties":{"type":"object","additionalProperties":{"$ref":"#"},"default":{}},"patternProperties":{"type":"object","additionalProperties":{"$ref":"#"},"propertyNames":{"format":"regex"},"default":{}},"dependencies":{"type":"object","additionalProperties":{"anyOf":[{"$ref":"#"},{"$ref":"#/definitions/stringArray"}]}},"propertyNames":{"$ref":"#"},"const":true,"enum":{"type":"array","items":true,"minItems":1,"uniqueItems":true},"type":{"anyOf":[{"$ref":"#/definitions/simpleTypes"},{"type":"array","items":{"$ref":"#/definitions/simpleTypes"},"minItems":1,"uniqueItems":true}]},"format":{"type":"string"},"contentMediaType":{"type":"string"},"contentEncoding":{"type":"string"},"if":{"$ref":"#"},"then":{"$ref":"#"},"else":{"$ref":"#"},"allOf":{"$ref":"#/definitions/schemaArray"},"anyOf":{"$ref":"#/definitions/schemaArray"},"oneOf":{"$ref":"#/definitions/schemaArray"},"not":{"$ref":"#"}},"default":true}')}},t={};function r(n){var s=t[n];if(void 0!==s)return s.exports;var o=t[n]={exports:{}};return e[n].call(o.exports,o,o.exports,r),o.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{"use strict";const e=window.ShadowRoot&&(void 0===window.ShadyCSS||window.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,t=Symbol(),n=new Map;class s{constructor(e,r){if(this._$cssResult$=!0,r!==t)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e}get styleSheet(){let t=n.get(this.cssText);return e&&void 0===t&&(n.set(this.cssText,t=new CSSStyleSheet),t.replaceSync(this.cssText)),t}toString(){return this.cssText}}const o=e=>new s("string"==typeof e?e:e+"",t),a=(e,...r)=>{const n=1===e.length?e[0]:r.reduce(((t,r,n)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[n+1]),e[0]);return new s(n,t)},i=e?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const r of e.cssRules)t+=r.cssText;return o(t)})(e):e;var c;const l=window.trustedTypes,u=l?l.emptyScript:"",d=window.reactiveElementPolyfillSupport,h={toAttribute(e,t){switch(t){case Boolean:e=e?u:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},p=(e,t)=>t!==e&&(t==t||e==e),f={attribute:!0,type:String,converter:h,reflect:!1,hasChanged:p};class m extends HTMLElement{constructor(){super(),this._$Et=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Ei=null,this.o()}static addInitializer(e){var t;null!==(t=this.l)&&void 0!==t||(this.l=[]),this.l.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,r)=>{const n=this._$Eh(r,t);void 0!==n&&(this._$Eu.set(n,r),e.push(n))})),e}static createProperty(e,t=f){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const r="symbol"==typeof e?Symbol():"__"+e,n=this.getPropertyDescriptor(e,r,t);void 0!==n&&Object.defineProperty(this.prototype,e,n)}}static getPropertyDescriptor(e,t,r){return{get(){return this[t]},set(n){const s=this[e];this[t]=n,this.requestUpdate(e,s,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||f}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Eu=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const r of t)this.createProperty(r,e[r])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const r=new Set(e.flat(1/0).reverse());for(const e of r)t.unshift(i(e))}else void 0!==e&&t.push(i(e));return t}static _$Eh(e,t){const r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}o(){var e;this._$Ep=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Em(),this.requestUpdate(),null===(e=this.constructor.l)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,r;(null!==(t=this._$Eg)&&void 0!==t?t:this._$Eg=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(r=e.hostConnected)||void 0===r||r.call(e))}removeController(e){var t;null===(t=this._$Eg)||void 0===t||t.splice(this._$Eg.indexOf(e)>>>0,1)}_$Em(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Et.set(t,this[t]),delete this[t])}))}createRenderRoot(){var t;const r=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,r)=>{e?t.adoptedStyleSheets=r.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):r.forEach((e=>{const r=document.createElement("style"),n=window.litNonce;void 0!==n&&r.setAttribute("nonce",n),r.textContent=e.cssText,t.appendChild(r)}))})(r,this.constructor.elementStyles),r}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$Eg)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$Eg)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ES(e,t,r=f){var n,s;const o=this.constructor._$Eh(e,r);if(void 0!==o&&!0===r.reflect){const a=(null!==(s=null===(n=r.converter)||void 0===n?void 0:n.toAttribute)&&void 0!==s?s:h.toAttribute)(t,r.type);this._$Ei=e,null==a?this.removeAttribute(o):this.setAttribute(o,a),this._$Ei=null}}_$AK(e,t){var r,n,s;const o=this.constructor,a=o._$Eu.get(e);if(void 0!==a&&this._$Ei!==a){const e=o.getPropertyOptions(a),i=e.converter,c=null!==(s=null!==(n=null===(r=i)||void 0===r?void 0:r.fromAttribute)&&void 0!==n?n:"function"==typeof i?i:null)&&void 0!==s?s:h.fromAttribute;this._$Ei=a,this[a]=c(t,e.type),this._$Ei=null}}requestUpdate(e,t,r){let n=!0;void 0!==e&&(((r=r||this.constructor.getPropertyOptions(e)).hasChanged||p)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===r.reflect&&this._$Ei!==e&&(void 0===this._$E_&&(this._$E_=new Map),this._$E_.set(e,r))):n=!1),!this.isUpdatePending&&n&&(this._$Ep=this._$EC())}async _$EC(){this.isUpdatePending=!0;try{await this._$Ep}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Et&&(this._$Et.forEach(((e,t)=>this[t]=e)),this._$Et=void 0);let t=!1;const r=this._$AL;try{t=this.shouldUpdate(r),t?(this.willUpdate(r),null===(e=this._$Eg)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(r)):this._$EU()}catch(e){throw t=!1,this._$EU(),e}t&&this._$AE(r)}willUpdate(e){}_$AE(e){var t;null===(t=this._$Eg)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EU(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$Ep}shouldUpdate(e){return!0}update(e){void 0!==this._$E_&&(this._$E_.forEach(((e,t)=>this._$ES(t,this[t],e))),this._$E_=void 0),this._$EU()}updated(e){}firstUpdated(e){}}var v;m.finalized=!0,m.elementProperties=new Map,m.elementStyles=[],m.shadowRootOptions={mode:"open"},null==d||d({ReactiveElement:m}),(null!==(c=globalThis.reactiveElementVersions)&&void 0!==c?c:globalThis.reactiveElementVersions=[]).push("1.0.2");const g=globalThis.trustedTypes,y=g?g.createPolicy("lit-html",{createHTML:e=>e}):void 0,b=`lit$${(Math.random()+"").slice(9)}$`,$="?"+b,w=`<${$}>`,_=document,k=(e="")=>_.createComment(e),E=e=>null===e||"object"!=typeof e&&"function"!=typeof e,x=Array.isArray,S=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,P=/-->/g,A=/>/g,C=/>|[ 	\n\r](?:([^\s"'>=/]+)([ 	\n\r]*=[ 	\n\r]*(?:[^ 	\n\r"'`<>=]|("|')|))|$)/g,O=/'/g,N=/"/g,T=/^(?:script|style|textarea)$/i,j=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),D=j(1),I=(j(2),Symbol.for("lit-noChange")),M=Symbol.for("lit-nothing"),R=new WeakMap,F=_.createTreeWalker(_,129,null,!1),U=(e,t)=>{const r=e.length-1,n=[];let s,o=2===t?"<svg>":"",a=S;for(let t=0;t<r;t++){const r=e[t];let i,c,l=-1,u=0;for(;u<r.length&&(a.lastIndex=u,c=a.exec(r),null!==c);)u=a.lastIndex,a===S?"!--"===c[1]?a=P:void 0!==c[1]?a=A:void 0!==c[2]?(T.test(c[2])&&(s=RegExp("</"+c[2],"g")),a=C):void 0!==c[3]&&(a=C):a===C?">"===c[0]?(a=null!=s?s:S,l=-1):void 0===c[1]?l=-2:(l=a.lastIndex-c[2].length,i=c[1],a=void 0===c[3]?C:'"'===c[3]?N:O):a===N||a===O?a=C:a===P||a===A?a=S:(a=C,s=void 0);const d=a===C&&e[t+1].startsWith("/>")?" ":"";o+=a===S?r+w:l>=0?(n.push(i),r.slice(0,l)+"$lit$"+r.slice(l)+b+d):r+b+(-2===l?(n.push(void 0),t):d)}const i=o+(e[r]||"<?>")+(2===t?"</svg>":"");return[void 0!==y?y.createHTML(i):i,n]};class z{constructor({strings:e,_$litType$:t},r){let n;this.parts=[];let s=0,o=0;const a=e.length-1,i=this.parts,[c,l]=U(e,t);if(this.el=z.createElement(c,r),F.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(n=F.nextNode())&&i.length<a;){if(1===n.nodeType){if(n.hasAttributes()){const e=[];for(const t of n.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(b)){const r=l[o++];if(e.push(t),void 0!==r){const e=n.getAttribute(r.toLowerCase()+"$lit$").split(b),t=/([.?@])?(.*)/.exec(r);i.push({type:1,index:s,name:t[2],strings:e,ctor:"."===t[1]?K:"?"===t[1]?B:"@"===t[1]?J:H})}else i.push({type:6,index:s})}for(const t of e)n.removeAttribute(t)}if(T.test(n.tagName)){const e=n.textContent.split(b),t=e.length-1;if(t>0){n.textContent=g?g.emptyScript:"";for(let r=0;r<t;r++)n.append(e[r],k()),F.nextNode(),i.push({type:2,index:++s});n.append(e[t],k())}}}else if(8===n.nodeType)if(n.data===$)i.push({type:2,index:s});else{let e=-1;for(;-1!==(e=n.data.indexOf(b,e+1));)i.push({type:7,index:s}),e+=b.length-1}s++}}static createElement(e,t){const r=_.createElement("template");return r.innerHTML=e,r}}function V(e,t,r=e,n){var s,o,a,i;if(t===I)return t;let c=void 0!==n?null===(s=r._$Cl)||void 0===s?void 0:s[n]:r._$Cu;const l=E(t)?void 0:t._$litDirective$;return(null==c?void 0:c.constructor)!==l&&(null===(o=null==c?void 0:c._$AO)||void 0===o||o.call(c,!1),void 0===l?c=void 0:(c=new l(e),c._$AT(e,r,n)),void 0!==n?(null!==(a=(i=r)._$Cl)&&void 0!==a?a:i._$Cl=[])[n]=c:r._$Cu=c),void 0!==c&&(t=V(e,c._$AS(e,t.values),c,n)),t}class q{constructor(e,t){this.v=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}p(e){var t;const{el:{content:r},parts:n}=this._$AD,s=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:_).importNode(r,!0);F.currentNode=s;let o=F.nextNode(),a=0,i=0,c=n[0];for(;void 0!==c;){if(a===c.index){let t;2===c.type?t=new L(o,o.nextSibling,this,e):1===c.type?t=new c.ctor(o,c.name,c.strings,this,e):6===c.type&&(t=new W(o,this,e)),this.v.push(t),c=n[++i]}a!==(null==c?void 0:c.index)&&(o=F.nextNode(),a++)}return s}m(e){let t=0;for(const r of this.v)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class L{constructor(e,t,r,n){var s;this.type=2,this._$AH=M,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=n,this._$Cg=null===(s=null==n?void 0:n.isConnected)||void 0===s||s}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cg}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=V(this,e,t),E(e)?e===M||null==e||""===e?(this._$AH!==M&&this._$AR(),this._$AH=M):e!==this._$AH&&e!==I&&this.$(e):void 0!==e._$litType$?this.T(e):void 0!==e.nodeType?this.S(e):(e=>{var t;return x(e)||"function"==typeof(null===(t=e)||void 0===t?void 0:t[Symbol.iterator])})(e)?this.M(e):this.$(e)}A(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}S(e){this._$AH!==e&&(this._$AR(),this._$AH=this.A(e))}$(e){this._$AH!==M&&E(this._$AH)?this._$AA.nextSibling.data=e:this.S(_.createTextNode(e)),this._$AH=e}T(e){var t;const{values:r,_$litType$:n}=e,s="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=z.createElement(n.h,this.options)),n);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===s)this._$AH.m(r);else{const e=new q(s,this),t=e.p(this.options);e.m(r),this.S(t),this._$AH=e}}_$AC(e){let t=R.get(e.strings);return void 0===t&&R.set(e.strings,t=new z(e)),t}M(e){x(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let r,n=0;for(const s of e)n===t.length?t.push(r=new L(this.A(k()),this.A(k()),this,this.options)):r=t[n],r._$AI(s),n++;n<t.length&&(this._$AR(r&&r._$AB.nextSibling,n),t.length=n)}_$AR(e=this._$AA.nextSibling,t){var r;for(null===(r=this._$AP)||void 0===r||r.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cg=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class H{constructor(e,t,r,n,s){this.type=1,this._$AH=M,this._$AN=void 0,this.element=e,this.name=t,this._$AM=n,this.options=s,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=M}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,r,n){const s=this.strings;let o=!1;if(void 0===s)e=V(this,e,t,0),o=!E(e)||e!==this._$AH&&e!==I,o&&(this._$AH=e);else{const n=e;let a,i;for(e=s[0],a=0;a<s.length-1;a++)i=V(this,n[r+a],t,a),i===I&&(i=this._$AH[a]),o||(o=!E(i)||i!==this._$AH[a]),i===M?e=M:e!==M&&(e+=(null!=i?i:"")+s[a+1]),this._$AH[a]=i}o&&!n&&this.k(e)}k(e){e===M?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class K extends H{constructor(){super(...arguments),this.type=3}k(e){this.element[this.name]=e===M?void 0:e}}const G=g?g.emptyScript:"";class B extends H{constructor(){super(...arguments),this.type=4}k(e){e&&e!==M?this.element.setAttribute(this.name,G):this.element.removeAttribute(this.name)}}class J extends H{constructor(e,t,r,n,s){super(e,t,r,n,s),this.type=5}_$AI(e,t=this){var r;if((e=null!==(r=V(this,e,t,0))&&void 0!==r?r:M)===I)return;const n=this._$AH,s=e===M&&n!==M||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,o=e!==M&&(n===M||s);s&&this.element.removeEventListener(this.name,this,n),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,r;"function"==typeof this._$AH?this._$AH.call(null!==(r=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==r?r:this.element,e):this._$AH.handleEvent(e)}}class W{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){V(this,e)}}const Y=window.litHtmlPolyfillSupport;var Z,X;null==Y||Y(z,L),(null!==(v=globalThis.litHtmlVersions)&&void 0!==v?v:globalThis.litHtmlVersions=[]).push("2.0.2");class Q extends m{constructor(){super(...arguments),this.renderOptions={host:this},this._$Dt=void 0}createRenderRoot(){var e,t;const r=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=r.firstChild),r}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Dt=((e,t,r)=>{var n,s;const o=null!==(n=null==r?void 0:r.renderBefore)&&void 0!==n?n:t;let a=o._$litPart$;if(void 0===a){const e=null!==(s=null==r?void 0:r.renderBefore)&&void 0!==s?s:null;o._$litPart$=a=new L(t.insertBefore(k(),e),e,void 0,null!=r?r:{})}return a._$AI(e),a})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Dt)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Dt)||void 0===e||e.setConnected(!1)}render(){return I}}Q.finalized=!0,Q._$litElement$=!0,null===(Z=globalThis.litElementHydrateSupport)||void 0===Z||Z.call(globalThis,{LitElement:Q});const ee=globalThis.litElementPolyfillSupport;null==ee||ee({LitElement:Q}),(null!==(X=globalThis.litElementVersions)&&void 0!==X?X:globalThis.litElementVersions=[]).push("3.0.2");var te=r(8998),re=r.n(te);const ne=e=>{if("string"!=typeof e)return e;var t=new XMLHttpRequest;return t.open("GET","./model/"+e+".json",!1),t.send(null),200===t.status?JSON.parse(t.responseText):void 0};String.prototype.evaluateOnContext=function(e){const t=Object.keys(e),r=Object.values(e);return new Function(...t,`return \`${this}\`;`)(...r)};class se{constructor(e,t,r,n=null,s){this.repository=e,this.name=t,this.element=r,this.parentStore=n,this.listeners={},this.subStores={},this.state=null==n?{}:n.registerSubStore(this),this.localStore=!1,this.serverStore=!1,this.config=s,this.element.storageModes&&(this.localStore=this.element.storageModes.includes("local"),this.serverStore=this.element.storageModes.includes("server"));const o=r.constructor.model||r.model;o&&(this.model=o,this.model.mappings&&this.registerElementListener(r,o.mappings,!1,this)),(this.localStore||this.serverStore)&&this.initLocalState(),this.dispatch("")}initLocalState(){this.resetState(),this.loadState()}extractNamesFromAst(e,t){if(e.hasOwnProperty("type")&&"path"===e.type){const r=e.steps.reduce(((e,t)=>"name"===t.type?""===e?t.value:e+"."+t.value:e),"");-1===t.indexOf(r)&&t.push(r)}else Object.keys(e).forEach((r=>{if(Array.isArray(e[r])&&["arguments","expressions","steps"].includes(r))for(let n of e[r])"object"==typeof n&&this.extractNamesFromAst(n,t);else"object"==typeof e[r]&&this.extractNamesFromAst(e[r],t)}))}extractNamesFromMappings(e,t){for(const r of e)r.value?-1===t.indexOf(r.value)&&t.push(r.value):r.jsonataExpression&&(r.jsonata||(r.jsonata=jsonata(r.jsonataExpression)),this.extractNamesFromAst(r.jsonata.ast(),t))}registerElementListener(e,t,r,n){if(t=t.map((e=>e.jsonataExpression?{...e,jsonata:jsonata(e.jsonataExpression)}:e)),r||(r=[],this.extractNamesFromMappings(t,r)),this.parentStore)r=r.map((e=>this.name+"."+e)),this.parentStore.registerElementListener(e,t,r,n||this);else for(let s of r)this.listeners[s]||(this.listeners[s]=[]),this.listeners[s].push({element:e,mappings:t,store:n||this})}registerSubStore(e){return this.subStores[e.name]=e,this.getState(e.name)}getState(e){return this.parentStore?this.parentStore.getState(this.name+(""===e?"":"."+e)):(this.state[e]||(this.state[e]={}),this.state[e])}dispatch(e="",t=null){if(this.parentStore)this.parentStore.dispatch(this.name+(""===e?"":"."+e),t);else{let r=[];Object.keys(this.listeners).forEach((n=>{let s=!1;if(s=null==t?n===e||n.startsWith(e+".")||""===e:n===e||n===e+"."+t,s)for(const e of this.listeners[n])if(0===r.length)r.push(e);else{let t=!1;for(const n of r)if(n.element===e.element){t=!0;break}t||r.push(e)}}));for(const e of r){let r=e.element;for(const n of e.mappings)n.jsonata?r[n.property]=n.jsonata.evaluate(e.store.state):!n.value||null!=t&&n.value!==t||(r[n.property]=e.store.state[n.value])}}}filterOutSubstores(e,t){return t.reduce(((t,r)=>void 0!==e[r]?Object.assign(t,{[r]:e[r]}):t),{})}storeState(){this.serverStore&&((e,t,r,n,s)=>{const{API_URL:o}=(s||{}).MEVEO||{};fetch((o||"/meveo/api/rest/")+e+"/persistence",{method:"POST",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify([{name:t,type:r,properties:n}])}).then((e=>console.log(JSON.stringify(e)))).catch((e=>console.error(e)))})(this.repository,this.name,this.model.modelClass,this.state,this.config),this.localStore&&this.parentStore?this.parentStore.storeState():this.localStore&&localStorage.setItem(this.name,JSON.stringify(this.state))}loadState(){if(this.serverStore&&this.model.filters){let e={};for(let t of this.model.filters)null!=this.element[t]&&(e[t]=this.element[t]);let t=((e,t,r,n)=>{var s=new XMLHttpRequest;const{API_URL:o}=(n||{}).MEVEO||{},a=(o||"/meveo/api/rest/")+e+"/persistence/"+t+"/list";if(s.open("POST",a,!1),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify({filters:r})),200===s.status){let e=JSON.parse(s.responseText);return 1===e.length?e[0]:e}})(this.repository,this.model.modelClass,e,this.config);null!=t&&(this.state={...this.state,...t})}if(!this.parentStore&&this.localStore){let e=JSON.parse(localStorage.getItem(this.name));null!=e&&(this.state={...this.state,...e})}}initializeStore(e,t,r,n){const{type:s,properties:o,allOf:a}=t||{};(a||[]).length>0&&a.forEach((t=>{const s=(r||[]).find((e=>e.id===t.$ref));this.initializeStore(e,s,r,n)})),"object"===s&&Object.getOwnPropertyNames(o).forEach((t=>{const s=o[t];if(n||void 0===e[t]){if(!s.type&&s.$ref){e[t]={};const o=(r||[]).find((e=>e.id===s.$ref));this.initializeStore(e[t],o,r,n)}else switch(s.type){case"object":e[t]={};break;case"array":e[t]=[];break;case"string":e[t]="";break;case"number":case"integer":e[t]=0;break;case"boolean":e[t]=!1;break;default:e[t]=null}void 0===this.element[t]||n||(e[t]=this.element[t])}}))}resetState(e){const{modelClass:t,entity:r}=this.model||{};if(t){const r=ne(t)||{},n=(this.model.refSchemas||[]).map((e=>ne(e)))||[];this.initializeStore(this.state,r,n,e),e&&(this.storeState(),this.dispatch(""))}else if(r){const{schema:t,refSchemas:n}=r;this.initializeStore(this.state,t,n,e),e&&(this.storeState(),this.dispatch(""))}}mapValue(e,t,r){const n=(t||"").indexOf(".");if(n>-1){const s=t.substring(0,n);return{[s]:this.mapValue(e[s],t.substring(n+1),r)}}return{[t]:r}}updateValue(e,t,r=!0){const n=(e||"").indexOf(".");if(n>-1){const r=e.substring(0,n),s=e.substring(n+1);this.state[r]={...this.state[r],...this.mapValue(this.state[r]||{},s,t)}}else this.state[e]=t;this.storeState(),r&&this.dispatch(e)}addItem(e,t,r=!0){this.removeItem(e,t,!1),this.state[e]=[...this.state[e],t],this.storeState(),r&&this.dispatch(e)}removeItem(e,t,r=!0){this.state[e]=this.state[e].filter((e=>e.value!==t.value)),this.storeState(),r&&this.dispatch(e)}updateItem(e,t,r=!0){this.state[e]=this.state[e].map((e=>(e.value===t.value&&(e={...e,...t}),e))),this.storeState(),r&&this.dispatch(e)}}class oe extends Q{static get properties(){return{name:{type:String,attribute:!0},storageModes:{type:String,attribute:"storage-modes"},config:{type:Object}}}getParentStore(e){return void 0===e?null:(e instanceof DocumentFragment&&(e=e.host),e instanceof Element?e instanceof oe?e.store:this.getParentStore(e.parentNode):null)}connectedCallback(){let e=this.getParentStore(this.parentNode);const{MEVEO:t}=this.config||{},{REPOSITORY:r}=t||{};this.store=new se(r||"default",this.attributes.name.value,this,e,this.config),super.connectedCallback()}}var ae=r(1581),ie=r.n(ae);const ce={allErrors:!0,format:"full",missingRefs:!0,loopRequired:"Infinite",verbose:!0,extendRefs:!0,schemaId:"auto",useDefaults:"empty"},le=(e,t,r,n,s)=>{const o=new(ie())(ce);s&&s.length>0&&s.forEach((e=>{o.addSchema(e)}));const a=o.validate(e,t),i=((e,t,r,n)=>(r||[]).reduce(((r,s)=>{const{keyword:o,dataPath:a,schemaPath:i,message:c,parentSchema:l}=s,u=a.slice(1),d=i.replace("#/","").replace(`/${o}`,"").replace(/\//g,"."),h=d.indexOf("."),p=h>-1?".":"",f=[t,...n||[]].find((e=>{const t=`${e.id}${p}`;return d.startsWith(t)||l.title.startsWith(t)}))||t,m=!d.startsWith("properties.")&&f.id&&t.id!==f.id?d.substring(h+1):d;return{...r,[u]:`${(re()(m).evaluate(f)||{}).title||e} ${c}`}}),{}))(r,e,o.errors,s);return a?null:n?Object.keys(i||{}).reduce(((e,t)=>t.startsWith(r)?{...e,[t]:i[t]}:e),{}):r?i[r]:i},ue=(e,t,r,n)=>e?r?e[`${r}[${n}]${t?`.${t}`:""}`]:e[t]:null,de=(e,t)=>{e.dispatchEvent(new CustomEvent("change-field",{detail:{...t},bubbles:!0,composed:!0}))},he=(e,t,r)=>{e.dispatchEvent(new CustomEvent("change-group-field",{detail:{...t,element:e,index:r},bubbles:!0,composed:!0}))},pe=e=>{const{target:t}=e;(t||e).dispatchEvent(new CustomEvent("submit-form",{bubbles:!0,composed:!0}))};console.warn("The main 'lit-element' module entrypoint is deprecated. Please update your imports to use the 'lit' package: 'lit' and 'lit/decorators.ts' or import from 'lit-element/lit-element.ts'. See https://lit.dev/msg/deprecated-import-path for more information."),customElements.define("mv-container",class extends Q{static get properties(){return{value:{type:String,attribute:!0},theme:{type:String,attribute:!0}}}static get styles(){return a`
      :host {
        font-family: var(--font-family, Arial);
        font-size: var(--font-size-m, 10pt);
        --light-background: var(--mv-container-background, #ffffff);
        --dark-background: var(--mv-container-dark-background, #373e48);
        --light-color: var(--mv-container-light-color, #000000);
        --dark-color: var(--mv-container-dark-color, #ffffff);
      }

      section {
        min-width: var(--mv-container-min-width, 300px);
        max-width: var(--mv-container-max-width, 500px);
        min-height: var(--mv-container-min-height, auto);
        max-height: var(--mv-container-max-height, auto);
        margin: var(--mv-container-margin, 20px auto);
        padding: var(--mv-container-padding, 20px);
        border: var(--mv-container-border, 1px solid #bfbfbf);
        border-radius: var(--mv-container-border-radius, 5px);
        top: var(--mv-container-top, 0);
        position: var(--mv-container-position, relative);
        background-color: var(--background-color);
        box-shadow: var(
          --mv-container-shadow,
          0 0 13px 0 rgba(42, 42, 42, 0.65)
        );
        color: var(--color);
      }

      .light {
        background-color: var(--light-background);
        color: var(--light-color);
      }

      .dark {
        background-color: var(--dark-background);
        color: var(--dark-color);
      }
    `}constructor(){super(),this.theme="light"}render(){return D`
      <section class="${this.theme}">
        <slot></slot>
      </section>
    `}}),customElements.define("mv-input",class extends Q{static get properties(){return{name:{type:String},rounded:{type:Boolean},value:{type:String},placeholder:{type:String},focus:{type:Boolean,attribute:!1},hasError:{type:Boolean,attribute:"has-error",reflect:!0},type:{type:String},disabled:{type:Boolean},required:{type:Boolean},immediate:{type:Boolean},pattern:{type:String},patternMatcher:{type:String,attribute:"pattern-matcher",reflect:!0},patternRegex:{type:String,attribute:"pattern-regex",reflect:!0}}}static get styles(){return a`
      :host {
        --mv-input-font-family: var(--font-family, Arial);
        --font-size: var(--font-size-m, 16px);
        --color: var(--mv-input-color, #818181);
        --min-width: var(--mv-input-min-width, auto);
        --max-width: var(--mv-input-max-width, auto);
        --margin: var(--mv-input-margin, 0);
        --border: var(--mv-input-border, 1px solid #4e686d);
        --active-border: var(--mv-input-active-border, 1px solid #1d9bc9);
        --disabled-border: var(--mv-input-disabled-border, 1px solid #c8c6c6);
        --disabled-background: var(--mv-input-disabled-background, #f8f6f6);
        --placeholder-color: var(--mv-input-placeholder-color, #c8c6c6);
        --required-placeholder-color: var(
          --mv-input-required-placeholder-color,
          #818181
        );
        --active-box-shadow: var(
          --mv-input-active-box-shadow,
          inset 0 0 9px 0 rgba(29, 155, 201, 0.3)
        );
        --error-border: var(
          --mv-input-error-border,
          1px solid rgba(247, 112, 98, 1)
        );
        --error-box-shadow: var(
          --mv-input-error-box-shadow,
          inset 0 0 9px 0 rgba(229, 47, 47, 0.3)
        );
        --box-radius: 5px;
        --rounded-radius: 50px;
        --box-padding: 11px 8px;
        --rounded-padding: 11px 20px;
        --prefix-width: var(--mv-input-prefix-width, 0);
        --suffix-width: var(--mv-input-suffix-width, 0);
      }

      .mv-input {
        min-width: var(--min-width);
        max-width: var(--max-width);
        border: var(--border);
        margin: var(--margin);
        background-color: var(--mv-input-background, #ffffff);
        display: grid;
        grid-template-areas: "prefix input-value suffix";
        grid-template-columns: var(--prefix-width) auto var(--suffix-width);
        align-items: center;
      }

      .mv-input:hover:not(.disabled),
      .mv-input.focus:not(.disabled) {
        border: var(--active-border);
        box-shadow: var(--active-box-shadow);
      }

      .mv-input.box.disabled {
        border: var(--disabled-border);
        background: var(--disabled-background);
      }

      .mv-input.box {
        padding: var(--box-padding);
        border-radius: var(--box-radius);
      }

      .mv-input.rounded {
        padding: var(--rounded-padding);
        border-radius: var(--rounded-radius);
      }

      .mv-input.error {
        border: var(--error-border);
      }

      .mv-input.error:hover:not(.disabled),
      .mv-input.error.focus:not(.disabled) {
        border: var(--error-border);
        box-shadow: var(--error-box-shadow);
      }

      .mv-input-value {
        color: var(--color);
        font-family: var(--mv-input-font-family);
        font-size: var(--font-size);
        background-color: transparent;
        border: none;
        outline: none;
        padding: 0;
        grid-area: input-value;
        width: 100%;
      }

      ::placeholder {
        color: var(--placeholder-color);
        font-weight: 100;
      }

      .required::placeholder {
        font-weight: 700;
        color: var(--required-placeholder-color);
      }

      .prefix {
        grid-area: prefix;
        justify-self: center;
        align-self: center;
      }

      .suffix {
        grid-area: suffix;
        justify-self: center;
        align-self: center;
      }
    `}constructor(){super(),this.type="text",this.focus=!1,this.rounded=!1,this.hasError=!1,this.disabled=!1,this.required=!1,this.pattern="",this.patternMatcher="_",this.patternRegex="\\d"}render(){const e=this.rounded?"rounded":"box",t=this.focus?" focus":"",r=this.hasError?" error":"",n=this.required?" required":"",s=`mv-input ${e}${t}${r}${n}${this.disabled?" disabled":""}`,o=`mv-input-value ${e}${n}`,a=this.value||0===this.value?this.value:"",i=this.placeholder||0===this.placeholder?this.placeholder:"";return D`
      <div class="${s}">
        <div class="prefix">        
          <slot name="prefix"></slot>
        </div>
        <input
          name="${this.name}"
          placeholder="${i}"
          class="${o}"
          .type="${this.type}"
          .value="${a}"
          @change="${this.inputChange()}"
          @input="${this.inputChange(!0)}"
          @focusin="${this.focusInInput}"
          @focusout="${this.focusOutInput}"
          ?disabled="${this.disabled}"
        />
        </span>
        <div class="suffix">
          <slot name="suffix"></slot>
        </div>
      </div>
    `}connectedCallback(){super.connectedCallback(),this.pattern&&(this.matcher=new Set(this.patternMatcher),this.regex=new RegExp(this.patternRegex,"g"))}inputChange=e=>t=>{const{name:r,type:n}=this,{target:s}=t,{value:o}=s,a=this.immediate&&e,i=!this.immediate&&!e,c=a||i;this.pattern&&this.format(t),c&&this.dispatchEvent(new CustomEvent("input-change",{detail:{name:r,type:n,value:o,originalEvent:t}}))};focusInInput=e=>{this.focus=!0,this.pattern&&this.format(e)};focusOutInput=e=>{const{name:t,type:r}=this,{target:n}=e;this.pattern&&this.pattern===n.value&&(n.value="",this.dispatchEvent(new CustomEvent("input-change",{detail:{name:t,type:r,value:n.value,originalEvent:e}}))),this.focus=!1};isInMatcher=e=>this.matcher.has(e);clean=e=>(e=e.match(this.regex)||[],Array.from(this.pattern,(t=>(e[0]===t||this.matcher.has(t))&&e.shift()||t)));format=e=>{const{target:t,key:r}=e,n=(e=>Array.from(this.pattern,((t,r)=>this.matcher.has(t)?e=r+1:e)))(0),s=this.clean(t.value).findIndex(this.isInMatcher),o="Backspace"===r,a=[...this.pattern].findIndex(this.isInMatcher),i=s<0?n[n.length-1]:o?n[s-1]||a:s;t.value=this.clean(t.value).join``,setTimeout((()=>{t.setSelectionRange(i,i)}))}});const fe=(e,t,r)=>{const n=(t||"").indexOf(".");if(n>-1){const s=t.substring(0,n);return{[s]:fe(e[s],t.substring(n+1),r)}}return{[t]:r}};customElements.define("mv-form",class extends Q{static get properties(){return{store:{type:Object,attribute:!1,reflect:!0},schema:{type:Object,attribute:!1,reflect:!0},formValues:{type:Object,attribute:!1,reflect:!0},refSchemas:{type:Array,attribute:!1,reflect:!0},storageModes:{type:String,attribute:"storage-modes",reflect:!0}}}static get styles(){return a`
      :host {
        font-family: var(--font-family, Arial);
        font-size: var(--font-size-m, 1em);
      }

      .mv-form {
        display: grid;
        grid-gap: var(--mv-form-grid-gap, 5px 10px);
        grid-template-columns: var(--mv-form-grid-columns, auto);
        grid-template-rows: var(--mv-form-grid-rows, auto);
      }
    `}constructor(){super(),this.store=null,this.schema=null,this.formValues={}}render(){return D`
      <div class="mv-form">
        <slot></slot>
      </div>
    `}connectedCallback(){this.addEventListener("change-field",this.changeField),this.addEventListener("submit-form",this.submitForm),this.addEventListener("clear-form",this.clearForm),super.connectedCallback()}changeField=e=>{const t=!!this.store,{detail:{name:r,value:n,group:s,index:o,validateGroup:a}}=e;let i=null;const c=s||r,l=s?a?s:`${s}[${o}].${r}`:r,u=t?this.store.state:this.formValues;if(t)this.store.updateValue(c,n);else{const e=fe(this.formValues,c,n);this.formValues={...this.formValues,...e},this.dispatchEvent(new CustomEvent("update-form",{detail:{values:this.formValues},bubbles:!0,composed:!0}))}if(i=le(this.schema,u,l,a,this.refSchemas),i){const e=a?i:{[l]:i};this.errors=a?{...Object.keys(this.errors||{}).reduce(((e,t)=>t.startsWith(r)?e:{...e,[t]:this.errors[t]}),{}),...e}:{...this.errors,...e},this.dispatchEvent(new CustomEvent("update-errors",{detail:{errors:{...this.errors}},bubbles:!0,composed:!0}))}else Object.keys(this.errors||{}).some((e=>e===l))&&(delete this.errors[l],this.dispatchEvent(new CustomEvent("update-errors",{detail:{errors:{...this.errors}},bubbles:!0,composed:!0})))};submitForm=()=>{const e=!!this.store;if(e){const{state:e}=this.store;this.errors=le(this.schema,e,null,null,this.refSchemas)}else this.errors=le(this.schema,this.formValues,null,null,this.refSchemas);this.errors?this.dispatchEvent(new CustomEvent("update-errors",{detail:{errors:this.errors},bubbles:!0,composed:!0})):this.dispatchEvent(new CustomEvent("validation-success",{detail:{formValues:e?this.store.state:this.formValues},bubbles:!0,composed:!0}))};clearForm=()=>{this.store?this.store.resetState(!0):(this.formValues={},this.dispatchEvent(new CustomEvent("update-form",{detail:{values:this.formValues},bubbles:!0,composed:!0}))),this.dispatchEvent(new CustomEvent("clear-errors",{bubbles:!0,composed:!0}))}}),customElements.define("mv-form-field",class extends Q{static get properties(){return{name:{type:String},label:{type:String},value:{type:Object},type:{type:String},placeholder:{type:String},error:{type:String},item:{type:Boolean},index:{type:Number},required:{type:Boolean,attribute:!0,reflect:!0},disabled:{type:Boolean,attribute:!0,reflect:!0},immediate:{type:Boolean,attribute:!0,reflect:!0},labelPosition:{type:String,attribute:"label-position",reflect:!0}}}static get styles(){return a`
      :host {
        --mv-form-font-family: var(--font-family, Arial);
        --mv-form-font-size: var(--font-size-m, 1em);
      }

      .label {
        grid-area: label;
      }

      .label .default-label,
      .label ::slotted(*) {
        font-size: var(--mv-form-font-size);
        font-weight: bold;
        color: #4e686d;
      }

      .label .required {
        font-style: normal;
        color: #ff0000;
      }

      .field {
        grid-area: field;
        font-size: var(--mv-form-font-size);
      }

      .error {
        grid-area: error;
        position: relative;
        font-size: calc(var(--mv-form-font-size) * 0.8);
        color: #ad4444;
      }

      .field .default-field,
      .field ::slotted(*) {
        width: 100%;
      }

      .field .default-field,
      .field ::slotted(*),
      .field .default-field::placeholder,
      .field ::slotted(*)::placeholder {
        font-family: var(--mv-form-font-family);
        font-size: var(--mv-form-font-size);
      }

      .field .default-field::placeholder,
      .field ::slotted(*)::placeholder {
        font-weight: 100;
      }

      .mv-form-field {
        display: grid;
        grid-column-gap: 20px;
        grid-row-gap: 5px;
        margin-bottom: 10px;
        align-items: center;
      }

      .mv-form-field.label-left {
        grid-template-columns: 20% auto;
        grid-template-rows: auto;
        grid-template-areas:
          "label field"
          ". error";
      }

      .mv-form-field.label-right {
        grid-template-columns: auto 20%;
        grid-template-rows: auto;
        grid-template-areas:
          "field label"
          "error .";
      }

      .mv-form-field.label-top {
        grid-template-areas:
          "label"
          "field"
          "error";
      }

      .mv-form-field.label-bottom {
        grid-template-areas:
          "field"
          "label"
          "error";
      }

      .mv-form-field.label-none {
        grid-template-areas:
          "field"
          "error";
      }
    `}constructor(){super(),this.name="",this.label="",this.value="",this.type="",this.placeholder="",this.error="",this.required=!1,this.disabled=!1,this.immediate=!1,this.labelPosition="left"}render(){const e=this.value||"",t=!!this.error,r="none"===this.labelPosition;return D`
      <div class="mv-form-field label-${this.labelPosition}">
        ${r?D``:D`
              <div class="label">
                <slot name="label">
                  <label class="default-label">
                    ${this.label}
                  </label>
                </slot>
                ${this.required?D`
                      <i class="required">*</i>
                    `:D``}
              </div>
            `}

        <div class="field">
          <slot name="field">
            <mv-input
              name="${this.name}"
              type="${this.type}"
              .value="${e}"
              placeholder="${this.placeholder}"
              ?has-error="${t}"
              @input-change="${this.changeValue}"
              ?disabled="${this.disabled}"
              ?required="${this.required}"
              ?immediate="${this.immediate}"
            ></mv-input>
          </slot>
        </div>
        ${t?D`
              <div class="error">${this.error}</div>
            `:D``}
      </div>
    `}changeValue=e=>{this.item?he(e.target,{...e.detail,name:this.name,originalEvent:e},this.index):de(e.target,{...e.detail,name:this.name,originalEvent:e})}}),customElements.define("mv-form-group",class extends Q{static get properties(){return{name:{type:String},values:{type:Object},error:{type:String}}}static get styles(){return a`
      .form-group {
        grid-area: group;
      }

      .error {
        grid-area: error;
        position: relative;
        font-size: 0.8em;
        color: #ad4444;
      }

      .mv-form-group {
        display: grid;
        grid-gap: 10px;
        grid-template-columns: auto;
        grid-template-rows: auto;
        grid-template-areas:
          "group";
      }

      .has-error {
        grid-template-areas:
          "group"
          "error";
      }
    `}render(){const e=this.error?" has-error":"";return D`
      <div class="mv-form-group${e}">
        <div class="form-group">
          <slot></slot>
        </div>
        ${this.error?D`
              <div class="error">${this.error}</div>
            `:D``}
      </div>
    `}connectedCallback(){this.addEventListener("change-group-field",this.changeGroupField),super.connectedCallback()}changeGroupField=e=>{const{detail:t}=e,{name:r,value:n,index:s,element:o}=t,a=this.values[s],i=[...this.values.slice(0,s),{...a,[r]:n},...this.values.slice(s+1)];de(o,{name:r,value:i,group:this.name,index:s})}});const me=JSON.parse('{"$schema":"http://json-schema.org/draft-07/schema#","type":"object","required":["firstName","lastName","locations"],"properties":{"firstName":{"type":"string","minLength":1,"title":"First name"},"lastName":{"type":"string","minLength":1,"title":"Last name"},"locations":{"type":"array","title":"Locations","minItems":1,"items":{"type":"object","required":["streetAddress","city","country"],"properties":{"streetAddress":{"type":"string","minLength":1,"title":"Street name"},"city":{"type":"string","minLength":1,"title":"City"},"country":{"type":"string","minLength":1,"title":"Country"},"state":{"type":"string","title":"State"}}}},"remarks":{"type":"string","minLength":1,"title":"Remarks"},"inlineField1":{"type":"string","minLength":1,"title":"Inline Field 1"},"inlineField2":{"type":"string","minLength":1,"title":"Inline Field 2"}}}'),ve={streetAddress:"",city:"",state:"",country:""};customElements.define("mv-form-demo",class extends oe{static get properties(){return{firstName:{type:String,attribute:!1},lastName:{type:String,attribute:!1},locations:{type:Array,attribute:!1},remarks:{type:String,attribute:!1},inlineField1:{type:String,attribute:!1},inlineField2:{type:String,attribute:!1},errors:{type:Object,attribute:!1}}}static get styles(){return a`
      :host {
        font-family: var(--font-family, Arial);
        font-size: var(--font-size-m, 10pt);
      }

      mv-container {
        --mv-container-min-width: 620px;
        --mv-container-max-width: 620px;
        --mv-container-margin: 50px auto;
        --mv-container-padding: 20px 30px;
      }

      mv-container.location {
        --mv-container-min-width: 560px;
        --mv-container-max-width: 620px;
        --mv-container-margin: 0;
        --mv-container-padding: 20px 30px;
      }

      textarea {
        width: 80%;
        min-height: 50px;
        border: 1px solid black;
        margin: 0;
        padding: 5px;
        border-radius: 5px;
        resize: none;
      }

      button,
      label {
        font-size: 1em;
        font-weight: bold;
        color: #4e686d;
      }

      label .required {
        font-style: normal;
        color: #ff0000;
      }

      fieldset {
        margin: 10px auto;
      }
      
      .inline-fields {
        display: grid;
        grid-template-columns: 1fr 1fr;
        grid-gap: 20px;
      }
    `}static get model(){return{modelClass:"DemoForm",mappings:[{property:"firstName",value:"firstName"},{property:"lastName",value:"lastName"},{property:"locations",value:"locations"},{property:"remarks",value:"remarks"},{property:"inlineField1",value:"inlineField1"},{property:"inlineField2",value:"inlineField2"}]}}render(){return D`
      <mv-container>
        <mv-form .store="${this.store}" .schema="${me}">
          <mv-form-field
            name="firstName"
            label="First name"
            placeholder="Enter first name here..."
            .value="${this.firstName}"
            .error="${ue(this.errors,"firstName")}"
            required
          ></mv-form-field>
          <mv-form-field
            name="lastName"
            label="Last name"
            placeholder="Enter last name here..."
            .value="${this.lastName}"
            .error="${ue(this.errors,"lastName")}"
            required
          ></mv-form-field>
          <mv-form-field
            name="email"
            label="Email"
            type="email"
            placeholder="Enter email name here..."
            .value="${this.email}"
            .error="${ue(this.errors,"Email")}"
            required
          ></mv-form-field>
          <mv-form-field
            name="numberPhone"
            label="Number phone"
            type = "tel"
            placeholder="Enter number phone here..."
            .value="${this.numberPhone}"
            .error="${ue(this.errors,"numberPhone")}"
            required
          ></mv-form-field>
          <mv-form-group
            name="locations"
            .values="${this.locations}"
            .error="${ue(this.errors,"locations")}"
          >
            <label>Locations <i class="required">*</i></label>
            ${(this.locations||[]).map(((e,t)=>D`
                <fieldset>
                  <legend>
                    <label>
                      <button @click="${this.removeLocation(t)}">
                        &#x2716; delete
                      </button>
                      ( ${t+1} )
                    </label>
                  </legend>
                  <mv-form-field
                    label="Street address"
                    .error="${ue(this.errors,"streetAddress","locations",t)}"
                    required
                  >
                    <textarea
                      name="streetAddress"
                      slot="field"
                      placeholder="Enter street address here..."
                      .value="${e.streetAddress}"
                      @change="${this.changeStreetAddress(t)}"
                    ></textarea>
                  </mv-form-field>
                  <mv-form-field
                    item
                    name="city"
                    label="City"
                    placeholder="Enter city..."
                    .value="${e.city}"
                    .index="${t}"
                    .error="${ue(this.errors,"city","locations",t)}"
                    required
                  ></mv-form-field>
                  <mv-form-field
                    item
                    name="state"
                    label="State"
                    placeholder="Enter state..."
                    .value="${e.state}"
                    .index="${t}"
                    .error="${ue(this.errors,"state","locations",t)}"
                  ></mv-form-field>
                  <mv-form-field
                    item
                    name="country"
                    label="Country"
                    placeholder="Enter country..."
                    .value="${e.country}"
                    .index="${t}"
                    .error="${ue(this.errors,"country","locations",t)}"
                    required
                  ></mv-form-field>
                </fieldset>
              `))}
            <button @click="${this.addLocation}">&#x271A; add</button>
          </mv-form-group>
          <mv-form-field
            custom
            .error="${ue(this.errors,"remarks")}"
            label-position="top"
            required
          >
            <label slot="label">Remarks</label>
            <textarea
              name="remarks"
              slot="field"
              placeholder="Enter remarks here..."
              .value="${this.remarks}"
              @change="${this.changeRemarks}"
            ></textarea>
          </mv-form-field>
          <div class="inline-fields">
            <mv-form-field
              name="inlineField1"
              placeholder="Inline Field 1"
              .value="${this.inlineField1}"
              .error="${ue(this.errors,"inlineField1")}"
              required
              label-position="none"
            ></mv-form-field>
            <mv-form-field
              name="inlineField2"
              placeholder="Inline Field 2"
              .value="${this.inlineField2}"
              .error="${ue(this.errors,"inlineField2")}"
              required
              label-position="none"
            ></mv-form-field>
          </div>
          <div class="footer-buttons">
            <button @click="${e=this.confirmClearForm,t=>{if(!e||e()){const{target:e}=t;(e||t).dispatchEvent(new CustomEvent("clear-form",{bubbles:!0,composed:!0}))}}}">Clear</button>
            <button @click="${pe}">Submit</button>
          </div>
        </mv-form>
      </mv-container>
    `;var e}connectedCallback(){this.addEventListener("update-errors",this.handleErrors),this.addEventListener("validation-success",this.handleSubmit),this.addEventListener("clear-errors",this.clearErrors),super.connectedCallback()}changeStreetAddress=e=>t=>{const{target:r}=t,{name:n,value:s}=r;he(r,{name:n,value:s,originalEvent:t},e)};changeRemarks=e=>{const{target:t}=e,{name:r,value:n}=t;de(t,{name:r,value:n,originalEvent:e})};addLocation=e=>{const t=[...this.locations,{...ve}];de(e.target,{name:"locations",originalEvent:e,value:t})};removeLocation=e=>t=>{const r=[...this.locations.slice(0,e),...this.locations.slice(e+1)];de(t.target,{name:"locations",validateGroup:!0,originalEvent:t,value:r})};confirmClearForm=()=>confirm("Are you sure you want to clear the form? ");clearErrors=()=>{this.errors=null};handleErrors=e=>{const{detail:{errors:t}}=e;this.errors=t};handleSubmit=e=>{const{detail:{formValues:t}}=e;alert("Form submit OK: "+JSON.stringify(t,null,2))}})})()})();